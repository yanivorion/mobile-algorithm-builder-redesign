{"version":3,"mappings":"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EACD,CACE,QAAS,2CACT,SAAU,kBACX,EACD,CACE,QAAS,2BACT,SAAU,EACX,CACF,EACD,kBAAmB,CACjB,CACE,QAAS,2BACT,SAAU,EACX,EACD,CACE,QAAS,sBACT,SAAU,EACX,CACF,EACD,mBAAoB,CAClB,CACE,QAAS,2BACT,SAAU,EACX,CACF,EACD,WAAY,CACV,CACE,QAAS,2BACT,SAAU,EACX,CACF,EACD,aAAc,CACZ,CACE,QAAS,2BACT,SAAU,EACX,CACF,EACD,oBAAqB,CACnB,CACE,QAAS,2BACT,SAAU,EACX,CACF,EACD,uBAAwB,CACtB,CACE,QAAS,uBACT,SAAU,EACX,CACF,EACD,oBAAqB,CACnB,CACE,QAAS,2BACT,SAAU,EACX,CACF,EACD,qBAAsB,CACpB,CACE,QAAS,iCACT,SAAU,aACX,EACD,CACE,QAAS,gCACT,SAAU,YACX,EACD,CACE,QAAS,yCACT,SAAU,qBACX,EACD,CACE,QAAS,gCACT,SAAU,YACX,EACD,CACE,QAAS,+BACT,SAAU,WACX,EACD,CACE,QAAS,kCACT,SAAU,cACX,EACD,CACE,QAAS,yBACT,SAAU,KACX,CACF,CACL,CAC4D,EAAC,CAC7D,CACA,IAAIiV,GAAe,wCACnB,SAAS6C,GAAW7gB,EAAS,CAC3B,SAAS8gB,EAAa,CAAE,KAAA9e,GAAQ,CAC9B,MAAM+e,EAAiBrB,EAAe1f,EAAS,CAC7C,CACE,YAAaghB,GACb,MAAO,CAAC,CAAE,KAAM,sCAAuC,CACxD,EACD,CACE,YAAaC,GACb,MAAO,CAAC,CAAE,KAAM,uCAAwC,CACzD,CACP,CAAK,EAkCD,MAjCiB,CACf,WAAY,2CACZ,OAAQ,OACR,UAAW,6DACX,YAAajD,GACb,iBAAkB,CAChB,uBAAwB,EACzB,EACD,IAAK4C,GAAsD,CACzD,UAAW,eACX,KAAMG,EACN,KAAA/e,CACR,CAAO,EACD,KAAM+e,EACN,kBAAoBG,GAAaxB,EAAewB,EAAU,CACxD,CACE,YAAavB,EACb,MAAO,CACL,CAAE,KAAM,sBAAwB,EAChC,CAAE,KAAM,sBAAwB,EAChC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","names":["parseMethod","method","toHTTPModule","factory","httpClient","payload","requestOptions","HTTPFactory","context","url","params","response","transformations","data","transform","e","isAmbassadorModule","module","PUBLIC_METADATA_KEY","DEFAULT_API_URL","DEFAULT_EDGE_API_URL","FetchErrorResponse","message","__publicField","dataError","errorBuilder","code","description","details","getDefaultContentHeader","options","isObject","val","parsePublicKeyIfEncoded","publicKey","isHostModule","buildHostModule","host","WixBIHeaderName","biHeaderGenerator","apiMetadata","publicMetadata","environment","objectToKeyValue","input","_","value","key","buildRESTDescriptor","origFunc","boundFetch","errorHandler","wixAPIFetch","getActiveToken","hostName","useCDN","runWithoutContext","request","_a","_b","domain","biHeader","requestOptionsInit","res","error","transformedError","transformError","rawData","_c","_d","SDKError","DELIMITER","set","obj","path","keys","toPathObject","current","nextKey","segment","isNumericSegment","unflatten","flatObject","result","flatKey","isPrototypePollutionKey","ModifiedFieldsManipulator","modifiedFields","transformedModifiedFields","originalKey","pathParts","parts","lastIndex","matches","match","transformedPath","handleArray","part","handleTransformedKeyName","currentObj","transformedKey","RESTResponseToSDKResponseRenameMap","camelCaseKey","camelCase","handleObject","number","offset","attemptTransformationWithModifiedFields","envelope","transformFromRESTFn","unflattenedResult","attemptUnflatten","unflattenedModifiedFields","modifiedFieldsManipulator","transformedEnvelope","flattened","attemptFlatten","str","c","createNanoEvents","event","args","i","callbacks","length","cb","isEventHandlerModule","runHandler","eventDefinition","handler","baseEventMetadata","domainEventPayload","deletedEvent","actionEvent","createdEvent","updatedEvent","domainEventMetadata","metadata","x","originalEnvelope","envelopeAny","modifiedFieldsValue","eventHandlersModules","getAuthStrategy","eventHandlers","webhooksEmitter","client","jwt","opts","eventType","identity","instanceId","allExpectedEvents","type","handlers","body","authStrategy","decoded","valid","parsedDecoded","EventDefinition","isServicePluginModule","servicePluginsModules","servicePluginsImplementations","servicePluginsEmitter","servicePluginRequest","implMethodResult","err","componentType","implementations","impl","servicePluginDefinition","m","implMethod","implementation","X_WIX_CONSISTENT_HEADER","createClient","config","_headers","defaultStrategy","auth","boundGetAuthHeaders","fetchWithAuth","urlOrRequest","requestInit","authHeaders","headers","consistentHeader","findConsistentHeader","k","v","servicePluginsClient","initServicePluginModule","eventHandlersClient","initEventHandlerModule","defaultContentTypeHeader","use","modules","SERVICE_PLUGIN_ERROR_TYPE","apiBaseUrl","shouldUseCDN","relativeUrl","fetchOptions","finalUrl","setHeaders","originalGetAuthHeaders","contextType","wixContext","query","variables","errors","API_VERSION","MAX_DEVICE_PIXEL_RATIO","DSKTP_MAX_BG_SITE_LEGACY_WIDTH","DSKTP_MAX_BG_SITE_LEGACY_HEIGHT","MOBILE_MAX_BG_SITE_LEGACY_WIDTH","MOBILE_MAX_BG_SITE_LEGACY_HEIGHT","fittingTypes","transformTypes","alignTypes","ALIGN_TYPE_TO_FOCAL_POINT","alignTypesMap","htmlTag","upscaleMethods","upscaleMethodsValues","defaultUSM","MAX_TRANSFORMED_IMAGE_WIDTH","MAX_TRANSFORMED_IMAGE_HEIGHT","SAFE_TRANSFORMED_AREA","SUPER_UPSCALE_MODELS","imageScaleDefaults","imageQuality","imageFilters","fileType","encodingTypes","template","strings","values","dict","last","array","SUPPORTED_IMAGE_EXTENSIONS","JPG_EXTENSIONS","isImageTypeSupported","uri","getFileExtension","isValidRequest","fittingType","src","target","isUrlEmptyOrNone","canTransformAnimatedWebpOrAvif","hasAnimation","allowAnimatedTransform","isWEBP","isAVIF","canTransformGIF","allowFullGIFTransformation","isGIF","isImageTransformApplicable","isExternalUrl","isSupportedImageType","isTransformableGif","isJPG","isPNG","isSEOBot","ILLEGAL_CHARS","URL_SAFE_ILLEGAL_CHARS","ILLEGAL_CHARS_REPLACEMENT","getFileName","name","beforeLeadingSlashRegexp","fileExtensionRegexp","illegalCharsRegex","fileName","extension","trimmed","getFileType","getFitScaleFactor","sWidth","sHeight","dWidth","dHeight","getFillScaleFactor","getScaleFactor","transformType","scaleFactor","getSafeTransformData","width","height","dimensionScaleFactor","getTransformData","dpr","upscaleMethod","getOptimizedTransformData","getFocalPointFrom9GridAlignment","alignment","getAlignedRect","sRect","dRect","sFP","fp","getFocalPoint","y","getOverlappingRect","getDevicePixelRatio","getAlignment","focalPoint","roundToFixed","getPreferredImageQuality","imageWidth","imageHeight","getImageQualityKey","getClassicScaleData","imageKey","getAutoScaleData","getSuperScaleData","getOptimizedScaleData","tWidth","tHeight","optimizedScaleFactor","upscaleMethodValue","forceUSM","size","precision","truncatePrecision","getUpscaleString","imageIsAnimated","isAvifWebpFormat","globalFeaturesSupportObj","getFeature","feature","setFeature","populateGlobalFeatureSupport","isSmallScreen","isMobileAgent","isMobile","setTransformParts","transformsObj","rect","getCropPart","getFitPart","getFillPart","getStretchPart","getLegacyCropPart","getLegacyFitPart","getLegacyFillPart","transformedData","clonedTarget","setTransformOptions","getQuality","getProgressive","getWatermark","getUnsharpMask","getFilters","transformData","defaultQuality","quality","filterOptions","filters","isValidImageFilter","filterValue","minValue","maxValue","isUSMValid","isZeroUSM","isUSMNeeded","transformPart","usm","radius","amount","threshold","getTransform","_isSEOBot","devicePixelRatio","fileExtension","preferredExtension","canTransformImage","getTarget","targetObj","_isMobile","maxBGSiteLegacyWidth","maxBGSiteLegacyHeight","fitTemplate","fillTemplate","fillFocalTemplate","cropTemplate","legacyCropTemplate","legacyFillTemplate","upscaleTemplate","qualityTemplate","qualityAutoTemplate","unSharpMaskTemplate","nonProgressiveTemplate","watermarkTemplate","filterTemplatesMap","autoEncodeTemplate","AVIFEncodeTemplate","pAVIFEncodeTemplate","animatedTransformTemplate","animatedGIFTransformTemplate","getImageURI","transformsObjStrArr","legacyFillStr","fitStr","fillStr","fillFocalStr","transformsStr","filterName","isGif","isPlaceholderFlow","getURI","transformObj","transformTarget","ALIGN_TYPE_TO_POSITION","acc","align","position","getData","wixStatic","wixStaticWithMedia","HAS_MEDIA_PREFIX_RE","getWixStaticURL","getURL","baseHostURL","getScaleToFitImageURL","sourceWidth","sourceHeight","targetWidth","targetHeight","getScaleToFillImageURL","getCropImageURL","cropX","cropY","cropWidth","cropHeight","sdk","WIX_PROTOCOL","WIX_IMAGE","WIX_VIDEO","WIX_AUDIO","WIX_DOCUMENT","WIX_IMAGE_URL","WIX_SHAPES_URL","WIX_VIDEO_URL","WIX_AUDIO_URL","WIX_DOCUMENT_URL","getScaledToFillImageUrl","wixMediaIdentifier","img","getImageUrl","getScaledToFitImageUrl","getCroppedImageUrl","getBaseImageUrl","getShapeUrl","baseUrl","id","filenameOrAltText","alignedImage","alignIfLegacy","hash","pathname","decodedFilenameOrAltText","decodeText","getVideoUrl","resolution","thumbnailId","thumbnailWidth","thumbnailHeight","decodedFilename","alignedVideo","hashParams","_id","getAudioUrl","alignedAudio","filename","getDocumentUrl","valWithoutUGD","alignedDocument","s","protocol","VideoResolution","media","resolveWixHeadlessV1RedirectSessionServiceUrl","resolveUrl","PACKAGE_NAME","createRedirectSession","__createRedirectSession","LocationType","LocationType2","Prompt","Prompt2","MembersAccountSection","MembersAccountSection2","AttachPagesResponseStatus","AttachPagesResponseStatus2","CallbackType","CallbackType2","Status","Status2","WebhookIdentityType","WebhookIdentityType2","createRedirectSession2","sideEffects","renameKeysFromSDKRequestToRESTRequest","reqOpts","renameKeysFromRESTResponseToSDKResponse","sdkTransformError","createRedirectSession3","onRedirectSessionCreated","renameKeysFromRESTResponseToSDKResponse2","transformPaths","transformRESTTimestampToSDKTimestamp","createRedirectSession4","createRESTModule","onRedirectSessionCreated2","createEventModule","getCurrentDate","isTokenExpired","token","currentDate","createAccessToken","accessToken","expiresIn","now","transformRESTBytesToSDKBytes","transformSDKAddressToRESTAddress","removeUndefinedKeys","transformRESTAddressToSDKAddress","resolveWixIamAuthenticationV1AuthenticationServiceUrl","registerV2","__registerV2","serializedData","transformSDKFloatToRESTFloat","transformSDKTimestampToRESTTimestamp","payload2","transformRESTFloatToSDKFloat","loginV2","__loginV2","changePassword","__changePassword","signOn","__signOn","logout","__logout","toURLSearchParams","PrivacyStatus","PrivacyStatus2","EmailTag","EmailTag2","PhoneTag","PhoneTag2","AddressTag","AddressTag2","StateType","StateType2","StatusName","StatusName2","Reason","Reason2","FactorType","FactorType2","FactorStatus","FactorStatus2","MfaReason","MfaReason2","TenantType","TenantType2","DeliveryMethod","DeliveryMethod2","registerV22","loginId","transformPaths2","loginV22","changePassword2","newPassword","signOn2","logout2","registerV23","loginV23","changePassword3","signOn3","logout3","registerV24","loginV24","changePassword4","signOn4","logout4","resolveWixIamRecoveryV1RecoveryServiceUrl","sendRecoveryEmail","__sendRecoveryEmail","sendActivationEmail","__sendActivationEmail","recover","__recover","sendRecoveryEmail2","email","sendActivationEmail2","identityId","recover2","recoveryToken","sendRecoveryEmail3","sendActivationEmail3","recover3","sendRecoveryEmail4","sendActivationEmail4","recover4","resolveWixIamVerificationV1VerificationServiceUrl","start","__start","verifyDuringAuthentication","__verifyDuringAuthentication","Target","Target2","start2","verifyDuringAuthentication2","start3","verifyDuringAuthentication3","start4","verifyDuringAuthentication4","LoginState","TokenRole","addListener","eventTarget","fn","removeListener","loadFrame","iframe","addPostMessageListener","state","responseHandler","timeoutId","resolve","reject","MISSING_CAPTCHA","INVALID_CAPTCHA","EMAIL_EXISTS","INVALID_PASSWORD","RESET_PASSWORD","SHIFT","EXTRA","K","SHA256","blocks","index","a","b","d","f","g","h","j","s0","s1","maj","t1","t2","ch","ab","da","cd","bc","buffer","dataView","sha256","pkceChallenge","verifier","generateVerifier","challenge","generateChallenge","random","code_verifier","base64urlencode","mask","randomUints","randomIndex","ab2str","buf","LOCALSTORAGE_PREWARM_REDIRECT_KEY","isVisitorCookieWarmedUp","lastPreWarmTimeString","currentTime","lastPreWarmTime","oneWeekMs","preWarmVisitorCookie","preWarmRedirectSessionWithIframe","ex","urlToRedirect","redirects.createRedirectSession","promise","moduleWithTokens","redirects","authentication","recovery","verification","OAuthStrategy","_tokens","setTokens","tokens","_state","getAuthHeaders","generateVisitorTokens","wixClientWithTokens","renewToken","tokensResponse","fetchTokens","refreshToken","generatePKCE","pkceState","generateOAuthData","redirectUri","originalUri","getAuthorizationUrlWithOptions","oauthData","responseMode","prompt","sessionToken","redirectSession","redirects.Prompt","getAuthUrl","parseFromUrl","parsedUrl","errorDescription","getMemberTokens","originalUrl","handleState","authentication.StateType","emailValidation","_e","_f","_g","nextInputs","stateToUse","oauthPKCE","authUrl","iframePromise","iframeEl","memberId","apiKey","responseJson","ApiKeyStrategy","siteId","accountId","_siteId","_accountId","getTokenInfo","tokenInfoRes","AppStrategy","cachedToken","redirectUrl","oauthOpts","tokensRes","tokenRes","access_token","expires_in","tokenInfo","verifyCallerClaims","jwtVerify","importSPKI","__vitePreload","tokenToCheck"],"sources":["../../node_modules/@wix/sdk/build/ambassador-modules.js","../../node_modules/@wix/sdk/build/common.js","../../node_modules/@wix/sdk/build/fetch-error.js","../../node_modules/@wix/sdk/build/helpers.js","../../node_modules/@wix/sdk/build/host-modules.js","../../node_modules/@wix/sdk/build/bi/biHeaderGenerator.js","../../node_modules/@wix/sdk/build/rest-modules.js","../../node_modules/@wix/sdk/build/object-utils.js","../../node_modules/@wix/sdk/build/flat-utils.js","../../node_modules/@wix/sdk/build/modified-fields-manipulator.js","../../node_modules/@wix/sdk/build/nanoevents.js","../../node_modules/@wix/sdk/build/event-handlers-modules.js","../../node_modules/@wix/sdk/build/service-plugin-modules.js","../../node_modules/@wix/sdk/build/wixClient.js","../../node_modules/@wix/image-kit/dist/esm/helpers/imageServiceConstants.js","../../node_modules/@wix/image-kit/dist/esm/helpers/utils.js","../../node_modules/@wix/image-kit/dist/esm/helpers/imageServiceUtils.js","../../node_modules/@wix/image-kit/dist/esm/helpers/imageServiceFeatureSupportObject.js","../../node_modules/@wix/image-kit/dist/esm/helpers/populateFeatureSupport.js","../../node_modules/@wix/image-kit/dist/esm/helpers/browserFeatureSupport.js","../../node_modules/@wix/image-kit/dist/esm/helpers/imageTransformParts.js","../../node_modules/@wix/image-kit/dist/esm/helpers/imageTransformOptions.js","../../node_modules/@wix/image-kit/dist/esm/api/transform.js","../../node_modules/@wix/image-kit/dist/esm/engines/transforms.js","../../node_modules/@wix/image-kit/dist/esm/api/uri.js","../../node_modules/@wix/image-kit/dist/esm/helpers/imagePlaceholderUtils.js","../../node_modules/@wix/image-kit/dist/esm/api/uri/index.js","../../node_modules/@wix/image-kit/dist/esm/sdk/api.js","../../node_modules/@wix/image-kit/dist/esm/sdk/index.js","../../node_modules/@wix/image-kit/dist/esm/api/max/index.js","../../node_modules/@wix/sdk/build/media/helpers.js","../../node_modules/@wix/sdk/build/wixMedia.js","../../node_modules/@wix/auto_sdk_redirects_redirects/build/es/index.mjs","../../node_modules/@wix/sdk/build/tokenHelpers.js","../../node_modules/@wix/sdk-runtime/build/transformations/bytes.js","../../node_modules/@wix/sdk-runtime/build/transformations/address.js","../../node_modules/@wix/auto_sdk_identity_authentication/build/es/index.mjs","../../node_modules/@wix/auto_sdk_identity_recovery/build/es/index.mjs","../../node_modules/@wix/auto_sdk_identity_verification/build/es/index.mjs","../../node_modules/@wix/sdk/build/auth/oauth2/types.js","../../node_modules/@wix/sdk/build/iframeUtils.js","../../node_modules/@wix/sdk/build/auth/oauth2/constants.js","../../node_modules/@wix/sdk/build/auth/oauth2/sha256.js","../../node_modules/@wix/sdk/build/auth/oauth2/pkce-challenge.js","../../node_modules/@wix/sdk/build/auth/pre-warm-cookie.js","../../node_modules/@wix/sdk/build/auth/oauth2/OAuthStrategy.js","../../node_modules/@wix/sdk/build/auth/ApiKeyAuthStrategy.js","../../node_modules/@wix/sdk/build/get-token-info.js","../../node_modules/@wix/sdk/build/auth/AppStrategy.js"],"sourcesContent":["const parseMethod = (method) => {\n    switch (method) {\n        case 'get':\n        case 'GET':\n            return 'GET';\n        case 'post':\n        case 'POST':\n            return 'POST';\n        case 'put':\n        case 'PUT':\n            return 'PUT';\n        case 'delete':\n        case 'DELETE':\n            return 'DELETE';\n        case 'patch':\n        case 'PATCH':\n            return 'PATCH';\n        case 'head':\n        case 'HEAD':\n            return 'HEAD';\n        case 'options':\n        case 'OPTIONS':\n            return 'OPTIONS';\n        default:\n            throw new Error(`Unknown method: ${method}`);\n    }\n};\nexport const toHTTPModule = (factory) => (httpClient) => async (payload) => {\n    let requestOptions;\n    const HTTPFactory = (context) => {\n        requestOptions = factory(payload)(context);\n        if (requestOptions.url === undefined) {\n            throw new Error('Url was not successfully created for this request, please reach out to support channels for assistance.');\n        }\n        const { method, url, params } = requestOptions;\n        return {\n            ...requestOptions,\n            method: parseMethod(method),\n            url,\n            data: requestOptions.data,\n            params,\n        };\n    };\n    try {\n        const response = await httpClient.request(HTTPFactory);\n        if (requestOptions === undefined) {\n            throw new Error('Request options were not created for this request, please reach out to support channels for assistance.');\n        }\n        const transformations = Array.isArray(requestOptions.transformResponse)\n            ? requestOptions.transformResponse\n            : [requestOptions.transformResponse];\n        /**\n         * Based on Axios implementation:\n         * https://github.com/axios/axios/blob/3f53eb6960f05a1f88409c4b731a40de595cb825/lib/core/transformData.js#L22\n         */\n        let data = response.data;\n        transformations.forEach((transform) => {\n            if (transform) {\n                data = transform(response.data, response.headers);\n            }\n        });\n        return data;\n    }\n    catch (e) {\n        if (typeof e === 'object' &&\n            e !== null &&\n            'response' in e &&\n            typeof e.response === 'object' &&\n            e.response !== null &&\n            'data' in e.response) {\n            throw e.response.data;\n        }\n        throw e;\n    }\n};\n/*\n * Because of issues with tree-shaking, we cant really put static parameter on module.\n * We still have check for __isAmbassador for backward compatibility\n */\nexport const isAmbassadorModule = (module) => {\n    if (module.__isAmbassador) {\n        return true;\n    }\n    const fn = module();\n    return Boolean(fn.__isAmbassador);\n};\n","export const PUBLIC_METADATA_KEY = '__metadata';\nexport const DEFAULT_API_URL = 'www.wixapis.com';\nexport const DEFAULT_EDGE_API_URL = 'edge.wixapis.com';\nexport const FORCE_WRITE_API_URLS = ['/ecom/v1/carts/current'];\n","export class FetchErrorResponse extends Error {\n    message;\n    response;\n    constructor(message, response) {\n        super(message);\n        this.message = message;\n        this.response = response;\n    }\n    async details() {\n        const dataError = await this.response.json();\n        return errorBuilder(this.response.status, dataError?.message, dataError?.details, {\n            requestId: this.response.headers.get('X-Wix-Request-Id'),\n            details: dataError,\n        });\n    }\n}\nconst errorBuilder = (code, description, details, data) => {\n    return {\n        details: {\n            ...(!details?.validationError && {\n                applicationError: {\n                    description,\n                    code,\n                    data,\n                },\n            }),\n            ...details,\n        },\n        message: description,\n        requestId: data?.requestId,\n    };\n};\n","// we follow a simplified version of the axios convention\n// https://github.com/axios/axios/blob/649d739288c8e2c55829ac60e2345a0f3439c730/lib/defaults/index.js#L65\nexport const getDefaultContentHeader = (options) => {\n    if (options?.method &&\n        ['post', 'put', 'patch'].includes(options.method.toLocaleLowerCase()) &&\n        options.body) {\n        return { 'Content-Type': 'application/json' };\n    }\n    return {};\n};\nexport const isObject = (val) => val && typeof val === 'object' && !Array.isArray(val);\nexport function parsePublicKeyIfEncoded(publicKey) {\n    if (publicKey.includes('\\n') || publicKey.includes('\\r')) {\n        // publicKey is multi-line string, can be used as is\n        return publicKey.trim();\n    }\n    else {\n        // publicKey is base64 encoded\n        return typeof atob !== 'undefined'\n            ? atob(publicKey)\n            : Buffer.from(publicKey, 'base64').toString('utf-8');\n    }\n}\n","export const isHostModule = (val) => val.__type === 'host';\nexport function buildHostModule(val, host) {\n    return val.create(host);\n}\n","export const WixBIHeaderName = 'x-wix-bi-gateway';\nexport function biHeaderGenerator(apiMetadata, publicMetadata, environment) {\n    return {\n        [WixBIHeaderName]: objectToKeyValue({\n            environment: `js-sdk${environment ? `-${environment}` : ``}`,\n            'package-name': apiMetadata.packageName ?? publicMetadata?.PACKAGE_NAME,\n            'method-fqn': apiMetadata.methodFqn,\n            entity: apiMetadata.entityFqdn,\n        }),\n    };\n}\nfunction objectToKeyValue(input) {\n    return Object.entries(input)\n        .filter(([_, value]) => Boolean(value))\n        .map(([key, value]) => `${key}=${value}`)\n        .join(',');\n}\n","import { biHeaderGenerator } from './bi/biHeaderGenerator.js';\nimport { DEFAULT_API_URL, DEFAULT_EDGE_API_URL } from './common.js';\nimport { runWithoutContext } from '@wix/sdk-runtime/context';\nimport { transformError } from '@wix/sdk-runtime/transform-error';\nexport function buildRESTDescriptor(origFunc, publicMetadata, boundFetch, errorHandler, wixAPIFetch, getActiveToken, options, hostName, useCDN) {\n    return runWithoutContext(() => origFunc({\n        request: async (factory) => {\n            const requestOptions = factory({\n                host: options?.HTTPHost || DEFAULT_API_URL,\n            });\n            let request = requestOptions;\n            if (request.method === 'GET' &&\n                request.fallback?.length &&\n                (request.params?.toString().length ?? 0) > 4000) {\n                request = requestOptions.fallback[0];\n            }\n            const domain = options?.HTTPHost ?? DEFAULT_API_URL;\n            let url = `https://${useCDN ? DEFAULT_EDGE_API_URL : domain}${request.url}`;\n            if (request.params && request.params.toString()) {\n                url += `?${request.params.toString()}`;\n            }\n            try {\n                const biHeader = biHeaderGenerator(requestOptions, publicMetadata, hostName);\n                const requestOptionsInit = {\n                    method: request.method,\n                    ...(request.data && {\n                        body: JSON.stringify(request.data),\n                    }),\n                    headers: {\n                        ...biHeader,\n                    },\n                };\n                const res = await boundFetch(url, requestOptionsInit);\n                if (res.status !== 200) {\n                    let dataError = null;\n                    try {\n                        dataError = await res.json();\n                    }\n                    catch (e) {\n                        //\n                    }\n                    const error = errorBuilder(res.status, dataError?.message, dataError?.details, {\n                        requestId: res.headers.get('X-Wix-Request-Id'),\n                        details: dataError,\n                    });\n                    const transformedError = transformError(error);\n                    errorHandler?.handleError(transformedError, {\n                        requestOptions: {\n                            url: request.url,\n                            method: request.method,\n                            entityFqdn: requestOptions.entityFqdn,\n                            methodFqn: requestOptions.methodFqn,\n                        },\n                    });\n                    throw error;\n                }\n                const rawData = await res.json();\n                const data = \n                // we only transform the response if the optInTransformResponse flag is set\n                // this is for backwards compatibility as some users might rely on not transforming the response\n                // in older modules. In that case the modules would not have the optInTransformResponse flag set\n                request.migrationOptions?.optInTransformResponse &&\n                    request.transformResponse\n                    ? Array.isArray(request.transformResponse)\n                        ? request.transformResponse[0](rawData)\n                        : request.transformResponse(rawData)\n                    : rawData;\n                return {\n                    data,\n                    headers: res.headers,\n                    status: res.status,\n                    statusText: res.statusText,\n                };\n            }\n            catch (e) {\n                if (e.message?.includes('fetch is not defined')) {\n                    console.error('Node.js v18+ is required');\n                }\n                throw e;\n            }\n        },\n        fetchWithAuth: boundFetch,\n        wixAPIFetch,\n        getActiveToken,\n    }));\n}\nclass SDKError extends Error {\n    response;\n    requestId;\n    constructor(params) {\n        super();\n        this.response = params.response;\n        this.requestId = params.requestId;\n    }\n}\nconst errorBuilder = (code, description, details, data) => {\n    return new SDKError({\n        response: {\n            data: {\n                details: {\n                    ...(!details?.validationError && {\n                        applicationError: {\n                            description,\n                            code,\n                            data,\n                        },\n                    }),\n                    ...details,\n                },\n                message: description,\n            },\n            status: code,\n        },\n        requestId: data?.requestId,\n    });\n};\n","const DELIMITER = '.';\nexport function set(obj, path, value) {\n    if (obj == null) {\n        throw new Error('Cannot set value on null or undefined');\n    }\n    const keys = toPathObject(path);\n    let current = obj;\n    for (let i = 0; i < keys.length; i++) {\n        const key = keys[i];\n        // Last key  assign value\n        if (i === keys.length - 1) {\n            current[key] = value;\n            break;\n        }\n        // Create object or array if missing\n        const nextKey = keys[i + 1];\n        if (!(key in current) || current[key] == null) {\n            current[key] = typeof nextKey === 'number' ? [] : {};\n        }\n        else if (typeof current[key] !== 'object' || current[key] === null) {\n            // Overwrite non-object values\n            current[key] = typeof nextKey === 'number' ? [] : {};\n        }\n        current = current[key];\n    }\n    return obj;\n}\nexport function toPathObject(path) {\n    if (Array.isArray(path)) {\n        return path;\n    }\n    return path\n        .split(DELIMITER)\n        .map((segment) => (isNumericSegment(segment) ? Number(segment) : segment));\n}\nfunction isNumericSegment(segment) {\n    return /^\\d+$/.test(segment);\n}\n","import { set, toPathObject } from './object-utils.js';\nexport function unflatten(flatObject) {\n    const result = {};\n    for (const [flatKey, value] of Object.entries(flatObject)) {\n        // Skip prototype pollution keys\n        if (isPrototypePollutionKey(flatKey)) {\n            continue;\n        }\n        const path = toPathObject(flatKey);\n        set(result, path, value);\n    }\n    return result;\n}\nfunction isPrototypePollutionKey(key) {\n    return key === '__proto__' || key === 'constructor' || key === 'prototype';\n}\n","import { RESTResponseToSDKResponseRenameMap } from '@wix/sdk-runtime/rest-modules';\nimport { unflatten } from './flat-utils.js';\nexport class ModifiedFieldsManipulator {\n    BRACKET_PATTERN = /\\[(\\d+)\\]/g;\n    NUMERIC_PATTERN = /^\\d+$/;\n    ESCAPED_DOT_PATTERN = /\\\\\\./g;\n    ESCAPED_LEFT_BRACKET_PATTERN = /\\\\\\[/g;\n    ESCAPED_RIGHT_BRACKET_PATTERN = /\\\\\\]/g;\n    SPLIT_PATTERN = /\\.|\\[(\\d+)\\]/g;\n    DOT_BEFORE_BRACKET_PATTERN = /\\.\\[/g;\n    ESCAPED_DOT_PLACEHOLDER = '__DOT__';\n    ESCAPED_RIGHT_BRACKET_PLACEHOLDER = '__RB__';\n    ESCAPED_LEFT_BRACKET_PLACEHOLDER = '__LB__';\n    modifiedFields;\n    cleanedModifiedFields;\n    constructor(modifiedFields) {\n        this.modifiedFields = modifiedFields;\n    }\n    replaceEscapedCharacters(key) {\n        return key\n            .replace(this.ESCAPED_DOT_PATTERN, this.ESCAPED_DOT_PLACEHOLDER)\n            .replace(this.ESCAPED_LEFT_BRACKET_PATTERN, this.ESCAPED_LEFT_BRACKET_PLACEHOLDER)\n            .replace(this.ESCAPED_RIGHT_BRACKET_PATTERN, this.ESCAPED_RIGHT_BRACKET_PLACEHOLDER);\n    }\n    restoreEscapedCharacters(key) {\n        return key\n            .replace(this.ESCAPED_DOT_PLACEHOLDER, '\\\\.')\n            .replace(this.ESCAPED_RIGHT_BRACKET_PLACEHOLDER, '\\\\]')\n            .replace(this.ESCAPED_LEFT_BRACKET_PLACEHOLDER, '\\\\[');\n    }\n    unflatten() {\n        this.cleanedModifiedFields = Object.fromEntries(Object.entries(this.modifiedFields).map(([key, value]) => [\n            this.replaceEscapedCharacters(this.bracketToDotNotation(key)),\n            value,\n        ]));\n        return unflatten(this.cleanedModifiedFields);\n    }\n    flatten(transformedModifiedFields) {\n        let result = {};\n        for (const originalKey of Object.keys(this.cleanedModifiedFields)) {\n            const pathParts = this.splitPath(originalKey);\n            const value = this.navigatePath(transformedModifiedFields, pathParts);\n            result = { ...result, ...value };\n        }\n        return Object.fromEntries(Object.entries(result).map(([key, value]) => [\n            this.restoreEscapedCharacters(key),\n            value,\n        ]));\n    }\n    splitPath(path) {\n        const parts = [];\n        let lastIndex = 0;\n        const matches = Array.from(path.matchAll(this.SPLIT_PATTERN));\n        for (const match of matches) {\n            if (match.index > lastIndex) {\n                parts.push(path.substring(lastIndex, match.index));\n            }\n            if (match[1]) {\n                parts.push(match[1]);\n            }\n            lastIndex = match.index + match[0].length;\n        }\n        if (lastIndex < path.length) {\n            parts.push(path.substring(lastIndex));\n        }\n        return parts;\n    }\n    navigatePath(obj, pathParts) {\n        let current = obj;\n        const transformedPath = [];\n        const handleArray = (part) => {\n            if (!Array.isArray(current)) {\n                throw new Error(`Expected array at path ${this.buildPathString(transformedPath)}, but got ${typeof current}`);\n            }\n            transformedPath.push(`[${part}]`);\n            current = current[parseInt(part, 10)];\n        };\n        const handleTransformedKeyName = (part, currentObj) => {\n            const transformedKey = part in RESTResponseToSDKResponseRenameMap\n                ? RESTResponseToSDKResponseRenameMap[part]\n                : undefined;\n            if (transformedKey && transformedKey in currentObj) {\n                transformedPath.push(transformedKey);\n                current = currentObj[transformedKey];\n                return;\n            }\n            const camelCaseKey = camelCase(part);\n            if (camelCaseKey && camelCaseKey in currentObj) {\n                transformedPath.push(camelCaseKey);\n                current = currentObj[camelCaseKey];\n                return;\n            }\n            throw new Error(`Cannot find key '${part}' or its transformations at path ${this.buildPathString(transformedPath)}`);\n        };\n        const handleObject = (part, currentObj) => {\n            transformedPath.push(part);\n            current = currentObj[part];\n            return;\n        };\n        for (const part of pathParts) {\n            if (this.NUMERIC_PATTERN.test(part)) {\n                handleArray(part);\n                continue;\n            }\n            if (current === null || typeof current !== 'object') {\n                throw new Error(`Cannot access property '${part}' on ${typeof current} at path ${this.buildPathString(transformedPath)}`);\n            }\n            const currentObj = current;\n            if (part in current) {\n                handleObject(part, currentObj);\n                continue;\n            }\n            handleTransformedKeyName(part, currentObj);\n        }\n        return { [this.buildPathString(transformedPath)]: current };\n    }\n    buildPathString(pathParts) {\n        return pathParts.join('.').replace(this.DOT_BEFORE_BRACKET_PATTERN, '[');\n    }\n    bracketToDotNotation(key) {\n        return key.replace(this.BRACKET_PATTERN, (match, number, offset) => {\n            if (offset > 0 && key[offset - 1] === '\\\\') {\n                return match;\n            }\n            return '.' + number;\n        });\n    }\n}\n/**\n * Transforms an envelope while preserving the structure of modifiedFields.\n *\n * Modified fields come as flattened objects, while transformations are applied to the nested object (e.g. \"a.b.c\" -> { a: { b: { c: 'value' } } }).\n * This function handles the transformation of envelopes that contain flattened modifiedFields.\n * It unflattens the modifiedFields, applies the transformation function, and then flattens\n * the modifiedFields back to their original format while preserving the transformation.\n * @param envelope - The envelope object containing flattened modifiedFields\n * @param transformFromRESTFn - Function to transform the envelope from REST format to SDK format\n * @returns The transformed envelope with flattened modifiedFields, or null if transformation fails\n */\nexport function attemptTransformationWithModifiedFields(envelope, transformFromRESTFn) {\n    const modifiedFields = envelope?.modifiedFields;\n    if (!modifiedFields) {\n        return null;\n    }\n    const unflattenedResult = attemptUnflatten(modifiedFields);\n    if (!unflattenedResult) {\n        return null;\n    }\n    const { unflattenedModifiedFields, modifiedFieldsManipulator } = unflattenedResult;\n    envelope = {\n        ...envelope,\n        modifiedFields: unflattenedModifiedFields,\n    };\n    const transformedEnvelope = transformFromRESTFn(envelope);\n    const transformedModifiedFields = transformedEnvelope\n        ?.modifiedFields;\n    if (!transformedModifiedFields) {\n        return null;\n    }\n    const flattened = attemptFlatten(transformedModifiedFields, modifiedFieldsManipulator);\n    if (flattened !== null) {\n        transformedEnvelope.modifiedFields = flattened;\n        return transformedEnvelope;\n    }\n    return null;\n}\nfunction attemptUnflatten(modifiedFields) {\n    if (typeof modifiedFields === 'object' &&\n        modifiedFields !== null &&\n        !Array.isArray(modifiedFields)) {\n        try {\n            const modifiedFieldsManipulator = new ModifiedFieldsManipulator(modifiedFields);\n            const unflattened = modifiedFieldsManipulator.unflatten();\n            return {\n                unflattenedModifiedFields: unflattened,\n                modifiedFieldsManipulator,\n            };\n        }\n        catch (error) {\n            return null;\n        }\n    }\n    return null;\n}\nfunction attemptFlatten(transformedModifiedFields, modifiedFieldsManipulator) {\n    if (typeof transformedModifiedFields === 'object' &&\n        transformedModifiedFields !== null &&\n        !Array.isArray(transformedModifiedFields)) {\n        try {\n            const flattened = modifiedFieldsManipulator.flatten(transformedModifiedFields);\n            return flattened;\n        }\n        catch (error) {\n            return null;\n        }\n    }\n    return null;\n}\n// Simple camelCase implementation to avoid lodash (which uses `new Function()` internally\n// and breaks Cloudflare Workers/Edge runtimes)\nfunction camelCase(str) {\n    return str\n        .replace(/[-_\\s]+(.)?/g, (_, c) => (c ? c.toUpperCase() : ''))\n        .replace(/^./, (c) => c.toLowerCase());\n}\n","// Inlined from https://github.com/ai/nanoevents/blob/main/index.js\n/**\n * Create event emitter.\n *\n * ```js\n * import { createNanoEvents } from 'nanoevents'\n *\n * class Ticker {\n * constructor() {\n * this.emitter = createNanoEvents()\n * }\n * on(...args) {\n * return this.emitter.on(...args)\n * }\n * tick() {\n * this.emitter.emit('tick')\n * }\n * }\n * ```\n * @returns Event emitter.\n */\nexport function createNanoEvents() {\n    return {\n        emit(event, ...args) {\n            for (let i = 0, callbacks = this.events[event] || [], length = callbacks.length; i < length; i++) {\n                callbacks[i](...args);\n            }\n        },\n        events: {},\n        on(event, cb) {\n            (this.events[event] ||= []).push(cb);\n            return () => {\n                this.events[event] = this.events[event]?.filter((i) => cb !== i);\n            };\n        },\n    };\n}\n","import { EventDefinition, } from '@wix/sdk-types';\nimport { attemptTransformationWithModifiedFields } from './modified-fields-manipulator.js';\nimport { createNanoEvents } from './nanoevents.js';\nexport const isEventHandlerModule = (val) => val.__type === 'event-definition';\nexport function buildEventDefinition(eventDefinition, registerHandler) {\n    return (handler) => {\n        registerHandler(eventDefinition, handler);\n    };\n}\nfunction runHandler(eventDefinition, handler, payload, baseEventMetadata) {\n    let envelope;\n    if (eventDefinition.isDomainEvent) {\n        const domainEventPayload = payload;\n        const { deletedEvent, actionEvent, createdEvent, updatedEvent, ...domainEventMetadata } = domainEventPayload;\n        const metadata = {\n            ...baseEventMetadata,\n            ...domainEventMetadata,\n        };\n        if (deletedEvent) {\n            if (deletedEvent?.deletedEntity) {\n                envelope = {\n                    entity: deletedEvent?.deletedEntity,\n                    metadata,\n                };\n            }\n            else {\n                envelope = { metadata };\n            }\n        }\n        else if (actionEvent) {\n            envelope = {\n                data: actionEvent.body,\n                metadata,\n            };\n        }\n        else if (updatedEvent) {\n            envelope = {\n                entity: updatedEvent.currentEntity,\n                metadata,\n                ...(updatedEvent.modifiedFields\n                    ? { modifiedFields: updatedEvent.modifiedFields }\n                    : {}),\n            };\n        }\n        else {\n            // createdEvent\n            envelope = {\n                entity: createdEvent?.entity,\n                metadata,\n            };\n        }\n    }\n    else {\n        envelope = {\n            data: payload,\n            metadata: baseEventMetadata,\n        };\n    }\n    const transformFromRESTFn = eventDefinition.transformations ?? ((x) => x);\n    let originalEnvelope = envelope;\n    const envelopeAny = envelope;\n    if (envelopeAny.modifiedFields) {\n        const modifiedFieldsValue = envelopeAny.modifiedFields;\n        if (typeof modifiedFieldsValue === 'object' &&\n            modifiedFieldsValue !== null &&\n            !Array.isArray(modifiedFieldsValue)) {\n            originalEnvelope = structuredClone(envelope);\n            const transformedEnvelope = attemptTransformationWithModifiedFields(envelopeAny, transformFromRESTFn);\n            if (transformedEnvelope) {\n                return handler(transformedEnvelope);\n            }\n        }\n    }\n    return handler(transformFromRESTFn(originalEnvelope));\n}\nexport function eventHandlersModules(getAuthStrategy) {\n    const eventHandlers = new Map();\n    const webhooksEmitter = createNanoEvents();\n    const client = {\n        ...webhooksEmitter,\n        getRegisteredEvents: () => eventHandlers,\n        async process(jwt, opts = {\n            expectedEvents: [],\n        }) {\n            const { eventType, identity, instanceId, payload } = await this.parseJWT(jwt);\n            const allExpectedEvents = [\n                ...opts.expectedEvents,\n                ...Array.from(eventHandlers.keys()).map((type) => ({ type })),\n            ];\n            if (allExpectedEvents.length > 0 &&\n                !allExpectedEvents.some(({ type }) => type === eventType)) {\n                throw new Error(`Unexpected event type: ${eventType}. Expected one of: ${allExpectedEvents\n                    .map((x) => x.type)\n                    .join(', ')}`);\n            }\n            const handlers = eventHandlers.get(eventType) ?? [];\n            await Promise.all(handlers.map(({ eventDefinition, handler }) => runHandler(eventDefinition, handler, payload, {\n                instanceId,\n                identity,\n            })));\n            return {\n                instanceId,\n                eventType,\n                payload,\n                identity,\n            };\n        },\n        async processRequest(request, opts) {\n            const body = await request.text();\n            return this.process(body, opts);\n        },\n        async parseJWT(jwt) {\n            const authStrategy = getAuthStrategy();\n            if (!authStrategy.decodeJWT) {\n                throw new Error('decodeJWT is not supported by the authentication strategy');\n            }\n            const { decoded, valid } = await authStrategy.decodeJWT(jwt);\n            if (!valid) {\n                throw new Error('JWT is not valid');\n            }\n            if (typeof decoded.data !== 'string') {\n                throw new Error(`Unexpected type of JWT data: expected string, got ${typeof decoded.data}`);\n            }\n            const parsedDecoded = JSON.parse(decoded.data);\n            const eventType = parsedDecoded.eventType;\n            const instanceId = parsedDecoded.instanceId;\n            const identity = parsedDecoded.identity\n                ? JSON.parse(parsedDecoded.identity)\n                : undefined;\n            const payload = JSON.parse(parsedDecoded.data);\n            return {\n                instanceId,\n                eventType,\n                payload,\n                identity,\n            };\n        },\n        async parseRequest(request) {\n            const jwt = await request.text();\n            return this.parseJWT(jwt);\n        },\n        async executeHandlers(event) {\n            const allExpectedEvents = Array.from(eventHandlers.keys()).map((type) => ({ type }));\n            if (allExpectedEvents.length > 0 &&\n                !allExpectedEvents.some(({ type }) => type === event.eventType)) {\n                throw new Error(`Unexpected event type: ${event.eventType}. Expected one of: ${allExpectedEvents\n                    .map((x) => x.type)\n                    .join(', ')}`);\n            }\n            const handlers = eventHandlers.get(event.eventType) ?? [];\n            await Promise.all(handlers.map(({ eventDefinition, handler }) => runHandler(eventDefinition, handler, event.payload, {\n                instanceId: event.instanceId,\n                identity: event.identity,\n            })));\n        },\n        apps: {\n            AppInstalled: EventDefinition('AppInstalled')(),\n            AppRemoved: EventDefinition('AppRemoved')(),\n        },\n    };\n    return {\n        initModule(eventDefinition) {\n            return (handler) => {\n                const handlers = eventHandlers.get(eventDefinition.type) ?? [];\n                handlers.push({ eventDefinition, handler });\n                eventHandlers.set(eventDefinition.type, handlers);\n                webhooksEmitter.emit('registered', eventDefinition);\n            };\n        },\n        client,\n    };\n}\n","import { createNanoEvents } from './nanoevents.js';\nexport const isServicePluginModule = (val) => val.__type === 'service-plugin-definition';\nexport function servicePluginsModules(getAuthStrategy) {\n    const servicePluginsImplementations = new Map();\n    const servicePluginsEmitter = createNanoEvents();\n    const client = {\n        ...servicePluginsEmitter,\n        getRegisteredServicePlugins: () => servicePluginsImplementations,\n        async parseJWT(jwt) {\n            const authStrategy = getAuthStrategy();\n            if (!authStrategy.decodeJWT) {\n                throw new Error('decodeJWT is not supported by the authentication strategy');\n            }\n            const { decoded, valid } = await authStrategy.decodeJWT(jwt, true);\n            if (!valid) {\n                throw new Error('JWT is not valid');\n            }\n            if (typeof decoded.data !== 'object' ||\n                decoded.data === null ||\n                !('metadata' in decoded.data) ||\n                typeof decoded.data.metadata !== 'object' ||\n                decoded.data.metadata === null ||\n                !('appExtensionType' in decoded.data.metadata) ||\n                typeof decoded.data.metadata.appExtensionType !== 'string') {\n                throw new Error('Unexpected JWT data: expected object with metadata.appExtensionType string');\n            }\n            return decoded.data;\n        },\n        async process(request) {\n            const servicePluginRequest = await this.parseJWT(request.body);\n            return this.executeHandler(servicePluginRequest, request.url);\n        },\n        async parseRequest(request) {\n            const body = await request.text();\n            return this.parseJWT(body);\n        },\n        async processRequest(request) {\n            const url = request.url;\n            const body = await request.text();\n            try {\n                const implMethodResult = await this.process({ url, body });\n                return Response.json(implMethodResult);\n            }\n            catch (err) {\n                if (err.errorType === 'SPI' && err.applicationCode && err.httpCode) {\n                    return Response.json({ applicationError: { code: err.applicationCode, data: err.data } }, { status: err.httpCode });\n                }\n                throw err;\n            }\n        },\n        async executeHandler(servicePluginRequest, url) {\n            const componentType = servicePluginRequest.metadata.appExtensionType.toLowerCase();\n            const implementations = servicePluginsImplementations.get(componentType) ?? [];\n            if (implementations.length === 0) {\n                throw new Error(`No service plugin implementations found for component type ${componentType}`);\n            }\n            else if (implementations.length > 1) {\n                throw new Error(`Multiple service plugin implementations found for component type ${componentType}. This is currently not supported`);\n            }\n            const { implementation: impl, servicePluginDefinition } = implementations[0];\n            const method = servicePluginDefinition.methods.find((m) => url.endsWith(m.primaryHttpMappingPath));\n            if (!method) {\n                throw new Error('Unexpect request: request url did not match any method: ' + url);\n            }\n            const implMethod = impl[method.name];\n            if (!implMethod) {\n                throw new Error(`Got request for service plugin method ${method.name} but no implementation was provided. Available methods: ${Object.keys(impl).join(', ')}`);\n            }\n            return method.transformations.toREST(await implMethod(method.transformations.fromREST(servicePluginRequest)));\n        },\n    };\n    return {\n        initModule(servicePluginDefinition) {\n            return (implementation) => {\n                const implementations = servicePluginsImplementations.get(servicePluginDefinition.componentType.toLowerCase()) ?? [];\n                implementations.push({ servicePluginDefinition, implementation });\n                servicePluginsImplementations.set(servicePluginDefinition.componentType.toLowerCase(), implementations);\n                servicePluginsEmitter.emit('registered', servicePluginDefinition);\n            };\n        },\n        client,\n    };\n}\n","import { wixContext } from '@wix/sdk-context';\nimport { SERVICE_PLUGIN_ERROR_TYPE, } from '@wix/sdk-types';\nimport { isAmbassadorModule, toHTTPModule } from './ambassador-modules.js';\nimport { DEFAULT_API_URL, PUBLIC_METADATA_KEY } from './common.js';\nimport { FetchErrorResponse } from './fetch-error.js';\nimport { getDefaultContentHeader, isObject } from './helpers.js';\nimport { buildHostModule, isHostModule } from './host-modules.js';\nimport { buildRESTDescriptor } from './rest-modules.js';\nimport { eventHandlersModules, isEventHandlerModule, } from './event-handlers-modules.js';\nimport { isServicePluginModule, servicePluginsModules, } from './service-plugin-modules.js';\nimport { runWithoutContext } from '@wix/sdk-runtime/context';\nexport const X_WIX_CONSISTENT_HEADER = 'X-Wix-Consistent';\nexport function createClient(config) {\n    const _headers = config.headers || { Authorization: '' };\n    const defaultStrategy = {\n        getAuthHeaders: (_) => Promise.resolve({ headers: {} }),\n    };\n    const auth = config.auth;\n    const getAuthStrategy = typeof auth === 'function' ? auth : () => auth ?? defaultStrategy;\n    const boundGetAuthHeaders = () => {\n        return getAuthStrategy().getAuthHeaders(config.host);\n    };\n    const fetchWithAuth = async (urlOrRequest, requestInit) => {\n        const authHeaders = await boundGetAuthHeaders();\n        const headers = {\n            ...(requestInit?.headers ?? {}),\n            ...authHeaders.headers,\n            ...config.host?.essentials?.passThroughHeaders,\n            ...(_headers[X_WIX_CONSISTENT_HEADER]\n                ? { [X_WIX_CONSISTENT_HEADER]: _headers[X_WIX_CONSISTENT_HEADER] }\n                : {}),\n        };\n        const errorHandler = config.host?.getErrorHandler?.();\n        try {\n            if (typeof urlOrRequest === 'string' || urlOrRequest instanceof URL) {\n                const response = await fetch(urlOrRequest, {\n                    ...requestInit,\n                    headers,\n                });\n                errorHandler?.handleError(response, {\n                    requestOptions: {\n                        url: urlOrRequest.toString(),\n                        method: requestInit?.method,\n                    },\n                });\n                const consistentHeader = findConsistentHeader(response);\n                if (consistentHeader) {\n                    _headers[X_WIX_CONSISTENT_HEADER] = consistentHeader;\n                }\n                return response;\n            }\n            else {\n                for (const [k, v] of Object.entries(headers)) {\n                    if (typeof v === 'string') {\n                        urlOrRequest.headers.set(k, v);\n                    }\n                }\n                const response = await fetch(urlOrRequest, requestInit);\n                errorHandler?.handleError(response, {\n                    requestOptions: {\n                        url: urlOrRequest.url,\n                        method: requestInit?.method,\n                    },\n                });\n                const consistentHeader = findConsistentHeader(response);\n                if (consistentHeader) {\n                    _headers[X_WIX_CONSISTENT_HEADER] = consistentHeader;\n                }\n                return response;\n            }\n        }\n        catch (e) {\n            errorHandler?.handleError(e, {\n                requestOptions: {\n                    url: typeof urlOrRequest === 'string' || urlOrRequest instanceof URL\n                        ? urlOrRequest.toString()\n                        : urlOrRequest.url,\n                    method: requestInit?.method,\n                },\n            });\n            throw e;\n        }\n    };\n    const { client: servicePluginsClient, initModule: initServicePluginModule } = servicePluginsModules(getAuthStrategy);\n    const { client: eventHandlersClient, initModule: initEventHandlerModule } = eventHandlersModules(getAuthStrategy);\n    const boundFetch = async (url, options) => {\n        const authHeaders = await boundGetAuthHeaders();\n        const defaultContentTypeHeader = getDefaultContentHeader(options);\n        const response = await fetch(url, {\n            ...options,\n            headers: {\n                ...defaultContentTypeHeader,\n                ..._headers,\n                ...authHeaders?.headers,\n                ...options?.headers,\n                ...config.host?.essentials?.passThroughHeaders,\n                // Ensure consistent header always takes precedence\n                ...(_headers[X_WIX_CONSISTENT_HEADER]\n                    ? { [X_WIX_CONSISTENT_HEADER]: _headers[X_WIX_CONSISTENT_HEADER] }\n                    : {}),\n            },\n        });\n        const consistentHeader = findConsistentHeader(response);\n        if (consistentHeader) {\n            _headers[X_WIX_CONSISTENT_HEADER] = consistentHeader;\n        }\n        return response;\n    };\n    // This is typed as `any` because when trying to properly type it as defined\n    // on the WixClient, typescript starts failing with `Type instantiation is\n    // excessively deep and possibly infinite.`\n    const use = (modules, metadata) => {\n        if (isEventHandlerModule(modules)) {\n            return initEventHandlerModule(modules);\n        }\n        else if (isServicePluginModule(modules)) {\n            return initServicePluginModule(modules);\n        }\n        else if (isHostModule(modules) && config.host) {\n            return buildHostModule(modules, config.host);\n        }\n        else if (typeof modules === 'function') {\n            // The generated namespaces all have the error classes on them and\n            // a class is also a function, so we need to explicitly ignore these\n            // error classes using a static field that exists on them.\n            if ('__type' in modules && modules.__type === SERVICE_PLUGIN_ERROR_TYPE) {\n                return modules;\n            }\n            const apiBaseUrl = config.host?.apiBaseUrl ?? DEFAULT_API_URL;\n            const shouldUseCDN = config.useCDN === undefined\n                ? getAuthStrategy().shouldUseCDN\n                : config.useCDN;\n            return buildRESTDescriptor(runWithoutContext(() => isAmbassadorModule(modules))\n                ? toHTTPModule(modules)\n                : modules, metadata ?? {}, boundFetch, config.host?.getErrorHandler?.(), (relativeUrl, fetchOptions) => {\n                const finalUrl = new URL(relativeUrl, `https://${apiBaseUrl}`);\n                finalUrl.host = apiBaseUrl;\n                finalUrl.protocol = 'https';\n                return boundFetch(finalUrl.toString(), fetchOptions);\n            }, getAuthStrategy().getActiveToken, { HTTPHost: apiBaseUrl }, config.host?.name, shouldUseCDN);\n        }\n        else if (isObject(modules)) {\n            return Object.fromEntries(Object.entries(modules).map(([key, value]) => {\n                return [key, use(value, modules[PUBLIC_METADATA_KEY])];\n            }));\n        }\n        else {\n            return modules;\n        }\n    };\n    const setHeaders = (headers) => {\n        for (const k in headers) {\n            _headers[k] = headers[k];\n        }\n    };\n    const wrappedModules = config.modules\n        ? use(config.modules)\n        : {};\n    return {\n        ...wrappedModules,\n        get auth() {\n            const authStrategy = getAuthStrategy();\n            const originalGetAuthHeaders = authStrategy.getAuthHeaders;\n            authStrategy.getAuthHeaders = originalGetAuthHeaders.bind(undefined, config.host);\n            return authStrategy;\n        },\n        setHeaders,\n        use,\n        enableContext(contextType, opts = { elevated: false }) {\n            if (contextType === 'global') {\n                if (globalThis.__wix_context__ != null) {\n                    if (opts.elevated) {\n                        globalThis.__wix_context__.elevatedClient = this;\n                    }\n                    else {\n                        globalThis.__wix_context__.client = this;\n                    }\n                }\n                else {\n                    if (opts.elevated) {\n                        globalThis.__wix_context__ = { elevatedClient: this };\n                    }\n                    else {\n                        globalThis.__wix_context__ = { client: this };\n                    }\n                }\n            }\n            else {\n                if (opts.elevated) {\n                    wixContext.elevatedClient = this;\n                }\n                else {\n                    wixContext.client = this;\n                }\n            }\n        },\n        /**\n         * @param relativeUrl The URL to fetch relative to the API base URL\n         * @param options The fetch options\n         * @returns The fetch Response object\n         * @deprecated Use `fetchWithAuth` instead\n         */\n        fetch: (relativeUrl, options) => {\n            const apiBaseUrl = config.host?.apiBaseUrl ?? DEFAULT_API_URL;\n            const finalUrl = new URL(relativeUrl, `https://${apiBaseUrl}`);\n            finalUrl.host = apiBaseUrl;\n            finalUrl.protocol = 'https';\n            return boundFetch(finalUrl.toString(), options);\n        },\n        fetchWithAuth,\n        async graphql(query, variables, opts = {\n            apiVersion: 'alpha',\n        }) {\n            const apiBaseUrl = config?.host?.apiBaseUrl ?? DEFAULT_API_URL;\n            const res = await boundFetch(`https://${apiBaseUrl}/graphql/${opts.apiVersion}`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ query, variables }),\n            });\n            if (res.status !== 200) {\n                throw new FetchErrorResponse(`GraphQL request failed with status ${res.status}`, res);\n            }\n            const { data, errors } = await res.json();\n            return { data: data ?? {}, errors };\n        },\n        webhooks: eventHandlersClient,\n        servicePlugins: servicePluginsClient,\n    };\n}\nfunction findConsistentHeader(response) {\n    return (response.headers?.get(X_WIX_CONSISTENT_HEADER) ??\n        response.headers?.get(X_WIX_CONSISTENT_HEADER.toLowerCase()));\n}\n","/**\n * image service api version\n */\nconst API_VERSION = 'v1';\n/**\nthe maximum retina factor\n */\nconst MAX_DEVICE_PIXEL_RATIO = 2;\n/**\n site BG legacy max width x height\n */\nconst DSKTP_MAX_BG_SITE_LEGACY_WIDTH = 1920;\nconst DSKTP_MAX_BG_SITE_LEGACY_HEIGHT = 1920;\nconst MOBILE_MAX_BG_SITE_LEGACY_WIDTH = 1000;\nconst MOBILE_MAX_BG_SITE_LEGACY_HEIGHT = 1000;\n/**\n * Enum string values of requested image fitting types\n * Note: TILE_HORIZONTAL, TILE_VERTICAL, FIT_AND_TILE are supported for legacy purposes but are not exposed\n * in the documentation because they should not be exposed for new features\n */\nconst fittingTypes = {\n    SCALE_TO_FILL: 'fill',\n    SCALE_TO_FIT: 'fit',\n    STRETCH: 'stretch',\n    ORIGINAL_SIZE: 'original_size',\n    TILE: 'tile',\n    TILE_HORIZONTAL: 'tile_horizontal',\n    TILE_VERTICAL: 'tile_vertical',\n    FIT_AND_TILE: 'fit_and_tile',\n    LEGACY_STRIP_TILE: 'legacy_strip_tile',\n    LEGACY_STRIP_TILE_HORIZONTAL: 'legacy_strip_tile_horizontal',\n    LEGACY_STRIP_TILE_VERTICAL: 'legacy_strip_tile_vertical',\n    LEGACY_STRIP_SCALE_TO_FILL: 'legacy_strip_fill',\n    LEGACY_STRIP_SCALE_TO_FIT: 'legacy_strip_fit',\n    LEGACY_STRIP_FIT_AND_TILE: 'legacy_strip_fit_and_tile',\n    LEGACY_STRIP_ORIGINAL_SIZE: 'legacy_strip_original_size',\n    LEGACY_ORIGINAL_SIZE: 'actual_size',\n    LEGACY_FIT_WIDTH: 'fitWidth',\n    LEGACY_FIT_HEIGHT: 'fitHeight',\n    LEGACY_FULL: 'full',\n    LEGACY_BG_FIT_AND_TILE: 'legacy_tile',\n    LEGACY_BG_FIT_AND_TILE_HORIZONTAL: 'legacy_tile_horizontal',\n    LEGACY_BG_FIT_AND_TILE_VERTICAL: 'legacy_tile_vertical',\n    LEGACY_BG_NORMAL: 'legacy_normal',\n};\n/**\n * Enum string values of image transform types as passed to the image service api\n */\nconst transformTypes = {\n    FIT: 'fit',\n    FILL: 'fill',\n    FILL_FOCAL: 'fill_focal',\n    CROP: 'crop',\n    LEGACY_CROP: 'legacy_crop',\n    LEGACY_FILL: 'legacy_fill',\n};\n/**\n * Enum string values of requested image align types\n * @type {{CENTER: string, RIGHT: string, LEFT: string, TOP: string, BOTTOM: string, TOP_RIGHT: string, TOP_LEFT: string, BOTTOM_RIGHT: string, BOTTOM_LEFT: string}}\n */\nconst alignTypes = {\n    CENTER: 'center',\n    TOP: 'top',\n    TOP_LEFT: 'top_left',\n    TOP_RIGHT: 'top_right',\n    BOTTOM: 'bottom',\n    BOTTOM_LEFT: 'bottom_left',\n    BOTTOM_RIGHT: 'bottom_right',\n    LEFT: 'left',\n    RIGHT: 'right',\n};\n/**\n * Enum 9Grid alignment to focal point\n */\nconst ALIGN_TYPE_TO_FOCAL_POINT = {\n    [alignTypes.CENTER]: { x: 0.5, y: 0.5 },\n    [alignTypes.TOP_LEFT]: { x: 0, y: 0 },\n    [alignTypes.TOP_RIGHT]: { x: 1.0, y: 0 },\n    [alignTypes.TOP]: { x: 0.5, y: 0 },\n    [alignTypes.BOTTOM_LEFT]: { x: 0, y: 1.0 },\n    [alignTypes.BOTTOM_RIGHT]: { x: 1.0, y: 1.0 },\n    [alignTypes.BOTTOM]: { x: 0.5, y: 1.0 },\n    [alignTypes.RIGHT]: { x: 1.0, y: 0.5 },\n    [alignTypes.LEFT]: { x: 0, y: 0.5 },\n};\n/**\n * Enum string values of image align types as passed to the image service\n */\nconst alignTypesMap = {\n    center: 'c',\n    top: 't',\n    top_left: 'tl',\n    top_right: 'tr',\n    bottom: 'b',\n    bottom_left: 'bl',\n    bottom_right: 'br',\n    left: 'l',\n    right: 'r',\n};\n/**\n * Enum string values of html tag used to construct the css or svg attributes\n *  @type {{BG: string, IMG: string, SVG: string}}\n */\nconst htmlTag = {\n    BG: 'bg',\n    IMG: 'img',\n    SVG: 'svg',\n};\n/**\n * Enum string values of upscale method\n *  @type {{DEFAULT: string, SUPER: string}}\n */\nconst upscaleMethods = {\n    AUTO: 'auto',\n    CLASSIC: 'classic',\n    SUPER: 'super',\n};\n/**\n *  api values of upscale method\n *  @type {{default: number, super: number}}\n */\nconst upscaleMethodsValues = {\n    classic: 1,\n    super: 2,\n};\n/**\n * default unsharp mask values\n *  @type {{radius: number, amount: number, threshold: number}}\n */\nconst defaultUSM = {\n    radius: '0.66',\n    amount: '1.00',\n    threshold: '0.01',\n};\n/**\n * default empty data\n */\nconst emptyData = {\n    uri: '',\n    css: {\n        img: {},\n        container: {},\n    },\n    attr: {\n        img: {},\n        container: {},\n    },\n    transformed: false,\n};\nconst MAX_TRANSFORMED_IMAGE_WIDTH = 5000;\nconst MAX_TRANSFORMED_IMAGE_HEIGHT = 5000;\nconst SAFE_TRANSFORMED_AREA = MAX_TRANSFORMED_IMAGE_WIDTH * MAX_TRANSFORMED_IMAGE_HEIGHT;\n/**\n * super res machine learning upscale factor models -\n * @type {number[]}\n */\nconst SUPER_UPSCALE_MODELS = [1.5, 2, 4];\n/**\n * image qualities\n */\nconst imageScaleDefaults = {\n    HIGH: {\n        size: 1400 * 1400,\n        quality: 90,\n        maxUpscale: 1,\n    },\n    MEDIUM: {\n        size: 600 * 600,\n        quality: 85,\n        maxUpscale: 1,\n    },\n    LOW: {\n        size: 400 * 400,\n        quality: 80,\n        maxUpscale: 1.2,\n    },\n    TINY: {\n        size: 0,\n        quality: 80,\n        maxUpscale: 1.4,\n    },\n};\n/**\n * image quality\n * @type {{HIGH: string, MEDIUM: string, LOW: string, TINY: string}}\n */\nconst imageQuality = {\n    HIGH: 'HIGH',\n    MEDIUM: 'MEDIUM',\n    LOW: 'LOW',\n    TINY: 'TINY',\n};\n/**\n * image filters\n * @type {{CONTRAST: string, BRIGHTNESS: string, SATURATION: string, HUE: string, BLUR: string}}\n */\nconst imageFilters = {\n    CONTRAST: 'contrast',\n    BRIGHTNESS: 'brightness',\n    SATURATION: 'saturation',\n    HUE: 'hue',\n    BLUR: 'blur',\n};\nconst fileType = {\n    JPG: 'jpg',\n    JPEG: 'jpeg',\n    JPE: 'jpe',\n    PNG: 'png',\n    WEBP: 'webp',\n    WIX_ICO_MP: 'wix_ico_mp',\n    WIX_MP: 'wix_mp',\n    GIF: 'gif',\n    SVG: 'svg',\n    AVIF: 'avif',\n    UNRECOGNIZED: 'unrecognized',\n};\nconst encodingTypes = {\n    AVIF: 'AVIF',\n    PAVIF: 'PAVIF',\n};\nconst supportedExtensions = [\n    fileType.JPG,\n    fileType.JPEG,\n    fileType.JPE,\n    fileType.PNG,\n    fileType.GIF,\n    fileType.WEBP,\n];\nexport { alignTypes, alignTypesMap, transformTypes, encodingTypes, fittingTypes, htmlTag, upscaleMethods, upscaleMethodsValues, defaultUSM, emptyData, imageQuality, imageFilters, imageScaleDefaults, fileType, supportedExtensions, DSKTP_MAX_BG_SITE_LEGACY_WIDTH, MOBILE_MAX_BG_SITE_LEGACY_WIDTH, DSKTP_MAX_BG_SITE_LEGACY_HEIGHT, MOBILE_MAX_BG_SITE_LEGACY_HEIGHT, SAFE_TRANSFORMED_AREA, SUPER_UPSCALE_MODELS, MAX_DEVICE_PIXEL_RATIO, ALIGN_TYPE_TO_FOCAL_POINT, API_VERSION, };\n//# sourceMappingURL=imageServiceConstants.js.map","/**\n * Simple templates.\n * Receives a string with es6 ${...} style template arguments and returns a transformed string.\n * @param string\n * @returns {Function}\n */\nfunction template(strings, ...keys) {\n    return function (...values) {\n        const dict = values[values.length - 1] || {};\n        const result = [strings[0]];\n        keys.forEach(function (key, i) {\n            const value = Number.isInteger(key) ? values[key] : dict[key];\n            result.push(value, strings[i + 1]);\n        });\n        return result.join('');\n    };\n}\n/**\n * Get the last element in an array\n * @param array\n * @returns {*}\n */\nfunction last(array) {\n    return array[array.length - 1];\n}\nexport { last, template };\n//# sourceMappingURL=utils.js.map","import { alignTypes, alignTypesMap, fileType, fittingTypes, imageQuality, imageScaleDefaults, transformTypes, upscaleMethods, upscaleMethodsValues, ALIGN_TYPE_TO_FOCAL_POINT, MAX_DEVICE_PIXEL_RATIO, SUPER_UPSCALE_MODELS, SAFE_TRANSFORMED_AREA, } from './imageServiceConstants';\nimport { last } from './utils';\nconst SUPPORTED_IMAGE_EXTENSIONS = [\n    fileType.PNG,\n    fileType.JPEG,\n    fileType.JPG,\n    fileType.JPE,\n    fileType.WIX_ICO_MP,\n    fileType.WIX_MP,\n    fileType.WEBP,\n    fileType.AVIF,\n];\nconst JPG_EXTENSIONS = [\n    fileType.JPEG,\n    fileType.JPG,\n    fileType.JPE,\n];\n/**\n * checks if image type is supported\n * @param {string}     uri      image source uri\n *\n * @returns {boolean}\n */\nfunction isImageTypeSupported(uri) {\n    return SUPPORTED_IMAGE_EXTENSIONS.includes(getFileExtension(uri));\n}\n/**\n * check request integrity\n * @param {FittingType}             fittingType         imageService.fittingTypes\n * @param {ImageTransformSource}    src\n * @param {ImageTransformTarget}    target\n *\n * @returns {boolean}\n */\nfunction isValidRequest(fittingType, src, target) {\n    return (target &&\n        src &&\n        !isUrlEmptyOrNone(src.id) &&\n        Object.values(fittingTypes).includes(fittingType));\n}\n/**\n * Returns true if animated WebP/AVIF images can be transformed.\n * These formats can only be transformed when explicitly allowed via allowAnimatedTransform.\n *\n * @param uri - Image URI to check\n * @param hasAnimation - Whether the image has animation metadata\n * @param allowAnimatedTransform - Whether animated transforms are allowed (used in placeholder flow)\n * @returns true if the image can be transformed\n */\nfunction canTransformAnimatedWebpOrAvif(uri, hasAnimation, allowAnimatedTransform) {\n    const isAvifWebpFormat = isWEBP(uri) || isAVIF(uri);\n    if (!isAvifWebpFormat || !hasAnimation) {\n        return true;\n    }\n    return allowAnimatedTransform;\n}\n/**\n * Returns true if a GIF can be transformed.\n * GIFs can be transformed in two scenarios:\n * 1. In placeholder flow when allowAnimatedTransform is true\n * 2. In non-placeholder flow when allowFullGIFTransformation is true\n *\n * @param uri - Image URI to check\n * @param allowAnimatedTransform - Whether animated transforms are allowed (used in placeholder flow)\n * @param allowFullGIFTransformation - Whether full GIF transformation is allowed (used in non-placeholder flow)\n * @returns true if the GIF can be transformed\n */\nfunction canTransformGIF(uri, allowAnimatedTransform, allowFullGIFTransformation) {\n    if (!isGIF(uri)) {\n        return false;\n    }\n    return !!(allowAnimatedTransform || allowFullGIFTransformation);\n}\n/**\n * Check if image transform is supported for source image.\n * Returns true if:\n * - Image is a supported type (PNG, JPEG, WebP, AVIF, etc.), OR\n * - Image is a GIF that can be transformed (see canTransformGIF)\n *\n * @param uri - Image URI to check\n * @param hasAnimation - Whether the image has animation metadata\n * @param allowAnimatedTransform - Whether animated transforms are allowed (used in placeholder flow)\n * @param allowFullGIFTransformation - Whether full GIF transformation is allowed (used in non-placeholder flow)\n * @returns true if the image can be transformed\n */\nfunction isImageTransformApplicable(uri, hasAnimation, allowAnimatedTransform, allowFullGIFTransformation) {\n    // External URLs cannot be transformed\n    if (isExternalUrl(uri)) {\n        return false;\n    }\n    // Check if animated webp/avif can be transformed\n    if (!canTransformAnimatedWebpOrAvif(uri, hasAnimation, allowAnimatedTransform)) {\n        return false;\n    }\n    // Check if image type is supported or if it's a transformable GIF\n    const isSupportedImageType = isImageTypeSupported(uri);\n    const isTransformableGif = canTransformGIF(uri, allowAnimatedTransform, allowFullGIFTransformation);\n    return isSupportedImageType || isTransformableGif;\n}\n/**\n * returns true if image is of JPG type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isJPG(uri) {\n    return JPG_EXTENSIONS.includes(getFileExtension(uri));\n}\n/**\n * returns true if image is of PNG type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isPNG(uri) {\n    return getFileExtension(uri) === fileType.PNG;\n}\n/**\n * returns true if image is of webP type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isWEBP(uri) {\n    return getFileExtension(uri) === fileType.WEBP;\n}\n/**\n * returns true if image is of GIF type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isGIF(uri) {\n    return getFileExtension(uri) === fileType.GIF;\n}\n/**\n * returns true if image is of webP type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isAVIF(uri) {\n    return getFileExtension(uri) === fileType.AVIF;\n}\n/**\n * returns true if the url starts with http, https, // or data\n * @param {string}  url\n *\n * @returns {boolean}\n */\nfunction isExternalUrl(url) {\n    return /(^https?)|(^data)|(^\\/\\/)/.test(url);\n}\n/**\n * returns true if the url empty or none string\n * @param {string}  url\n *\n * @returns {boolean}\n */\nfunction isUrlEmptyOrNone(url) {\n    return !url || !url.trim() || url.toLowerCase() === 'none';\n}\n/**\n * returns search bot true or false as indicated in options\n * @param {ImageTransformOptions}   options\n *\n * @returns {boolean}\n */\nfunction isSEOBot(options) {\n    return options?.isSEOBot ?? false;\n}\n// https://jira.wixpress.com/browse/WEED-12667\n// const illegalChars = ['/', '\\\\', '#', '^', '?', '{', '}', '<', '>', '|', '`', '', ':', '\"'].map(encodeURIComponent)\nconst ILLEGAL_CHARS = ['/', '\\\\', '?', '<', '>', '|', '', ':', '\"'].map(encodeURIComponent);\nconst URL_SAFE_ILLEGAL_CHARS = ['\\\\.', '\\\\*'];\nconst ILLEGAL_CHARS_REPLACEMENT = '_';\n/**\n * returns source image file name (no extension)\n * @param {string}     uri      image source uri\n * @param {string}     [name]   optional image source name\n *\n * @returns {string}\n */\nfunction getFileName(uri, name) {\n    const beforeLeadingSlashRegexp = /\\/(.*?)$/;\n    const fileExtensionRegexp = /\\.([^.]*)$/;\n    const illegalCharsRegex = new RegExp(`(${ILLEGAL_CHARS.concat(URL_SAFE_ILLEGAL_CHARS).join('|')})`, 'g');\n    // if name is a non empty string, remove only supported extension if exists and url encode the string\n    if (name && name.length) {\n        let fileName = name;\n        const extension = name.match(fileExtensionRegexp);\n        if (extension &&\n            SUPPORTED_IMAGE_EXTENSIONS.includes(extension[1])) {\n            fileName = name.replace(fileExtensionRegexp, '');\n        }\n        return encodeURIComponent(fileName).replace(illegalCharsRegex, ILLEGAL_CHARS_REPLACEMENT);\n    }\n    // else, trim any preceding media structure from the uri string (like \"media/\" etc.) and remove extension\n    const trimmed = uri.match(beforeLeadingSlashRegexp);\n    const fileName = trimmed ? trimmed[1] : uri;\n    return fileName.replace(fileExtensionRegexp, '');\n}\n/**\n * returns source image file name (no extension)\n * @param {string}     uri      image source uri\n *\n * @returns {FileType}\n */\nfunction getFileType(uri) {\n    if (isJPG(uri)) {\n        return fileType.JPG;\n    }\n    else if (isPNG(uri)) {\n        return fileType.PNG;\n    }\n    else if (isWEBP(uri)) {\n        return fileType.WEBP;\n    }\n    else if (isGIF(uri)) {\n        return fileType.GIF;\n    }\n    else if (isAVIF(uri)) {\n        return fileType.AVIF;\n    }\n    return fileType.UNRECOGNIZED;\n}\n/**\n * returns source image file extension\n * @param {string}     uri      image source uri\n *\n * @returns {string}\n */\nfunction getFileExtension(uri) {\n    const splitURI = /[.]([^.]+)$/.exec(uri);\n    return ((splitURI && /[.]([^.]+)$/.exec(uri)[1]) || '').toLowerCase();\n}\n/**\n * returns scale factor needed if FIT fitting\n * @param {number}  sWidth\n * @param {number}  sHeight\n * @param {number}  dWidth\n * @param {number}  dHeight\n *\n * @returns {number}\n */\nfunction getFitScaleFactor(sWidth, sHeight, dWidth, dHeight) {\n    return Math.min(dWidth / sWidth, dHeight / sHeight);\n}\n/**\n * returns scale factor needed if FILL fitting\n * @param {number}  sWidth\n * @param {number}  sHeight\n * @param {number}  dWidth\n * @param {number}  dHeight\n *\n * @returns {number}\n */\nfunction getFillScaleFactor(sWidth, sHeight, dWidth, dHeight) {\n    return Math.max(dWidth / sWidth, dHeight / sHeight);\n}\n/**\n * returns scale factor source target\n * @param {number}  sWidth\n * @param {number}  sHeight\n * @param {number}  dWidth\n * @param {number}  dHeight\n * @param {string}  transformType\n *\n * @returns {number}\n */\nfunction getScaleFactor(sWidth, sHeight, dWidth, dHeight, transformType) {\n    let scaleFactor;\n    if (transformType === transformTypes.FILL) {\n        scaleFactor = getFillScaleFactor(sWidth, sHeight, dWidth, dHeight);\n    }\n    else if (transformType === transformTypes.FIT) {\n        scaleFactor = getFitScaleFactor(sWidth, sHeight, dWidth, dHeight);\n    }\n    else {\n        scaleFactor = 1;\n    }\n    return scaleFactor;\n}\n/**\n * get calculated scale factor , width and height while considering wixmp image transform dimension limits\n * @param sWidth\n * @param sHeight\n * @param dWidth\n * @param dHeight\n * @param transformType\n * @returns {{scaleFactor: *, width: *, height: *}}\n */\nfunction getSafeTransformData(sWidth, sHeight, dWidth, dHeight, transformType) {\n    let scaleFactor;\n    // defaults for FILL transform type\n    let width = dWidth;\n    let height = dHeight;\n    // calculate safe image transformed area\n    scaleFactor = getScaleFactor(sWidth, sHeight, dWidth, dHeight, transformType);\n    if (transformType === transformTypes.FIT) {\n        width = sWidth * scaleFactor;\n        height = sHeight * scaleFactor;\n    }\n    // adjust target width & height & scaleFactor\n    if (width && height && width * height > SAFE_TRANSFORMED_AREA) {\n        const dimensionScaleFactor = Math.sqrt(SAFE_TRANSFORMED_AREA / (width * height));\n        width *= dimensionScaleFactor;\n        height *= dimensionScaleFactor;\n        // get the new scale factor\n        scaleFactor = getScaleFactor(sWidth, sHeight, width, height, transformType);\n    }\n    return {\n        scaleFactor,\n        width,\n        height,\n    };\n}\n/**\n * returns the destination rectangle\n * @param {number}                  sWidth\n * @param {number}                  sHeight\n * @param {TransformType}           transformType\n * @param {ImageTransformTarget}    target\n * @param {number}                  dpr - device pixel ratio\n * @param {UpscaleMethod}           upscaleMethod\n *\n * @returns {ImageTransformData & {upscaleMethodValue: number}}\n */\nfunction getTransformData(sWidth, sHeight, transformType, target, dpr, upscaleMethod) {\n    // use target dimension is src not provided\n    sWidth = sWidth || target.width;\n    sHeight = sHeight || target.height;\n    // adjust image transform values considering server side transform limitations and performance\n    const { scaleFactor, width, height } = getSafeTransformData(sWidth, sHeight, target.width * dpr, target.height * dpr, transformType);\n    // adjust image transform values to optimizing upsacle quality and payload\n    return getOptimizedTransformData(sWidth, sHeight, width, height, upscaleMethod, scaleFactor, transformType);\n}\n/**\n * converts 9 grid alignment to Focal point position\n * @param {string}  [alignment]\n *\n * @returns {x:number,y:number}\n */\nfunction getFocalPointFrom9GridAlignment(alignment = alignTypes.CENTER) {\n    return ALIGN_TYPE_TO_FOCAL_POINT[alignment];\n}\n/**\n * returns overlapping rectangle where sRect\n * id aligned (according to alignment) within dRect\n * @param {{ width: number; height: number }} sRect rect 1\n * @param {{ width: number, height: number }} dRect rect 2\n * @param {{x: number, y: number}|undefined}  sFP   source image focal point\n * @param {string}                            alignment\n *\n * @returns {{x: number, y: number, width: number, height: number}}\n */\nfunction getAlignedRect(sRect, dRect, sFP, alignment) {\n    const fp = getFocalPoint(sFP) ||\n        getFocalPointFrom9GridAlignment(alignment);\n    const x = Math.max(0, Math.min(sRect.width - dRect.width, fp.x * sRect.width - dRect.width / 2));\n    const y = Math.max(0, Math.min(sRect.height - dRect.height, fp.y * sRect.height - dRect.height / 2));\n    // rect\n    return {\n        x,\n        y,\n        width: Math.min(sRect.width, dRect.width),\n        height: Math.min(sRect.height, dRect.height),\n    };\n}\n/**\n * returns overlapping rectangle between sRect and dRect\n * @param {object}      sRect         rect 1\n * @param {object}      dRect         rect 2\n *\n * @returns {{x:number,y:number,width:number, height:number} || null}\n */\nfunction getOverlappingRect(sRect, dRect) {\n    const width = Math.max(0, Math.min(sRect.width, dRect.x + dRect.width) - Math.max(0, dRect.x));\n    const height = Math.max(0, Math.min(sRect.height, dRect.y + dRect.height) - Math.max(0, dRect.y));\n    const isValidRect = width && height && (sRect.width !== width || sRect.height !== height);\n    // return overlapping sRect/dRect rectangle(x, y, width, height)\n    return isValidRect\n        ? {\n            x: Math.max(0, dRect.x),\n            y: Math.max(0, dRect.y),\n            width,\n            height,\n        }\n        : null;\n}\n/**\n * returns pixel aspect ratio value\n * @param {ImageTransformTarget}    target\n *\n * @returns {number}\n */\nfunction getDevicePixelRatio(target) {\n    return Math.min(target.pixelAspectRatio || 1, MAX_DEVICE_PIXEL_RATIO);\n}\n/**\n * returns target alignment value\n * @param {ImageTransformTarget}    target\n *\n * @returns {string}\n */\nfunction getAlignment(target) {\n    return ((target.alignment && alignTypesMap[target.alignment]) ||\n        alignTypesMap[alignTypes.CENTER]);\n}\n/**\n * returns the focal point value, if no focal point passed use alignment\n * @param {{x: number, y: number}|undefined} focalPoint\n */\nfunction getFocalPoint(focalPoint) {\n    let fp;\n    if (focalPoint &&\n        typeof focalPoint.x === 'number' &&\n        !isNaN(focalPoint.x) &&\n        typeof focalPoint.y === 'number' &&\n        !isNaN(focalPoint.y)) {\n        fp = {\n            x: roundToFixed(Math.max(0, Math.min(100, focalPoint.x)) / 100, 2),\n            y: roundToFixed(Math.max(0, Math.min(100, focalPoint.y)) / 100, 2),\n        };\n    }\n    return fp;\n}\n/**\n * returns preferred image quality value\n * @param {number}    imageWidth\n * @param {number}    imageHeight\n *\n * @returns {number}\n */\nfunction getPreferredImageQuality(imageWidth, imageHeight) {\n    return imageScaleDefaults[getImageQualityKey(imageWidth, imageHeight)]\n        .quality;\n}\n/**\n * returns the scale descriptor of CLASSIC upscale method\n * @param sWidth\n * @param sHeight\n * @returns {{optimizedScaleFactor: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getClassicScaleData(sWidth, sHeight) {\n    const imageKey = getImageQualityKey(sWidth, sHeight);\n    return {\n        optimizedScaleFactor: imageScaleDefaults[imageKey].maxUpscale,\n        upscaleMethodValue: upscaleMethodsValues.classic,\n        forceUSM: false,\n    };\n}\n/**\n * returns the scale descriptor of AUTO upscale method\n * @param sWidth\n * @param sHeight\n * @returns {{optimizedScaleFactor: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getAutoScaleData(sWidth, sHeight) {\n    const imageKey = getImageQualityKey(sWidth, sHeight);\n    return {\n        optimizedScaleFactor: imageScaleDefaults[imageKey].maxUpscale,\n        upscaleMethodValue: upscaleMethodsValues.classic,\n        forceUSM: false,\n    };\n}\n/**\n * returns the scale descriptor of SUPER upscale method\n * @param scaleFactor\n * @returns {{optimizedScaleFactor: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getSuperScaleData(scaleFactor) {\n    return {\n        optimizedScaleFactor: last(SUPER_UPSCALE_MODELS),\n        upscaleMethodValue: upscaleMethodsValues.super,\n        forceUSM: !(SUPER_UPSCALE_MODELS.includes(scaleFactor) ||\n            scaleFactor > last(SUPER_UPSCALE_MODELS)),\n    };\n}\n/**\n * returns upscale descriptor object\n * @param {number}    sWidth\n * @param {number}    sHeight\n * @param {string}    upscaleMethod\n * @param {number}    scaleFactor\n *\n * @returns  {{maxScale: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getOptimizedScaleData(sWidth, sHeight, scaleFactor, upscaleMethod) {\n    if (upscaleMethod === 'auto') {\n        return getAutoScaleData(sWidth, sHeight);\n    }\n    else if (upscaleMethod === 'super') {\n        return getSuperScaleData(scaleFactor);\n    }\n    // assuming 'classic' method\n    return getClassicScaleData(sWidth, sHeight);\n}\n/**\n * returns optimized upscale data, considering requested upscale method , optimize upscale for best quality and bandwidth\n * @param {number}    sWidth\n * @param {number}    sHeight\n * @param {number}    tWidth\n * @param {number}    tHeight\n * @param {UpscaleMethod}    upscaleMethod\n * @param {number}    scaleFactor\n * @param {TransformType}    transformType\n *\n * @returns  {ImageTransformData}\n */\nfunction getOptimizedTransformData(sWidth, sHeight, tWidth, tHeight, upscaleMethod, scaleFactor, transformType) {\n    const { optimizedScaleFactor, upscaleMethodValue, forceUSM } = getOptimizedScaleData(sWidth, sHeight, scaleFactor, upscaleMethod);\n    let width = tWidth;\n    let height = tHeight;\n    if (scaleFactor <= optimizedScaleFactor) {\n        // target upscale within limits or downscale\n        return {\n            width,\n            height,\n            scaleFactor,\n            upscaleMethodValue,\n            forceUSM,\n            cssUpscaleNeeded: false,\n        };\n    }\n    // limited upscale\n    switch (transformType) {\n        case transformTypes.FILL:\n            width = tWidth * (optimizedScaleFactor / scaleFactor);\n            height = tHeight * (optimizedScaleFactor / scaleFactor);\n            break;\n        case transformTypes.FIT:\n            width = sWidth * optimizedScaleFactor;\n            height = sHeight * optimizedScaleFactor;\n            break;\n        default:\n            break;\n    }\n    // adjust transform values\n    return {\n        width,\n        height,\n        scaleFactor: optimizedScaleFactor,\n        upscaleMethodValue,\n        forceUSM,\n        cssUpscaleNeeded: true,\n    };\n}\n/**\n * returns image quality key\n * @param {number}    imageWidth\n * @param {number}    imageHeight\n *\n * @returns {ImageQuality}\n */\nfunction getImageQualityKey(imageWidth, imageHeight) {\n    const size = imageWidth * imageHeight;\n    if (size > imageScaleDefaults[imageQuality.HIGH].size) {\n        return imageQuality.HIGH;\n    }\n    else if (size > imageScaleDefaults[imageQuality.MEDIUM].size) {\n        return imageQuality.MEDIUM;\n    }\n    else if (size > imageScaleDefaults[imageQuality.LOW].size) {\n        return imageQuality.LOW;\n    }\n    return imageQuality.TINY;\n}\n/**\n * return the actual rounded dimension of a scaled rectangle\n * @param sWidth\n * @param sHeight\n * @param tWidth\n * @param tHeight\n * @param transformType\n * @returns {{width: number, height: number}}\n */\nfunction getDimension(sWidth, sHeight, tWidth, tHeight, transformType) {\n    const scaleFactor = getScaleFactor(sWidth, sHeight, tWidth, tHeight, transformType);\n    return {\n        width: Math.round(sWidth * scaleFactor),\n        height: Math.round(sHeight * scaleFactor),\n    };\n}\n/**\n * rounds number n digit precision and converts to string\n * @param {number}      value\n * @param {number}      precision\n *\n * @returns {string}\n */\nfunction roundToFixed(value, precision) {\n    const truncatePrecision = Math.pow(10, precision || 0);\n    return ((value * truncatePrecision) / truncatePrecision).toFixed(precision);\n}\n/**\n * get normalize scale method\n * @param {ImageTransformOptions} [options]\n * @returns {UpscaleMethod}\n */\nfunction getUpscaleString(options) {\n    if (!options || !options.upscaleMethod) {\n        return upscaleMethods.AUTO;\n    }\n    return (upscaleMethods[options.upscaleMethod.toUpperCase()] || upscaleMethods.AUTO);\n}\nfunction imageIsAnimated(uri, hasAnimation) {\n    const isAvifWebpFormat = isWEBP(uri) || isAVIF(uri);\n    return (getFileExtension(uri) === fileType.GIF || (isAvifWebpFormat && hasAnimation));\n}\nexport { getAlignedRect, getAlignment, getDevicePixelRatio, getDimension, getFileExtension, getFileName, getFileType, getFocalPoint, getOverlappingRect, getPreferredImageQuality, getScaleFactor, getTransformData, getUpscaleString, imageIsAnimated, isExternalUrl, isImageTransformApplicable, isImageTypeSupported, isSEOBot, isValidRequest, isPNG, isWEBP, isGIF, isAVIF, roundToFixed, };\n//# sourceMappingURL=imageServiceUtils.js.map","const globalFeaturesSupportObj = {\n    /**\n     * @type {object<boolean>}\n     */\n    isMobile: false,\n};\nconst getFeature = function (feature) {\n    return globalFeaturesSupportObj[feature];\n};\nconst setFeature = function (feature, value) {\n    globalFeaturesSupportObj[feature] = value;\n};\nexport { getFeature, setFeature };\n//# sourceMappingURL=imageServiceFeatureSupportObject.js.map","import { setFeature } from './imageServiceFeatureSupportObject';\n/**\n * Populate the global feature support object with browser specific values\n */\nfunction populateGlobalFeatureSupport() {\n    if (typeof window !== 'undefined' && typeof navigator !== 'undefined') {\n        const isSmallScreen = window.matchMedia && window.matchMedia('(max-width: 767px)').matches;\n        const isMobileAgent = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        // set is mobile\n        setFeature('isMobile', isSmallScreen && isMobileAgent);\n    }\n}\nexport { populateGlobalFeatureSupport };\n//# sourceMappingURL=populateFeatureSupport.js.map","import { getFeature } from './imageServiceFeatureSupportObject';\n/**\n * get a browser detection if running on mobile device\n *\n * @returns {boolean}\n */\nfunction isMobile() {\n    return getFeature('isMobile');\n}\nexport { isMobile };\n//# sourceMappingURL=browserFeatureSupport.js.map","import { fittingTypes, transformTypes, alignTypesMap, } from './imageServiceConstants';\nimport { getAlignment, getScaleFactor, getOverlappingRect, getAlignedRect, getTransformData, getFocalPoint, } from './imageServiceUtils';\n/**\n * request analysis, returns parsed transforms object\n * @param {object}                  transformsObj\n * @param {ImageTransformSource}    src\n * @param {ImageTransformTarget}    target\n */\nfunction setTransformParts(transformsObj, src, target) {\n    let rect;\n    // crop source image if needed\n    // set crop part and adjust source dimensions\n    if (src.crop) {\n        rect = getOverlappingRect(src, src.crop);\n        if (rect) {\n            transformsObj.src.width = rect.width;\n            transformsObj.src.height = rect.height;\n            transformsObj.src.isCropped = true;\n            transformsObj.parts.push(getCropPart(rect));\n        }\n    }\n    // set additional transform part\n    switch (transformsObj.fittingType) {\n        case fittingTypes.SCALE_TO_FIT:\n        case fittingTypes.LEGACY_FIT_WIDTH:\n        case fittingTypes.LEGACY_FIT_HEIGHT:\n        case fittingTypes.LEGACY_FULL:\n        case fittingTypes.FIT_AND_TILE:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL:\n        case fittingTypes.LEGACY_BG_NORMAL:\n            // fit\n            transformsObj.parts.push(getFitPart(transformsObj, target));\n            break;\n        case fittingTypes.SCALE_TO_FILL:\n            // fill\n            transformsObj.parts.push(getFillPart(transformsObj, target));\n            break;\n        case fittingTypes.STRETCH:\n            // stretch\n            transformsObj.parts.push(getStretchPart(transformsObj, target));\n            break;\n        case fittingTypes.TILE_HORIZONTAL:\n        case fittingTypes.TILE_VERTICAL:\n        case fittingTypes.TILE:\n        case fittingTypes.LEGACY_ORIGINAL_SIZE:\n        case fittingTypes.ORIGINAL_SIZE:\n            // use crop transform\n            // if crop of source image was requested adjust cropping rectangle\n            rect = getAlignedRect(transformsObj.src, target, transformsObj.focalPoint, target.alignment);\n            if (transformsObj.src.isCropped) {\n                Object.assign(transformsObj.parts[0], rect);\n                // update source width & height accordingly\n                transformsObj.src.width = rect.width;\n                transformsObj.src.height = rect.height;\n            }\n            else {\n                transformsObj.parts.push(getCropPart(rect));\n            }\n            break;\n        // ---------------------------------------------------------------------------------------\n        // handles a legacy bug on bgImageStrip, background html tag\n        // component Full Width Strip stored incorrect image source width and height\n        // ---------------------------------------------------------------------------------------\n        case fittingTypes.LEGACY_STRIP_TILE_HORIZONTAL:\n        case fittingTypes.LEGACY_STRIP_TILE_VERTICAL:\n        case fittingTypes.LEGACY_STRIP_TILE:\n        case fittingTypes.LEGACY_STRIP_ORIGINAL_SIZE:\n            // crop request of source image is not supported\n            // use legacy crop\n            transformsObj.parts.push(getLegacyCropPart(target));\n            break;\n        case fittingTypes.LEGACY_STRIP_SCALE_TO_FIT:\n        case fittingTypes.LEGACY_STRIP_FIT_AND_TILE:\n            // legacy fit\n            transformsObj.parts.push(getLegacyFitPart(target));\n            break;\n        case fittingTypes.LEGACY_STRIP_SCALE_TO_FILL:\n            // legacy fill\n            transformsObj.parts.push(getLegacyFillPart(target));\n            break;\n    }\n}\n/**\n * returns fit part of the image transform uri\n * @param {object}                  transformsObj\n * @param {ImageTransformTarget}    target\n *\n * @returns {TransformFitPart}\n */\nfunction getFitPart(transformsObj, target) {\n    // calculate the transformed image size needed\n    const transformedData = getTransformData(transformsObj.src.width, transformsObj.src.height, transformTypes.FIT, target, transformsObj.devicePixelRatio, transformsObj.upscaleMethod);\n    const isMissingSrcDimensions = !transformsObj.src.width || !transformsObj.src.height;\n    const transformType = isMissingSrcDimensions\n        ? transformTypes.FIT\n        : transformTypes.FILL;\n    // return fit transform data\n    return {\n        transformType,\n        width: Math.round(transformedData.width),\n        height: Math.round(transformedData.height),\n        alignment: alignTypesMap.center,\n        upscale: transformedData.scaleFactor > 1,\n        forceUSM: transformedData.forceUSM,\n        scaleFactor: transformedData.scaleFactor,\n        cssUpscaleNeeded: transformedData.cssUpscaleNeeded,\n        upscaleMethodValue: transformedData.upscaleMethodValue,\n    };\n}\n/**\n * returns fill part of the image transform uri\n * @param {ImageTransformObject} transformsObj\n * @param {ImageTransformTarget} target\n *\n * @returns {TransformFillPart}\n */\nfunction getFillPart(transformsObj, target) {\n    // calculate the transformed image size needed\n    const transformedData = getTransformData(transformsObj.src.width, transformsObj.src.height, transformTypes.FILL, target, transformsObj.devicePixelRatio, transformsObj.upscaleMethod);\n    const focalPoint = getFocalPoint(transformsObj.focalPoint);\n    const transformType = focalPoint\n        ? transformTypes.FILL_FOCAL\n        : transformTypes.FILL;\n    return {\n        transformType,\n        width: Math.round(transformedData.width),\n        height: Math.round(transformedData.height),\n        alignment: getAlignment(target),\n        focalPointX: focalPoint && focalPoint.x,\n        focalPointY: focalPoint && focalPoint.y,\n        upscale: transformedData.scaleFactor > 1,\n        forceUSM: transformedData.forceUSM,\n        scaleFactor: transformedData.scaleFactor,\n        cssUpscaleNeeded: transformedData.cssUpscaleNeeded,\n        upscaleMethodValue: transformedData.upscaleMethodValue,\n    };\n}\n/**\n * returns fill part of the image transform uri\n * @param {ImageTransformObject} transformsObj\n * @param {ImageTransformTarget} target\n *\n * @returns {TransformFitPart}\n */\nfunction getStretchPart(transformsObj, target) {\n    // stretch data\n    const scaleFactor = getScaleFactor(transformsObj.src.width, transformsObj.src.height, target.width, target.height, transformTypes.FILL);\n    const clonedTarget = { ...target };\n    clonedTarget.width = transformsObj.src.width * scaleFactor;\n    clonedTarget.height = transformsObj.src.height * scaleFactor;\n    // return stretch part\n    return getFitPart(transformsObj, clonedTarget);\n}\n/**\n * returns crop part of the image transform uri\n * @param {{x: number, y: number, width: number, height: number}}  rect     x, y, width, height\n *\n * @returns {TransformCropPart}\n */\nfunction getCropPart(rect) {\n    return {\n        transformType: transformTypes.CROP,\n        x: Math.round(rect.x),\n        y: Math.round(rect.y),\n        width: Math.round(rect.width),\n        height: Math.round(rect.height),\n        upscale: false,\n        forceUSM: false,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\n// ---------------------------------------------------------------------------------------\n// handles a legacy bug on bgImageStrip, background html tag\n// component Full Width Strip stored incorrect image source width and height\n// ---------------------------------------------------------------------------------------\n/**\n * returns fit part of the image transform uri\n * @param {ImageTransformTarget}    target\n *\n * @returns {TransformLegacyFitPart}\n */\nfunction getLegacyFitPart(target) {\n    return {\n        transformType: transformTypes.FIT,\n        width: Math.round(target.width),\n        height: Math.round(target.height),\n        upscale: false,\n        forceUSM: true,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\n/**\n * returns fill part of the image transform uri\n * @param {ImageTransformTarget}    target\n *\n * @returns {TransformLegacyFillPart}\n */\nfunction getLegacyFillPart(target) {\n    return {\n        transformType: transformTypes.LEGACY_FILL,\n        width: Math.round(target.width),\n        height: Math.round(target.height),\n        alignment: getAlignment(target),\n        upscale: false,\n        forceUSM: true,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\n/**\n * returns legacy crop part of the image transform uri\n * @param {ImageTransformTarget}     target\n *\n * @returns {TransformLegacyCropPart}\n */\nfunction getLegacyCropPart(target) {\n    return {\n        transformType: transformTypes.LEGACY_CROP,\n        width: Math.round(target.width),\n        height: Math.round(target.height),\n        alignment: getAlignment(target),\n        upscale: false,\n        forceUSM: false,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\nexport { setTransformParts };\n//# sourceMappingURL=imageTransformParts.js.map","import { last } from './utils';\nimport { getPreferredImageQuality, roundToFixed } from './imageServiceUtils';\nimport { defaultUSM, fileType, imageFilters, transformTypes, } from './imageServiceConstants';\n/**\n * returns image filters part of the image transform uri\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformOptions}   [options]\n */\nfunction setTransformOptions(transformsObj, options) {\n    options = options || {};\n    // options - general\n    transformsObj.quality = getQuality(transformsObj, options);\n    transformsObj.progressive = getProgressive(options);\n    transformsObj.watermark = getWatermark(options);\n    transformsObj.autoEncode = options.autoEncode ?? true;\n    transformsObj.encoding = options?.encoding;\n    // options - filters & adjustments\n    transformsObj.unsharpMask = getUnsharpMask(transformsObj, options);\n    transformsObj.filters = getFilters(options);\n}\n/**\n *\n * @param {ImageTransformOptions}   options\n * @returns {string}\n */\nfunction getWatermark(options) {\n    return options.watermark;\n}\n/**\n * returns progressive if required\n * @param {ImageTransformOptions}   options\n *\n * @returns {boolean}\n */\nfunction getProgressive(options) {\n    return options.progressive !== false;\n}\n/**\n * returns image filters part of the image transform uri\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformOptions}   options\n *\n * @returns {number}\n */\nfunction getQuality(transformsObj, options) {\n    const isPNG = transformsObj.fileType === fileType.PNG;\n    const isJPG = transformsObj.fileType === fileType.JPG;\n    const isWEBP = transformsObj.fileType === fileType.WEBP;\n    const isAVIF = transformsObj.fileType === fileType.AVIF;\n    const isQualitySupported = isJPG || isPNG || isWEBP || isAVIF;\n    if (isQualitySupported) {\n        const transformData = last(transformsObj.parts);\n        const defaultQuality = getPreferredImageQuality(transformData.width, transformData.height);\n        let quality = options.quality && options.quality >= 5 && options.quality <= 90\n            ? options.quality\n            : defaultQuality;\n        // increase quality by 5 for webp images\n        quality = isPNG ? quality + 5 : quality;\n        return quality;\n    }\n    // quality not supported\n    return 0;\n}\n/**\n * returns the desired transformed image filters\n * @param {ImageTransformOptions}   options\n *\n * @returns {object}\n */\nfunction getFilters(options) {\n    const filterOptions = options.filters || {};\n    const filters = {};\n    // contrast\n    if (isValidImageFilter(filterOptions[imageFilters.CONTRAST], -100, 100)) {\n        filters[imageFilters.CONTRAST] = filterOptions[imageFilters.CONTRAST];\n    }\n    // brightness\n    if (isValidImageFilter(filterOptions[imageFilters.BRIGHTNESS], -100, 100)) {\n        filters[imageFilters.BRIGHTNESS] = filterOptions[imageFilters.BRIGHTNESS];\n    }\n    // saturation\n    if (isValidImageFilter(filterOptions[imageFilters.SATURATION], -100, 100)) {\n        filters[imageFilters.SATURATION] = filterOptions[imageFilters.SATURATION];\n    }\n    // hue\n    if (isValidImageFilter(filterOptions[imageFilters.HUE], -180, 180)) {\n        filters[imageFilters.HUE] = filterOptions[imageFilters.HUE];\n    }\n    // blur\n    if (isValidImageFilter(filterOptions[imageFilters.BLUR], 0, 100)) {\n        filters[imageFilters.BLUR] = filterOptions[imageFilters.BLUR];\n    }\n    return filters;\n}\n/**\n * indicates if requested filter value is valid\n * @param {number|undefined}  filterValue     filter's value\n * @param {number}  minValue        min range\n * @param {number}  maxValue        max range\n *\n * @returns {boolean}\n */\nfunction isValidImageFilter(filterValue, minValue, maxValue) {\n    // check if filter name and filter values range valid\n    return (typeof filterValue === 'number' &&\n        !isNaN(filterValue) &&\n        filterValue !== 0 &&\n        filterValue >= minValue &&\n        filterValue <= maxValue);\n}\n/**\n * returns the desired transformed image unSharpMask values\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformOptions}   options\n *\n * @returns {object}\n */\nfunction getUnsharpMask(transformsObj, options) {\n    // If options.unsharpMask is a valid value, use it\n    if (isUSMValid(options.unsharpMask)) {\n        // If we got usm, change values to have trailing zeros (.00), else return undefined\n        return {\n            radius: roundToFixed(options.unsharpMask?.radius, 2),\n            amount: roundToFixed(options.unsharpMask?.amount, 2),\n            threshold: roundToFixed(options.unsharpMask?.threshold, 2),\n        };\n        // if options.unsharpMask is not all zeros and not valid and usm should be used, use default\n    }\n    else if (!isZeroUSM(options.unsharpMask) && isUSMNeeded(transformsObj)) {\n        return defaultUSM;\n    }\n    return;\n}\n/**\n * indicates if usm is needed\n * @param {ImageTransformObject}      transformsObj   transform parts object\n *\n * @returns {boolean}\n */\nfunction isUSMNeeded(transformsObj) {\n    // ---------------------------------------------------------------------------------------\n    // do not apply usm if transformed image width & height is same as source image or larger\n    // and no force usm is desired\n    // and transform type is not fit\n    // ---------------------------------------------------------------------------------------\n    const transformPart = last(transformsObj.parts);\n    const upscale = transformPart.scaleFactor >= 1;\n    // return if usm is needed\n    return (!upscale ||\n        transformPart.forceUSM ||\n        transformPart.transformType === transformTypes.FIT);\n}\n/**\n * indicates if all usm values are presented and in range\n * @param {OptionUnsharpMask|undefined}  usm     unsharp mask\n *\n * @returns {boolean}\n */\nfunction isUSMValid(usm) {\n    usm = usm || {};\n    const radius = typeof usm.radius === 'number' &&\n        !isNaN(usm.radius) &&\n        usm.radius >= 0.1 &&\n        usm.radius <= 500;\n    const amount = typeof usm.amount === 'number' &&\n        !isNaN(usm.amount) &&\n        usm.amount >= 0 &&\n        usm.amount <= 10;\n    const threshold = typeof usm.threshold === 'number' &&\n        !isNaN(usm.threshold) &&\n        usm.threshold >= 0 &&\n        usm.threshold <= 255;\n    // return is a valid USM data\n    return radius && amount && threshold;\n}\n/**\n * indicates if all usm values are presented and are zero. an explicit request to not apply usm\n * @param {OptionUnsharpMask|undefined}  usm     unsharp mask\n *\n * @returns {boolean}\n */\nfunction isZeroUSM(usm) {\n    usm = usm || {};\n    return (typeof usm.radius === 'number' &&\n        !isNaN(usm.radius) &&\n        usm.radius === 0 &&\n        typeof usm.amount === 'number' &&\n        !isNaN(usm.amount) &&\n        usm.amount === 0 &&\n        typeof usm.threshold === 'number' &&\n        !isNaN(usm.threshold) &&\n        usm.threshold === 0);\n}\nexport { setTransformOptions };\n//# sourceMappingURL=imageTransformOptions.js.map","import { isSEOBot, getFileType, getFileName, getFileExtension, getDevicePixelRatio, getUpscaleString, isImageTransformApplicable, imageIsAnimated, } from '../helpers/imageServiceUtils';\nimport { isMobile } from '../helpers/browserFeatureSupport';\nimport { setTransformParts } from '../helpers/imageTransformParts';\nimport { setTransformOptions } from '../helpers/imageTransformOptions';\nimport { MOBILE_MAX_BG_SITE_LEGACY_WIDTH, DSKTP_MAX_BG_SITE_LEGACY_WIDTH, MOBILE_MAX_BG_SITE_LEGACY_HEIGHT, DSKTP_MAX_BG_SITE_LEGACY_HEIGHT, fittingTypes, } from '../helpers/imageServiceConstants';\n/**\n * returns image transform data\n *\n * @param {FittingType}             fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   [options]           transform options\n *\n * @returns {ImageTransformObject}\n */\nfunction getTransform(fittingType, src, target, options) {\n    const _isSEOBot = isSEOBot(options);\n    const fileType = getFileType(src.id);\n    const fileName = getFileName(src.id, src.name);\n    const devicePixelRatio = _isSEOBot ? 1 : getDevicePixelRatio(target);\n    const fileExtension = getFileExtension(src.id);\n    const preferredExtension = fileExtension;\n    const canTransformImage = isImageTransformApplicable(src.id, options?.hasAnimation, options?.allowAnimatedTransform, options?.allowFullGIFTransformation);\n    const transformsObj = {\n        fileName,\n        fileExtension,\n        fileType,\n        fittingType,\n        preferredExtension,\n        src: {\n            id: src.id,\n            width: src.width,\n            height: src.height,\n            isCropped: false,\n            isAnimated: imageIsAnimated(src.id, options?.hasAnimation),\n        },\n        focalPoint: {\n            x: src.focalPoint && src.focalPoint.x,\n            y: src.focalPoint && src.focalPoint.y,\n        },\n        parts: [],\n        // options - general\n        devicePixelRatio,\n        quality: 0,\n        upscaleMethod: getUpscaleString(options),\n        progressive: true,\n        watermark: '',\n        unsharpMask: {},\n        filters: {},\n        transformed: canTransformImage,\n        allowFullGIFTransformation: options?.allowFullGIFTransformation,\n        isPlaceholderFlow: options?.isPlaceholderFlow,\n    };\n    if (canTransformImage) {\n        setTransformParts(transformsObj, src, target);\n        setTransformOptions(transformsObj, options);\n    }\n    return transformsObj;\n}\n/**\n * returns target data\n * handle legacy BG site if needed\n *\n * @param {FittingType}             fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n *\n * @returns {Object}\n */\nfunction getTarget(fittingType, src, target) {\n    const targetObj = { ...target };\n    const _isMobile = isMobile();\n    // handle site BG legacy fitting types (desktop & mobile)\n    switch (fittingType) {\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL:\n        case fittingTypes.LEGACY_BG_NORMAL:\n            const maxBGSiteLegacyWidth = _isMobile\n                ? MOBILE_MAX_BG_SITE_LEGACY_WIDTH\n                : DSKTP_MAX_BG_SITE_LEGACY_WIDTH;\n            const maxBGSiteLegacyHeight = _isMobile\n                ? MOBILE_MAX_BG_SITE_LEGACY_HEIGHT\n                : DSKTP_MAX_BG_SITE_LEGACY_HEIGHT;\n            targetObj.width = Math.min(maxBGSiteLegacyWidth, src.width);\n            targetObj.height = Math.min(maxBGSiteLegacyHeight, Math.round(targetObj.width / (src.width / src.height)));\n            // for legacy types force htmlTag='bg' and devicePixelRatio=1\n            targetObj.pixelAspectRatio = 1;\n    }\n    return targetObj;\n}\nexport { getTransform, getTarget };\n//# sourceMappingURL=transform.js.map","import { template } from '../helpers/utils';\nimport { imageFilters, transformTypes, API_VERSION, fileType, encodingTypes, } from '../helpers/imageServiceConstants';\nimport { isGIF } from '../helpers/imageServiceUtils';\n// transform templates\nconst fitTemplate = template `fit/w_${'width'},h_${'height'}`;\nconst fillTemplate = template `fill/w_${'width'},h_${'height'},al_${'alignment'}`;\nconst fillFocalTemplate = template `fill/w_${'width'},h_${'height'},fp_${'focalPointX'}_${'focalPointY'}`;\nconst cropTemplate = template `crop/x_${'x'},y_${'y'},w_${'width'},h_${'height'}`;\n// legacy templates\nconst legacyCropTemplate = template `crop/w_${'width'},h_${'height'},al_${'alignment'}`;\nconst legacyFillTemplate = template `fill/w_${'width'},h_${'height'},al_${'alignment'}`;\n// upscale template\nconst upscaleTemplate = template `,lg_${'upscaleMethodValue'}`;\n// options templates\nconst qualityTemplate = template `,q_${'quality'}`;\nconst qualityAutoTemplate = template `,quality_auto`;\nconst unSharpMaskTemplate = template `,usm_${'radius'}_${'amount'}_${'threshold'}`;\nconst nonProgressiveTemplate = template `,bl`;\nconst watermarkTemplate = template `,wm_${'watermark'}`;\nconst filterTemplatesMap = {\n    [imageFilters.CONTRAST]: template `,con_${'contrast'}`,\n    [imageFilters.BRIGHTNESS]: template `,br_${'brightness'}`,\n    [imageFilters.SATURATION]: template `,sat_${'saturation'}`,\n    [imageFilters.HUE]: template `,hue_${'hue'}`,\n    [imageFilters.BLUR]: template `,blur_${'blur'}`,\n};\nconst autoEncodeTemplate = template `,enc_auto`;\nconst AVIFEncodeTemplate = template `,enc_avif`;\nconst pAVIFEncodeTemplate = template `,enc_pavif`;\nconst animatedTransformTemplate = template `,pstr`;\nconst animatedGIFTransformTemplate = template `,anm_-1`;\n/**\n * returns image transform uri\n * @param {object}  transformsObj\n *\n * @returns {string}\n */\nfunction getImageURI(transformsObj) {\n    // construct image transforms\n    const transformsObjStrArr = [];\n    // construct transform\n    transformsObj.parts.forEach((transformPart) => {\n        switch (transformPart.transformType) {\n            case transformTypes.CROP:\n                transformsObjStrArr.push(cropTemplate(transformPart));\n                break;\n            case transformTypes.LEGACY_CROP:\n                transformsObjStrArr.push(legacyCropTemplate(transformPart));\n                break;\n            case transformTypes.LEGACY_FILL:\n                let legacyFillStr = legacyFillTemplate(transformPart);\n                if (transformPart.upscale) {\n                    legacyFillStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(legacyFillStr);\n                break;\n            case transformTypes.FIT:\n                let fitStr = fitTemplate(transformPart);\n                if (transformPart.upscale) {\n                    fitStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(fitStr);\n                break;\n            case transformTypes.FILL:\n                let fillStr = fillTemplate(transformPart);\n                if (transformPart.upscale) {\n                    fillStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(fillStr);\n                break;\n            case transformTypes.FILL_FOCAL:\n                let fillFocalStr = fillFocalTemplate(transformPart);\n                if (transformPart.upscale) {\n                    fillFocalStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(fillFocalStr);\n                break;\n        }\n    });\n    let transformsStr = transformsObjStrArr.join('/');\n    // construct transform options\n    // quality\n    if (transformsObj.quality) {\n        transformsStr += qualityTemplate(transformsObj);\n    }\n    // un-sharp mask\n    if (transformsObj.unsharpMask) {\n        transformsStr += unSharpMaskTemplate(transformsObj.unsharpMask);\n    }\n    // progressive\n    if (!transformsObj.progressive) {\n        transformsStr += nonProgressiveTemplate(transformsObj);\n    }\n    // watermark\n    if (transformsObj.watermark) {\n        transformsStr += watermarkTemplate(transformsObj);\n    }\n    // filters\n    if (transformsObj.filters) {\n        transformsStr += Object.keys(transformsObj.filters)\n            .map((filterName) => filterTemplatesMap[filterName](transformsObj.filters))\n            .join('');\n    }\n    // encoding\n    if (transformsObj.fileType !== fileType.GIF) {\n        if (transformsObj.encoding === encodingTypes.AVIF) {\n            transformsStr += AVIFEncodeTemplate(transformsObj);\n            transformsStr += qualityAutoTemplate(transformsObj);\n        }\n        else if (transformsObj.encoding === encodingTypes.PAVIF) {\n            transformsStr += pAVIFEncodeTemplate(transformsObj);\n            transformsStr += qualityAutoTemplate(transformsObj);\n        }\n        else if (transformsObj.autoEncode) {\n            transformsStr += autoEncodeTemplate(transformsObj);\n        }\n    }\n    // animated images transforms\n    if (transformsObj.src?.isAnimated && transformsObj.transformed) {\n        const isGif = isGIF(transformsObj.src.id);\n        const isPlaceholderFlow = transformsObj.isPlaceholderFlow === true;\n        const allowFullGIFTransformation = transformsObj.allowFullGIFTransformation === true;\n        if (isPlaceholderFlow) {\n            transformsStr += animatedTransformTemplate(transformsObj);\n        }\n        else if (isGif && allowFullGIFTransformation) {\n            // Non-placeholder flow + GIF + flag enabled: use anm_-1\n            transformsStr += animatedGIFTransformTemplate(transformsObj);\n        }\n    }\n    // image url string\n    return `${transformsObj.src.id}/${API_VERSION}/${transformsStr}/${transformsObj.fileName}.${transformsObj.preferredExtension}`;\n}\nexport { getImageURI };\n//# sourceMappingURL=transforms.js.map","import { isAVIF, isImageTransformApplicable, isWEBP, } from '../helpers/imageServiceUtils';\nimport { getImageURI } from '../engines/transforms';\nimport { getTransform } from './transform';\n/**\n * returns image transform uri\n *\n * @param {string}                  fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   options             transform options\n * @param {Object}                  [transformObj]      transform data object to use\n *\n * @returns {string}\n */\nfunction getURI(fittingType, src, target, options = {}, transformObj) {\n    // check if image transformation is applicable (e.g. .gif, .wix_mp)\n    if (isImageTransformApplicable(src.id, options?.hasAnimation, options?.allowAnimatedTransform, options?.allowFullGIFTransformation)) {\n        if (isWEBP(src.id) || isAVIF(src.id)) {\n            // exclude alignment, focalPoint and crop from webp and avif transformation in order not to break webp or avif images before transformation was enabled\n            const { alignment, ...transformTarget } = target;\n            src.focalPoint = { x: undefined, y: undefined };\n            delete src?.crop;\n            transformObj = getTransform(fittingType, src, transformTarget, options);\n        }\n        else {\n            transformObj =\n                transformObj || getTransform(fittingType, src, target, options);\n        }\n        // set the uri property\n        return getImageURI(transformObj);\n    }\n    return src.id;\n}\nexport { getURI };\n//# sourceMappingURL=uri.js.map","import { alignTypes, fittingTypes } from './imageServiceConstants';\nimport { isPNG } from './imageServiceUtils';\nconst ALIGN_TYPE_TO_POSITION = {\n    [alignTypes.CENTER]: '50% 50%',\n    [alignTypes.TOP_LEFT]: '0% 0%',\n    [alignTypes.TOP_RIGHT]: '100% 0%',\n    [alignTypes.TOP]: '50% 0%',\n    [alignTypes.BOTTOM_LEFT]: '0% 100%',\n    [alignTypes.BOTTOM_RIGHT]: '100% 100%',\n    [alignTypes.BOTTOM]: '50% 100%',\n    [alignTypes.RIGHT]: '100% 50%',\n    [alignTypes.LEFT]: '0% 50%',\n};\nconst POSITION_TO_ALIGN_TYPE = Object.entries(ALIGN_TYPE_TO_POSITION).reduce((acc, [align, position]) => {\n    acc[position] = align;\n    return acc;\n}, {});\nconst TILE_FITTING_TYPES = [\n    fittingTypes.TILE,\n    fittingTypes.TILE_HORIZONTAL,\n    fittingTypes.TILE_VERTICAL,\n    fittingTypes.LEGACY_BG_FIT_AND_TILE,\n    fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,\n    fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL,\n];\nconst NON_SCALING_FITTING_TYPES = [\n    fittingTypes.LEGACY_ORIGINAL_SIZE,\n    fittingTypes.ORIGINAL_SIZE,\n    fittingTypes.LEGACY_BG_NORMAL,\n];\nfunction getIsFakeTile(fittingType, src, { width: targetWidth, height: targetHeight, }) {\n    return (fittingType === fittingTypes.TILE &&\n        src.width > targetWidth &&\n        src.height > targetHeight);\n}\n/**\n *\n * @param {FittingType}             fittingType      imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src              source image\n * @param {Dimensions}              target           target container dimensions\n * @param {boolean}                 [isSEOBot=false] whether it is a render for a bot request\n * @returns {Dimensions} scaled dimensions\n */\nfunction getScaledDimensions(fittingType, src, { width, height }, isSEOBot = false) {\n    if (isSEOBot) {\n        return { width, height };\n    }\n    const isScalable = !NON_SCALING_FITTING_TYPES.includes(fittingType);\n    const isFakeTile = getIsFakeTile(fittingType, src, { width, height });\n    const isTile = !isFakeTile && TILE_FITTING_TYPES.includes(fittingType);\n    const _width = isTile ? src.width : width;\n    const _height = isTile ? src.height : height;\n    const scaleFactor = isScalable\n        ? getScaleFactorByWidth(_width, isPNG(src.id))\n        : 1;\n    return {\n        width: isFakeTile ? 1920 : _width * scaleFactor,\n        height: _height * scaleFactor,\n    };\n}\n/**\n *\n * @param {FittingType} fittingType  imageServicesTypes.fittingTypes\n * @param {boolean} isFakeTile\n * @returns {string} fittingType\n */\nfunction getConvertedFitting(fittingType, isFakeTile) {\n    const isTile = TILE_FITTING_TYPES.includes(fittingType) && !isFakeTile;\n    const isFill = fittingType === fittingTypes.SCALE_TO_FILL;\n    return isFill || isTile ? fittingTypes.SCALE_TO_FIT : fittingType;\n}\n/**\n *\n * @param {ImageTransformSource}    src                 source image\n * @param {number || ''}            width\n * @param {number || ''}            height\n * @returns {Dimensions}    width, height\n */\nfunction validateTargetDimensions(src, { width, height }) {\n    if (!width || !height) {\n        const _width = width || Math.min(980, src.width);\n        const heightRatio = _width / src.width;\n        return {\n            width: _width,\n            height: height || src.height * heightRatio,\n        };\n    }\n    return { width, height };\n}\n/**\n *\n * @param {number} width\n * @param {boolean} isHighQuality\n * @return {number}\n */\nfunction getScaleFactorByWidth(width, isHighQuality) {\n    if (width > 900) {\n        return isHighQuality ? 0.05 : 0.15;\n    }\n    else if (width > 500) {\n        return isHighQuality ? 0.1 : 0.18;\n    }\n    else if (width > 200) {\n        return 0.25;\n    }\n    return 1;\n}\n/**\n *\n * @param {number} width\n * @param {FittingType} fittingType imageServicesTypes.fittingTypes\n * @param {boolean} isSEOBot\n * @return {number}\n */\nfunction getBlurValue(width, fittingType, isSEOBot) {\n    if (isSEOBot) {\n        return 0;\n    }\n    if (TILE_FITTING_TYPES.includes(fittingType)) {\n        return 1;\n    }\n    if (width > 200) {\n        return 2;\n    }\n    return 3;\n}\n/**\n *\n * @param {FittingType}                       fittingType\n * @param {ImageTransformSource}              src                  source image\n * @param {{width?: number; height?: number}} target               target element\n * @param {string}                            [alignment='center']\n * @returns {{img}, {container}}\n */\nfunction getCSSOverrides(fittingType, src, target, alignment = 'center') {\n    const returnValue = {\n        img: {},\n        container: {},\n    };\n    if (fittingType === fittingTypes.SCALE_TO_FILL) {\n        const alignTypeFromFocalPoint = src.focalPoint && convertFocalPointToAlignType(src.focalPoint);\n        const alignType = alignTypeFromFocalPoint || alignment;\n        if (src.focalPoint && !alignTypeFromFocalPoint) {\n            returnValue.img = {\n                objectPosition: convertFillFocalToPosition(src, target, src.focalPoint),\n            };\n        }\n        else {\n            returnValue.img = {\n                objectPosition: ALIGN_TYPE_TO_POSITION[alignType],\n            };\n        }\n    }\n    else if ([fittingTypes.LEGACY_ORIGINAL_SIZE, fittingTypes.ORIGINAL_SIZE].includes(fittingType)) {\n        returnValue.img = {\n            objectFit: 'none',\n            top: 'auto',\n            left: 'auto',\n            right: 'auto',\n            bottom: 'auto',\n        };\n    }\n    else if (TILE_FITTING_TYPES.includes(fittingType)) {\n        returnValue.container = {\n            backgroundSize: `${src.width}px ${src.height}px`,\n        };\n    }\n    return returnValue;\n}\n/**\n * Try to convert focal point value to 9 grid alignment value\n *\n * @param {Point}    focalPoint\n * @returns {AlignType} align type\n */\nfunction convertFocalPointToAlignType(focalPoint) {\n    const position = `${focalPoint.x}% ${focalPoint.y}%`;\n    return POSITION_TO_ALIGN_TYPE[position] || '';\n}\n/**\n *\n * @param {Dimensions} src source dimensions\n * @param {width?: number; height?: number} target target dimensions\n * @param {Point} focalPoint x/y as 0-100 percentages\n * @returns {string} in 'x% y%' format\n */\nfunction convertFillFocalToPosition(src, target, focalPoint) {\n    const { width: sW, height: sH } = src;\n    const { width: tW, height: tH } = target;\n    const { x: fpX, y: fpY } = focalPoint;\n    if (!tW || !tH) {\n        return `${fpX}% ${fpY}%`;\n    }\n    const fillScaleFactor = Math.max(tW / sW, tH / sH);\n    const imgScaledW = sW * fillScaleFactor;\n    const imgScaledH = sH * fillScaleFactor;\n    const x = Math.max(0, Math.min(imgScaledW - tW, imgScaledW * (fpX / 100) - tW / 2));\n    const y = Math.max(0, Math.min(imgScaledH - tH, imgScaledH * (fpY / 100) - tH / 2));\n    const posX = x && Math.floor((x / (imgScaledW - tW)) * 100);\n    const posY = y && Math.floor((y / (imgScaledH - tH)) * 100);\n    return `${posX}% ${posY}%`;\n}\nexport { getBlurValue, getConvertedFitting, getCSSOverrides, getIsFakeTile, getScaledDimensions, validateTargetDimensions, };\n//# sourceMappingURL=imagePlaceholderUtils.js.map","import { fittingTypes, alignTypes, htmlTag, upscaleMethods, } from '../../helpers/imageServiceConstants';\nimport { isValidRequest } from '../../helpers/imageServiceUtils';\nimport { populateGlobalFeatureSupport } from '../../helpers/populateFeatureSupport';\nimport { getTarget, getTransform } from '../transform';\nimport { getURI } from '../uri';\n/**\n * returns image transform uri\n *\n * @param {FittingType}             fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   [options]           transform options\n *\n * @returns {{uri: string}}\n */\nfunction getData(fittingType, src, target, options) {\n    // check if valid request\n    if (isValidRequest(fittingType, src, target)) {\n        // handle site BG legacy fitting types\n        const targetObj = getTarget(fittingType, src, target);\n        // parse request and create working OBJ\n        const transformObj = getTransform(fittingType, src, targetObj, options);\n        return {\n            uri: getURI(fittingType, src, targetObj, options || {}, transformObj),\n        };\n    }\n    return { uri: '' };\n}\nexport { populateGlobalFeatureSupport, getData, fittingTypes, alignTypes, htmlTag, upscaleMethods, };\n//# sourceMappingURL=index.js.map","import { getData, populateGlobalFeatureSupport } from '../api/uri/index';\nimport { fittingTypes, htmlTag, alignTypes, } from '../helpers/imageServiceConstants';\nconst wixStatic = 'https://static.wixstatic.com/';\nconst wixStaticWithMedia = 'https://static.wixstatic.com/media/';\nconst HAS_MEDIA_PREFIX_RE = /^media\\//i;\nconst devicePixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio : 1;\nconst getWixStaticURL = (uri) => HAS_MEDIA_PREFIX_RE.test(uri)\n    ? `${wixStatic}${uri}`\n    : `${wixStaticWithMedia}${uri}`;\nconst getURL = (uri, options) => {\n    const baseHostURL = options && options.baseHostURL;\n    return baseHostURL ? `${baseHostURL}${uri}` : getWixStaticURL(uri);\n};\nfunction getScaleToFitImageURL(relativeUrl, sourceWidth, sourceHeight, targetWidth, targetHeight, options) {\n    const data = getData(fittingTypes.SCALE_TO_FIT, {\n        id: relativeUrl,\n        width: sourceWidth,\n        height: sourceHeight,\n        name: options && options.name,\n    }, {\n        width: targetWidth,\n        height: targetHeight,\n        htmlTag: htmlTag.IMG,\n        alignment: alignTypes.CENTER,\n        pixelAspectRatio: options?.devicePixelRatio ?? devicePixelRatio,\n    }, options);\n    return getURL(data.uri, options);\n}\nfunction getScaleToFillImageURL(relativeUrl, sourceWidth, sourceHeight, targetWidth, targetHeight, options) {\n    const data = getData(fittingTypes.SCALE_TO_FILL, {\n        id: relativeUrl,\n        width: sourceWidth,\n        height: sourceHeight,\n        name: options && options.name,\n        focalPoint: {\n            x: options && options.focalPoint && options.focalPoint.x,\n            y: options && options.focalPoint && options.focalPoint.y,\n        },\n    }, {\n        width: targetWidth,\n        height: targetHeight,\n        htmlTag: htmlTag.IMG,\n        alignment: alignTypes.CENTER,\n        pixelAspectRatio: options?.devicePixelRatio ?? devicePixelRatio,\n    }, options);\n    return getURL(data.uri, options);\n}\nfunction getCropImageURL(relativeUrl, sourceWidth, sourceHeight, cropX, cropY, cropWidth, cropHeight, targetWidth, targetHeight, options) {\n    const data = getData(fittingTypes.SCALE_TO_FILL, {\n        id: relativeUrl,\n        width: sourceWidth,\n        height: sourceHeight,\n        name: options && options.name,\n        crop: {\n            x: cropX,\n            y: cropY,\n            width: cropWidth,\n            height: cropHeight,\n        },\n    }, {\n        width: targetWidth,\n        height: targetHeight,\n        htmlTag: htmlTag.IMG,\n        alignment: alignTypes.CENTER,\n        pixelAspectRatio: options?.devicePixelRatio ?? devicePixelRatio,\n    }, options);\n    return getURL(data.uri, options);\n}\nexport { populateGlobalFeatureSupport, getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStatic, wixStaticWithMedia, };\n//# sourceMappingURL=api.js.map","import { populateGlobalFeatureSupport, getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStatic, wixStaticWithMedia, } from './api';\npopulateGlobalFeatureSupport();\nexport { getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStatic, wixStaticWithMedia, };\n//# sourceMappingURL=index.js.map","import { alignTypes, fittingTypes, htmlTag, upscaleMethods, fileType, } from '../../helpers/imageServiceConstants';\nimport { isWEBP, getFileExtension } from '../../helpers/imageServiceUtils';\nimport { populateGlobalFeatureSupport } from '../../helpers/populateFeatureSupport';\nimport { getData, getPlaceholder } from './api';\nimport { getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStaticWithMedia, } from '../../sdk';\nimport { getResponsiveImageProps } from '../../helpers/responsiveImageUtils';\npopulateGlobalFeatureSupport();\nconst sdk = {\n    getScaleToFitImageURL,\n    getScaleToFillImageURL,\n    getCropImageURL,\n};\nexport * from '../../types';\nconst STATIC_MEDIA_URL = wixStaticWithMedia;\nexport { STATIC_MEDIA_URL, alignTypes, fittingTypes, getData, getPlaceholder, htmlTag, populateGlobalFeatureSupport, sdk, upscaleMethods, isWEBP, getFileExtension, fileType, getResponsiveImageProps, };\n//# sourceMappingURL=index.js.map","import { sdk } from '@wix/image-kit';\nconst WIX_PROTOCOL = 'wix:';\nconst WIX_IMAGE = 'image';\nconst WIX_VIDEO = 'video';\nconst WIX_AUDIO = 'audio';\nconst WIX_DOCUMENT = 'document';\nconst WIX_IMAGE_URL = 'https://static.wixstatic.com/media/';\nconst WIX_SHAPES_URL = 'https://static.wixstatic.com/shapes/';\nconst WIX_VIDEO_URL = 'https://video.wixstatic.com/video/';\nconst WIX_AUDIO_URL = 'https://static.wixstatic.com/mp3/';\nconst WIX_DOCUMENT_URL = 'https://d945e594-8657-47e2-9cd9-e9033c3d8da0.usrfiles.com/ugd/';\nexport function getScaledToFillImageUrl(wixMediaIdentifier, targetWidth, targetHeight, options) {\n    const img = getImageUrl(wixMediaIdentifier);\n    return sdk.getScaleToFillImageURL(img.id, img.height, img.width, targetWidth, targetHeight, options);\n}\nexport function getScaledToFitImageUrl(wixMediaIdentifier, targetWidth, targetHeight, options) {\n    const img = getImageUrl(wixMediaIdentifier);\n    return sdk.getScaleToFitImageURL(img.id, img.height, img.width, targetWidth, targetHeight, options);\n}\nexport function getCroppedImageUrl(wixMediaIdentifier, cropX, cropY, cropWidth, cropHeight, targetWidth, targetHeight, options) {\n    const img = getImageUrl(wixMediaIdentifier);\n    return sdk.getCropImageURL(img.id, img.height, img.width, cropX, cropY, cropWidth, cropHeight, targetWidth, targetHeight, options);\n}\nexport function getImageUrl(val) {\n    return getBaseImageUrl(val, WIX_IMAGE_URL);\n}\nexport function getShapeUrl(val) {\n    return getBaseImageUrl(val, WIX_SHAPES_URL);\n}\nexport function getBaseImageUrl(val, baseUrl = WIX_IMAGE_URL) {\n    let id, filenameOrAltText;\n    let height, width;\n    if (val.startsWith(baseUrl)) {\n        id = val.split(baseUrl).pop().split('/')[0];\n        width = val.split('/w_').pop().split(',')[0];\n        height = val.split(',h_').pop().split(',')[0];\n    }\n    else {\n        const alignedImage = alignIfLegacy(val, WIX_IMAGE);\n        const { hash, pathname } = new URL(alignedImage);\n        const params = new URLSearchParams(hash.replace('#', ''));\n        height = params.get('originHeight');\n        width = params.get('originWidth');\n        [id, filenameOrAltText] = pathname\n            .replace(`${WIX_IMAGE}://v1/`, '')\n            .split('/');\n    }\n    // @ts-expect-error\n    const decodedFilenameOrAltText = decodeText(filenameOrAltText);\n    const res = {\n        id,\n        url: `${baseUrl}${id}`,\n        height: Number(height),\n        width: Number(width),\n    };\n    if (!decodedFilenameOrAltText) {\n        return res;\n    }\n    return {\n        ...res,\n        altText: decodedFilenameOrAltText,\n        filename: decodedFilenameOrAltText,\n    };\n}\nexport function getVideoUrl(val, resolution) {\n    let id, thumbnailId, thumbnailWidth, thumbnailHeight, decodedFilename = '';\n    if (val.startsWith(WIX_VIDEO_URL)) {\n        id = val.split(WIX_VIDEO_URL).pop().split('/')[0];\n        thumbnailId = `${id}.jpg`;\n        thumbnailWidth = '50';\n        thumbnailHeight = '50';\n    }\n    else {\n        const alignedVideo = alignIfLegacy(val, WIX_VIDEO);\n        const { pathname, hash } = new URL(alignedVideo);\n        const hashParams = new URLSearchParams(hash.replace('#', ''));\n        const [_id, fileName] = pathname\n            .replace(`${WIX_VIDEO}://v1/`, '')\n            .split('/');\n        id = _id;\n        thumbnailId = hashParams.get('posterUri') || `${id}.jpg`;\n        thumbnailWidth = hashParams.get('posterWidth') || '50';\n        thumbnailHeight = hashParams.get('posterHeight') || '50';\n        decodedFilename = decodeText(fileName);\n    }\n    const res = {\n        id,\n        url: `${WIX_VIDEO_URL}${id}/${resolution ? `${resolution}/mp4/file.mp4` : 'file'}`,\n        thumbnail: `${WIX_PROTOCOL}${WIX_IMAGE}://v1/${thumbnailId}#originWidth=${thumbnailWidth}&originHeight=${thumbnailHeight}`,\n    };\n    if (!decodedFilename) {\n        return res;\n    }\n    return {\n        ...res,\n        filename: decodedFilename,\n    };\n}\nexport function getAudioUrl(val) {\n    const alignedAudio = alignIfLegacy(val, WIX_AUDIO);\n    const { pathname, hash } = new URL(alignedAudio);\n    const [id, filename] = pathname.replace(`${WIX_AUDIO}://v1/`, '').split('/');\n    const decodedFilename = decodeText(filename);\n    const hashParams = new URLSearchParams(hash.replace('#', ''));\n    const res = {\n        id,\n        duration: Number(hashParams.get('duration') || ''),\n        url: `${WIX_AUDIO_URL}${id}`,\n    };\n    if (!decodedFilename) {\n        return res;\n    }\n    return {\n        ...res,\n        filename: decodedFilename,\n    };\n}\nexport function getDocumentUrl(val) {\n    const valWithoutUGD = val.replace('v1/ugd', 'v1');\n    const alignedDocument = alignIfLegacy(valWithoutUGD, WIX_DOCUMENT);\n    const { pathname } = new URL(alignedDocument);\n    const [id, filename] = pathname\n        .replace(`${WIX_DOCUMENT}://v1/`, '')\n        .split('/');\n    const decodedFilename = decodeText(filename);\n    const res = {\n        id,\n        url: `${WIX_DOCUMENT_URL}${id}`,\n    };\n    if (!decodedFilename) {\n        return res;\n    }\n    return {\n        ...res,\n        filename: decodedFilename,\n    };\n}\nexport function decodeText(s) {\n    if (!s) {\n        return s;\n    }\n    return decodeURIComponent(s);\n}\nfunction alignIfLegacy(url, type) {\n    const { protocol } = new URL(url);\n    return protocol === `${type}:` ? `${WIX_PROTOCOL}${url}` : url;\n}\nexport var VideoResolution;\n(function (VideoResolution) {\n    VideoResolution[\"MOBILE\"] = \"360p\";\n    VideoResolution[\"LOW\"] = \"480p\";\n    VideoResolution[\"MID\"] = \"720p\";\n    VideoResolution[\"HIGH\"] = \"1080p\";\n})(VideoResolution || (VideoResolution = {}));\n","import { getAudioUrl, getCroppedImageUrl, getDocumentUrl, getImageUrl, getScaledToFillImageUrl, getScaledToFitImageUrl, getVideoUrl, getShapeUrl, } from './media/helpers.js';\nexport { VideoResolution, decodeText } from './media/helpers.js';\nexport const media = {\n    getCroppedImageUrl,\n    getScaledToFillImageUrl,\n    getScaledToFitImageUrl,\n    getImageUrl,\n    getVideoUrl,\n    getAudioUrl,\n    getDocumentUrl,\n    getShapeUrl,\n};\n","// src/headless-v1-redirect-session-redirects.public.ts\nimport { renameKeysFromRESTResponseToSDKResponse as renameKeysFromRESTResponseToSDKResponse2 } from \"@wix/sdk-runtime/rename-all-nested-keys\";\nimport { transformRESTTimestampToSDKTimestamp } from \"@wix/sdk-runtime/transformations/timestamp\";\nimport { transformPaths } from \"@wix/sdk-runtime/transformations/transform-paths\";\nimport { EventDefinition } from \"@wix/sdk-types\";\n\n// src/headless-v1-redirect-session-redirects.universal.ts\nimport { transformError as sdkTransformError } from \"@wix/sdk-runtime/transform-error\";\nimport {\n  renameKeysFromSDKRequestToRESTRequest,\n  renameKeysFromRESTResponseToSDKResponse\n} from \"@wix/sdk-runtime/rename-all-nested-keys\";\n\n// src/headless-v1-redirect-session-redirects.http.ts\nimport { resolveUrl } from \"@wix/sdk-runtime/rest-modules\";\nfunction resolveWixHeadlessV1RedirectSessionServiceUrl(opts) {\n  const domainToMappings = {\n    \"www._base_domain_\": [\n      {\n        srcPath: \"/_api/redirects-api\",\n        destPath: \"\"\n      }\n    ],\n    \"www.wixapis.com\": [\n      {\n        srcPath: \"/_api/redirects-api\",\n        destPath: \"\"\n      },\n      {\n        srcPath: \"/redirect-session\",\n        destPath: \"\"\n      },\n      {\n        srcPath: \"/headless/v1/redirect-session\",\n        destPath: \"/v1/redirect-session\"\n      }\n    ],\n    \"*.dev.wix-code.com\": [\n      {\n        srcPath: \"/headless/v1/redirect-session\",\n        destPath: \"/v1/redirect-session\"\n      }\n    ],\n    _: [\n      {\n        srcPath: \"/headless/v1/redirect-session\",\n        destPath: \"/v1/redirect-session\"\n      }\n    ]\n  };\n  return resolveUrl(Object.assign(opts, { domainToMappings }));\n}\nvar PACKAGE_NAME = \"@wix/auto_sdk_redirects_redirects\";\nfunction createRedirectSession(payload) {\n  function __createRedirectSession({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.headless.v1.redirect_session\",\n      method: \"POST\",\n      methodFqn: \"wix.headless.v1.RedirectSessionService.CreateRedirectSession\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixHeadlessV1RedirectSessionServiceUrl({\n        protoPath: \"/v1/redirect-session\",\n        data: payload,\n        host\n      }),\n      data: payload\n    };\n    return metadata;\n  }\n  return __createRedirectSession;\n}\n\n// src/headless-v1-redirect-session-redirects.universal.ts\nvar LocationType = /* @__PURE__ */ ((LocationType2) => {\n  LocationType2[\"UNDEFINED\"] = \"UNDEFINED\";\n  LocationType2[\"OWNER_BUSINESS\"] = \"OWNER_BUSINESS\";\n  LocationType2[\"OWNER_CUSTOM\"] = \"OWNER_CUSTOM\";\n  LocationType2[\"CUSTOM\"] = \"CUSTOM\";\n  return LocationType2;\n})(LocationType || {});\nvar Prompt = /* @__PURE__ */ ((Prompt2) => {\n  Prompt2[\"login\"] = \"login\";\n  Prompt2[\"none\"] = \"none\";\n  return Prompt2;\n})(Prompt || {});\nvar MembersAccountSection = /* @__PURE__ */ ((MembersAccountSection2) => {\n  MembersAccountSection2[\"ACCOUNT_INFO\"] = \"ACCOUNT_INFO\";\n  MembersAccountSection2[\"BOOKINGS\"] = \"BOOKINGS\";\n  MembersAccountSection2[\"ORDERS\"] = \"ORDERS\";\n  MembersAccountSection2[\"SUBSCRIPTIONS\"] = \"SUBSCRIPTIONS\";\n  MembersAccountSection2[\"EVENTS\"] = \"EVENTS\";\n  return MembersAccountSection2;\n})(MembersAccountSection || {});\nvar AttachPagesResponseStatus = /* @__PURE__ */ ((AttachPagesResponseStatus2) => {\n  AttachPagesResponseStatus2[\"UNKNOWN\"] = \"UNKNOWN\";\n  AttachPagesResponseStatus2[\"SUCCESS\"] = \"SUCCESS\";\n  AttachPagesResponseStatus2[\"NO_ACTION\"] = \"NO_ACTION\";\n  AttachPagesResponseStatus2[\"ERROR\"] = \"ERROR\";\n  return AttachPagesResponseStatus2;\n})(AttachPagesResponseStatus || {});\nvar CallbackType = /* @__PURE__ */ ((CallbackType2) => {\n  CallbackType2[\"UNKNOWN\"] = \"UNKNOWN\";\n  CallbackType2[\"LOGOUT\"] = \"LOGOUT\";\n  CallbackType2[\"CHECKOUT\"] = \"CHECKOUT\";\n  CallbackType2[\"AUTHORIZE\"] = \"AUTHORIZE\";\n  return CallbackType2;\n})(CallbackType || {});\nvar Status = /* @__PURE__ */ ((Status2) => {\n  Status2[\"UNKNOWN\"] = \"UNKNOWN\";\n  Status2[\"SUCCESS\"] = \"SUCCESS\";\n  Status2[\"ERROR\"] = \"ERROR\";\n  return Status2;\n})(Status || {});\nvar WebhookIdentityType = /* @__PURE__ */ ((WebhookIdentityType2) => {\n  WebhookIdentityType2[\"UNKNOWN\"] = \"UNKNOWN\";\n  WebhookIdentityType2[\"ANONYMOUS_VISITOR\"] = \"ANONYMOUS_VISITOR\";\n  WebhookIdentityType2[\"MEMBER\"] = \"MEMBER\";\n  WebhookIdentityType2[\"WIX_USER\"] = \"WIX_USER\";\n  WebhookIdentityType2[\"APP\"] = \"APP\";\n  return WebhookIdentityType2;\n})(WebhookIdentityType || {});\nasync function createRedirectSession2(options) {\n  const { httpClient, sideEffects } = arguments[1];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    bookingsCheckout: options?.bookingsCheckout,\n    ecomCheckout: options?.ecomCheckout,\n    eventsCheckout: options?.eventsCheckout,\n    paidPlansCheckout: options?.paidPlansCheckout,\n    login: options?.login,\n    logout: options?.logout,\n    auth: options?.auth,\n    storesProduct: options?.storesProduct,\n    bookingsBook: options?.bookingsBook,\n    callbacks: options?.callbacks,\n    preferences: options?.preferences,\n    origin: options?.origin\n  });\n  const reqOpts = createRedirectSession(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(result.data);\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          bookingsCheckout: \"$[0].bookingsCheckout\",\n          ecomCheckout: \"$[0].ecomCheckout\",\n          eventsCheckout: \"$[0].eventsCheckout\",\n          paidPlansCheckout: \"$[0].paidPlansCheckout\",\n          login: \"$[0].login\",\n          logout: \"$[0].logout\",\n          auth: \"$[0].auth\",\n          storesProduct: \"$[0].storesProduct\",\n          bookingsBook: \"$[0].bookingsBook\",\n          callbacks: \"$[0].callbacks\",\n          preferences: \"$[0].preferences\",\n          origin: \"$[0].origin\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\n\n// src/headless-v1-redirect-session-redirects.public.ts\nfunction createRedirectSession3(httpClient) {\n  return (options) => createRedirectSession2(\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nvar onRedirectSessionCreated = EventDefinition(\n  \"wix.headless.v1.redirect_session_created\",\n  true,\n  (event) => renameKeysFromRESTResponseToSDKResponse2(\n    transformPaths(event, [\n      {\n        transformFn: transformRESTTimestampToSDKTimestamp,\n        paths: [{ path: \"metadata.eventTime\" }]\n      }\n    ])\n  )\n)();\n\n// src/headless-v1-redirect-session-redirects.context.ts\nimport { createRESTModule } from \"@wix/sdk-runtime/rest-modules\";\nimport { createEventModule } from \"@wix/sdk-runtime/event-definition-modules\";\nvar createRedirectSession4 = /* @__PURE__ */ createRESTModule(createRedirectSession3);\nvar onRedirectSessionCreated2 = createEventModule(\n  onRedirectSessionCreated\n);\nexport {\n  AttachPagesResponseStatus,\n  CallbackType,\n  LocationType,\n  MembersAccountSection,\n  Prompt,\n  Status,\n  WebhookIdentityType,\n  createRedirectSession4 as createRedirectSession,\n  onRedirectSessionCreated2 as onRedirectSessionCreated\n};\n//# sourceMappingURL=index.mjs.map","export function getCurrentDate() {\n    return Math.floor(Date.now() / 1000);\n}\nexport function isTokenExpired(token) {\n    const currentDate = getCurrentDate();\n    return token.expiresAt < currentDate;\n}\nexport function createAccessToken(accessToken, expiresIn) {\n    const now = getCurrentDate();\n    return { value: accessToken, expiresAt: Number(expiresIn) + now };\n}\n","export function transformSDKBytesToRESTBytes(val) {\n    const chars = val.reduce((res, c) => res + String.fromCharCode(c), '');\n    return btoa(chars);\n}\nexport function transformRESTBytesToSDKBytes(val) {\n    return Uint8Array.from(atob(val), (c) => c.charCodeAt(0));\n}\n","import { removeUndefinedKeys } from '../utils.js';\nexport function transformSDKAddressToRESTAddress(payload) {\n    return (payload &&\n        removeUndefinedKeys({\n            city: payload.city,\n            hint: payload.hint,\n            subdivision: payload.subdivision,\n            country: payload.country,\n            postalCode: payload.postalCode,\n            formattedAddress: payload.formatted,\n            geocode: payload.location,\n            addressLine: payload.addressLine1,\n            addressLine2: payload.addressLine2,\n            streetAddress: payload.streetAddress && {\n                name: payload.streetAddress.name,\n                number: payload.streetAddress.number,\n                apt: payload.streetAddress.apt,\n            },\n        }));\n}\nexport function transformRESTAddressToSDKAddress(payload) {\n    return (payload &&\n        removeUndefinedKeys({\n            formatted: payload.formattedAddress,\n            location: payload.geocode,\n            addressLine1: payload.addressLine,\n            addressLine2: payload.addressLine2,\n            streetAddress: payload.streetAddress && {\n                name: payload.streetAddress.name,\n                number: payload.streetAddress.number,\n                apt: payload.streetAddress.apt,\n            },\n            hint: payload.hint,\n            city: payload.city,\n            subdivision: payload.subdivision,\n            country: payload.country,\n            postalCode: payload.postalCode,\n            countryFullname: payload.countryFullname,\n            subdivisionFullname: payload.subdivisionFullname,\n        }));\n}\n","// src/iam-authentication-v1-authentication-authentication.universal.ts\nimport { transformError as sdkTransformError } from \"@wix/sdk-runtime/transform-error\";\nimport {\n  renameKeysFromSDKRequestToRESTRequest,\n  renameKeysFromRESTResponseToSDKResponse\n} from \"@wix/sdk-runtime/rename-all-nested-keys\";\n\n// src/iam-authentication-v1-authentication-authentication.http.ts\nimport { toURLSearchParams } from \"@wix/sdk-runtime/rest-modules\";\nimport { transformSDKFloatToRESTFloat } from \"@wix/sdk-runtime/transformations/float\";\nimport { transformRESTFloatToSDKFloat } from \"@wix/sdk-runtime/transformations/float\";\nimport { transformRESTBytesToSDKBytes } from \"@wix/sdk-runtime/transformations/bytes\";\nimport { transformSDKTimestampToRESTTimestamp } from \"@wix/sdk-runtime/transformations/timestamp\";\nimport { transformRESTTimestampToSDKTimestamp } from \"@wix/sdk-runtime/transformations/timestamp\";\nimport { transformPaths } from \"@wix/sdk-runtime/transformations/transform-paths\";\nimport { resolveUrl } from \"@wix/sdk-runtime/rest-modules\";\nfunction resolveWixIamAuthenticationV1AuthenticationServiceUrl(opts) {\n  const domainToMappings = {\n    _: [\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"users._base_domain_\": [\n      {\n        srcPath: \"/iam/wix/google\",\n        destPath: \"/v1/sso/callback/root/0e6a50f5-b523-4e29-990d-f37fa2ffdd69\"\n      },\n      {\n        srcPath: \"/authentication\",\n        destPath: \"\"\n      },\n      {\n        srcPath: \"/_api/iam/authentication/v1/sso/callback\",\n        destPath: \"/v1/sso/callback\"\n      },\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"www.wixapis.com\": [\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      },\n      {\n        srcPath: \"/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"bo._base_domain_\": [\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"wixbo.ai\": [\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"wix-bo.com\": [\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"dev._base_domain_\": [\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"manage._base_domain_\": [\n      {\n        srcPath: \"/_api/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"www._base_domain_\": [\n      {\n        srcPath: \"/_api/iam/authentication\",\n        destPath: \"\"\n      }\n    ],\n    \"*.dev.wix-code.com\": [\n      {\n        srcPath: \"/iam/authentication/v2/sign-on\",\n        destPath: \"/v2/sign-on\"\n      },\n      {\n        srcPath: \"/iam/authentication/v1/logout\",\n        destPath: \"/v1/logout\"\n      },\n      {\n        srcPath: \"/iam/authentication/v2/change-password\",\n        destPath: \"/v2/change-password\"\n      },\n      {\n        srcPath: \"/iam/authentication/v2/verify\",\n        destPath: \"/v2/verify\"\n      },\n      {\n        srcPath: \"/iam/authentication/v2/login\",\n        destPath: \"/v2/login\"\n      },\n      {\n        srcPath: \"/iam/authentication/v2/register\",\n        destPath: \"/v2/register\"\n      },\n      {\n        srcPath: \"/iam/authentication/v2\",\n        destPath: \"/v2\"\n      }\n    ]\n  };\n  return resolveUrl(Object.assign(opts, { domainToMappings }));\n}\nvar PACKAGE_NAME = \"@wix/auto_sdk_identity_authentication\";\nfunction registerV2(payload) {\n  function __registerV2({ host }) {\n    const serializedData = transformPaths(payload, [\n      {\n        transformFn: transformSDKFloatToRESTFloat,\n        paths: [{ path: \"profile.customFields.value.numValue\" }]\n      },\n      {\n        transformFn: transformSDKTimestampToRESTTimestamp,\n        paths: [{ path: \"profile.customFields.value.dateValue\" }]\n      }\n    ]);\n    const metadata = {\n      entityFqdn: \"wix.iam.authentication.v1.authentication\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.authentication.v1.AuthenticationService.RegisterV2\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamAuthenticationV1AuthenticationServiceUrl({\n        protoPath: \"/v2/register\",\n        data: serializedData,\n        host\n      }),\n      data: serializedData,\n      transformResponse: (payload2) => transformPaths(payload2, [\n        {\n          transformFn: transformRESTTimestampToSDKTimestamp,\n          paths: [\n            { path: \"identity.createdDate\" },\n            { path: \"identity.updatedDate\" },\n            { path: \"identity.identityProfile.customFields.value.dateValue\" },\n            { path: \"additionalData.*.dateValue\" }\n          ]\n        },\n        {\n          transformFn: transformRESTFloatToSDKFloat,\n          paths: [\n            { path: \"identity.identityProfile.customFields.value.numValue\" },\n            { path: \"additionalData.*.numValue\" }\n          ]\n        }\n      ])\n    };\n    return metadata;\n  }\n  return __registerV2;\n}\nfunction loginV2(payload) {\n  function __loginV2({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.authentication.v1.authentication\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.authentication.v1.AuthenticationService.LoginV2\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamAuthenticationV1AuthenticationServiceUrl({\n        protoPath: \"/v2/login\",\n        data: payload,\n        host\n      }),\n      data: payload,\n      transformResponse: (payload2) => transformPaths(payload2, [\n        {\n          transformFn: transformRESTTimestampToSDKTimestamp,\n          paths: [\n            { path: \"identity.createdDate\" },\n            { path: \"identity.updatedDate\" },\n            { path: \"identity.identityProfile.customFields.value.dateValue\" },\n            { path: \"additionalData.*.dateValue\" }\n          ]\n        },\n        {\n          transformFn: transformRESTFloatToSDKFloat,\n          paths: [\n            { path: \"identity.identityProfile.customFields.value.numValue\" },\n            { path: \"additionalData.*.numValue\" }\n          ]\n        }\n      ])\n    };\n    return metadata;\n  }\n  return __loginV2;\n}\nfunction changePassword(payload) {\n  function __changePassword({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.authentication.v1.authentication\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.authentication.v1.AuthenticationService.ChangePassword\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamAuthenticationV1AuthenticationServiceUrl({\n        protoPath: \"/v2/change-password\",\n        data: payload,\n        host\n      }),\n      data: payload\n    };\n    return metadata;\n  }\n  return __changePassword;\n}\nfunction signOn(payload) {\n  function __signOn({ host }) {\n    const serializedData = transformPaths(payload, [\n      {\n        transformFn: transformSDKFloatToRESTFloat,\n        paths: [{ path: \"profile.customFields.value.numValue\" }]\n      },\n      {\n        transformFn: transformSDKTimestampToRESTTimestamp,\n        paths: [{ path: \"profile.customFields.value.dateValue\" }]\n      }\n    ]);\n    const metadata = {\n      entityFqdn: \"wix.iam.authentication.v1.authentication\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.authentication.v1.AuthenticationService.SignOn\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamAuthenticationV1AuthenticationServiceUrl({\n        protoPath: \"/v2/sign-on\",\n        data: serializedData,\n        host\n      }),\n      data: serializedData,\n      transformResponse: (payload2) => transformPaths(payload2, [\n        {\n          transformFn: transformRESTTimestampToSDKTimestamp,\n          paths: [\n            { path: \"identity.createdDate\" },\n            { path: \"identity.updatedDate\" },\n            { path: \"identity.identityProfile.customFields.value.dateValue\" }\n          ]\n        },\n        {\n          transformFn: transformRESTFloatToSDKFloat,\n          paths: [\n            { path: \"identity.identityProfile.customFields.value.numValue\" }\n          ]\n        }\n      ])\n    };\n    return metadata;\n  }\n  return __signOn;\n}\nfunction logout(payload) {\n  function __logout({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.authentication.v1.authentication\",\n      method: \"GET\",\n      methodFqn: \"wix.iam.authentication.v1.AuthenticationService.Logout\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamAuthenticationV1AuthenticationServiceUrl({\n        protoPath: \"/v1/logout\",\n        data: payload,\n        host\n      }),\n      params: toURLSearchParams(payload),\n      transformResponse: (payload2) => transformPaths(payload2, [\n        {\n          transformFn: transformRESTBytesToSDKBytes,\n          paths: [{ path: \"body\" }]\n        }\n      ])\n    };\n    return metadata;\n  }\n  return __logout;\n}\n\n// src/iam-authentication-v1-authentication-authentication.universal.ts\nimport { transformSDKAddressToRESTAddress } from \"@wix/sdk-runtime/transformations/address\";\nimport { transformRESTAddressToSDKAddress } from \"@wix/sdk-runtime/transformations/address\";\nimport { transformPaths as transformPaths2 } from \"@wix/sdk-runtime/transformations/transform-paths\";\nvar PrivacyStatus = /* @__PURE__ */ ((PrivacyStatus2) => {\n  PrivacyStatus2[\"UNDEFINED\"] = \"UNDEFINED\";\n  PrivacyStatus2[\"PUBLIC\"] = \"PUBLIC\";\n  PrivacyStatus2[\"PRIVATE\"] = \"PRIVATE\";\n  return PrivacyStatus2;\n})(PrivacyStatus || {});\nvar EmailTag = /* @__PURE__ */ ((EmailTag2) => {\n  EmailTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  EmailTag2[\"MAIN\"] = \"MAIN\";\n  EmailTag2[\"HOME\"] = \"HOME\";\n  EmailTag2[\"WORK\"] = \"WORK\";\n  return EmailTag2;\n})(EmailTag || {});\nvar PhoneTag = /* @__PURE__ */ ((PhoneTag2) => {\n  PhoneTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  PhoneTag2[\"MAIN\"] = \"MAIN\";\n  PhoneTag2[\"HOME\"] = \"HOME\";\n  PhoneTag2[\"MOBILE\"] = \"MOBILE\";\n  PhoneTag2[\"WORK\"] = \"WORK\";\n  PhoneTag2[\"FAX\"] = \"FAX\";\n  return PhoneTag2;\n})(PhoneTag || {});\nvar AddressTag = /* @__PURE__ */ ((AddressTag2) => {\n  AddressTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  AddressTag2[\"HOME\"] = \"HOME\";\n  AddressTag2[\"WORK\"] = \"WORK\";\n  AddressTag2[\"BILLING\"] = \"BILLING\";\n  AddressTag2[\"SHIPPING\"] = \"SHIPPING\";\n  return AddressTag2;\n})(AddressTag || {});\nvar StateType = /* @__PURE__ */ ((StateType2) => {\n  StateType2[\"UNKNOWN_STATE\"] = \"UNKNOWN_STATE\";\n  StateType2[\"SUCCESS\"] = \"SUCCESS\";\n  StateType2[\"REQUIRE_OWNER_APPROVAL\"] = \"REQUIRE_OWNER_APPROVAL\";\n  StateType2[\"REQUIRE_EMAIL_VERIFICATION\"] = \"REQUIRE_EMAIL_VERIFICATION\";\n  StateType2[\"STATUS_CHECK\"] = \"STATUS_CHECK\";\n  return StateType2;\n})(StateType || {});\nvar StatusName = /* @__PURE__ */ ((StatusName2) => {\n  StatusName2[\"UNKNOWN_STATUS\"] = \"UNKNOWN_STATUS\";\n  StatusName2[\"PENDING\"] = \"PENDING\";\n  StatusName2[\"ACTIVE\"] = \"ACTIVE\";\n  StatusName2[\"DELETED\"] = \"DELETED\";\n  StatusName2[\"BLOCKED\"] = \"BLOCKED\";\n  StatusName2[\"OFFLINE\"] = \"OFFLINE\";\n  return StatusName2;\n})(StatusName || {});\nvar Reason = /* @__PURE__ */ ((Reason2) => {\n  Reason2[\"UNKNOWN_REASON\"] = \"UNKNOWN_REASON\";\n  Reason2[\"PENDING_ADMIN_APPROVAL_REQUIRED\"] = \"PENDING_ADMIN_APPROVAL_REQUIRED\";\n  Reason2[\"PENDING_EMAIL_VERIFICATION_REQUIRED\"] = \"PENDING_EMAIL_VERIFICATION_REQUIRED\";\n  return Reason2;\n})(Reason || {});\nvar FactorType = /* @__PURE__ */ ((FactorType2) => {\n  FactorType2[\"UNKNOWN_FACTOR_TYPE\"] = \"UNKNOWN_FACTOR_TYPE\";\n  FactorType2[\"PASSWORD\"] = \"PASSWORD\";\n  FactorType2[\"SMS\"] = \"SMS\";\n  FactorType2[\"CALL\"] = \"CALL\";\n  FactorType2[\"EMAIL\"] = \"EMAIL\";\n  FactorType2[\"TOTP\"] = \"TOTP\";\n  FactorType2[\"PUSH\"] = \"PUSH\";\n  FactorType2[\"WEBAUTHN\"] = \"WEBAUTHN\";\n  FactorType2[\"RECOVERY_CODE\"] = \"RECOVERY_CODE\";\n  return FactorType2;\n})(FactorType || {});\nvar Status = /* @__PURE__ */ ((Status2) => {\n  Status2[\"INACTIVE\"] = \"INACTIVE\";\n  Status2[\"ACTIVE\"] = \"ACTIVE\";\n  Status2[\"REQUIRE_REENROLL\"] = \"REQUIRE_REENROLL\";\n  return Status2;\n})(Status || {});\nvar FactorStatus = /* @__PURE__ */ ((FactorStatus2) => {\n  FactorStatus2[\"UNKNOWN_FACTOR_STATUS\"] = \"UNKNOWN_FACTOR_STATUS\";\n  FactorStatus2[\"ENABLED\"] = \"ENABLED\";\n  FactorStatus2[\"REQUIRE_ACTIVATION\"] = \"REQUIRE_ACTIVATION\";\n  FactorStatus2[\"REQUIRE_REENROLL\"] = \"REQUIRE_REENROLL\";\n  FactorStatus2[\"ENABLED_BY_RULE\"] = \"ENABLED_BY_RULE\";\n  FactorStatus2[\"DISABLED_BY_RULE\"] = \"DISABLED_BY_RULE\";\n  return FactorStatus2;\n})(FactorStatus || {});\nvar MfaReason = /* @__PURE__ */ ((MfaReason2) => {\n  MfaReason2[\"UNKNOWN_MFA_REASON\"] = \"UNKNOWN_MFA_REASON\";\n  MfaReason2[\"USER_SETTINGS\"] = \"USER_SETTINGS\";\n  MfaReason2[\"HIGH_RISK_LOGIN\"] = \"HIGH_RISK_LOGIN\";\n  return MfaReason2;\n})(MfaReason || {});\nvar TenantType = /* @__PURE__ */ ((TenantType2) => {\n  TenantType2[\"UNKNOWN_TENANT_TYPE\"] = \"UNKNOWN_TENANT_TYPE\";\n  TenantType2[\"ACCOUNT\"] = \"ACCOUNT\";\n  TenantType2[\"SITE\"] = \"SITE\";\n  return TenantType2;\n})(TenantType || {});\nvar DeliveryMethod = /* @__PURE__ */ ((DeliveryMethod2) => {\n  DeliveryMethod2[\"UNKNOWN_DELIVERY_METHOD\"] = \"UNKNOWN_DELIVERY_METHOD\";\n  DeliveryMethod2[\"SMS\"] = \"SMS\";\n  DeliveryMethod2[\"WHATSAPP\"] = \"WHATSAPP\";\n  return DeliveryMethod2;\n})(DeliveryMethod || {});\nasync function registerV22(loginId, options) {\n  const { httpClient, sideEffects } = arguments[2];\n  const payload = transformPaths2(\n    renameKeysFromSDKRequestToRESTRequest({\n      loginId,\n      password: options?.password,\n      profile: options?.profile,\n      captchaTokens: options?.captchaTokens,\n      clientMetaData: options?.clientMetaData\n    }),\n    [\n      {\n        transformFn: transformSDKAddressToRESTAddress,\n        paths: [{ path: \"profile.addresses.address\" }]\n      }\n    ]\n  );\n  const reqOpts = registerV2(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(\n      transformPaths2(result.data, [\n        {\n          transformFn: transformRESTAddressToSDKAddress,\n          paths: [{ path: \"identity.identityProfile.addresses.address\" }]\n        }\n      ])\n    );\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          loginId: \"$[0]\",\n          password: \"$[1].password\",\n          profile: \"$[1].profile\",\n          captchaTokens: \"$[1].captchaTokens\",\n          clientMetaData: \"$[1].clientMetaData\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"loginId\", \"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\nasync function loginV22(loginId, options) {\n  const { httpClient, sideEffects } = arguments[2];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    loginId,\n    password: options?.password,\n    captchaTokens: options?.captchaTokens,\n    clientMetaData: options?.clientMetaData\n  });\n  const reqOpts = loginV2(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(\n      transformPaths2(result.data, [\n        {\n          transformFn: transformRESTAddressToSDKAddress,\n          paths: [{ path: \"identity.identityProfile.addresses.address\" }]\n        }\n      ])\n    );\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          loginId: \"$[0]\",\n          password: \"$[1].password\",\n          captchaTokens: \"$[1].captchaTokens\",\n          clientMetaData: \"$[1].clientMetaData\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"loginId\", \"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\nasync function changePassword2(newPassword) {\n  const { httpClient, sideEffects } = arguments[1];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    newPassword\n  });\n  const reqOpts = changePassword(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: { newPassword: \"$[0]\" },\n        singleArgumentUnchanged: false\n      },\n      [\"newPassword\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\nasync function signOn2(loginId, options) {\n  const { httpClient, sideEffects } = arguments[2];\n  const payload = transformPaths2(\n    renameKeysFromSDKRequestToRESTRequest({\n      loginId,\n      profile: options?.profile,\n      verifyEmail: options?.verifyEmail,\n      mergeExistingContact: options?.mergeExistingContact\n    }),\n    [\n      {\n        transformFn: transformSDKAddressToRESTAddress,\n        paths: [{ path: \"profile.addresses.address\" }]\n      }\n    ]\n  );\n  const reqOpts = signOn(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(\n      transformPaths2(result.data, [\n        {\n          transformFn: transformRESTAddressToSDKAddress,\n          paths: [{ path: \"identity.identityProfile.addresses.address\" }]\n        }\n      ])\n    );\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          loginId: \"$[0]\",\n          profile: \"$[1].profile\",\n          verifyEmail: \"$[1].verifyEmail\",\n          mergeExistingContact: \"$[1].mergeExistingContact\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"loginId\", \"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\nasync function logout2(options) {\n  const { httpClient, sideEffects } = arguments[1];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    postLogoutRedirectUri: options?.postLogoutRedirectUri,\n    clientId: options?.clientId\n  });\n  const reqOpts = logout(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(result.data);\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          postLogoutRedirectUri: \"$[0].postLogoutRedirectUri\",\n          clientId: \"$[0].clientId\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\n\n// src/iam-authentication-v1-authentication-authentication.public.ts\nfunction registerV23(httpClient) {\n  return (loginId, options) => registerV22(\n    loginId,\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nfunction loginV23(httpClient) {\n  return (loginId, options) => loginV22(\n    loginId,\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nfunction changePassword3(httpClient) {\n  return (newPassword) => changePassword2(\n    newPassword,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nfunction signOn3(httpClient) {\n  return (loginId, options) => signOn2(\n    loginId,\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nfunction logout3(httpClient) {\n  return (options) => logout2(\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\n\n// src/iam-authentication-v1-authentication-authentication.context.ts\nimport { createRESTModule } from \"@wix/sdk-runtime/rest-modules\";\nvar registerV24 = /* @__PURE__ */ createRESTModule(registerV23);\nvar loginV24 = /* @__PURE__ */ createRESTModule(loginV23);\nvar changePassword4 = /* @__PURE__ */ createRESTModule(changePassword3);\nvar signOn4 = /* @__PURE__ */ createRESTModule(signOn3);\nvar logout4 = /* @__PURE__ */ createRESTModule(logout3);\nexport {\n  AddressTag,\n  DeliveryMethod,\n  EmailTag,\n  FactorStatus,\n  FactorType,\n  MfaReason,\n  PhoneTag,\n  PrivacyStatus,\n  Reason,\n  StateType,\n  Status,\n  StatusName,\n  TenantType,\n  changePassword4 as changePassword,\n  loginV24 as loginV2,\n  logout4 as logout,\n  registerV24 as registerV2,\n  signOn4 as signOn\n};\n//# sourceMappingURL=index.mjs.map","// src/iam-recovery-v1-recovery-recovery.universal.ts\nimport { transformError as sdkTransformError } from \"@wix/sdk-runtime/transform-error\";\nimport {\n  renameKeysFromSDKRequestToRESTRequest,\n  renameKeysFromRESTResponseToSDKResponse\n} from \"@wix/sdk-runtime/rename-all-nested-keys\";\n\n// src/iam-recovery-v1-recovery-recovery.http.ts\nimport { transformRESTFloatToSDKFloat } from \"@wix/sdk-runtime/transformations/float\";\nimport { transformRESTTimestampToSDKTimestamp } from \"@wix/sdk-runtime/transformations/timestamp\";\nimport { transformPaths } from \"@wix/sdk-runtime/transformations/transform-paths\";\nimport { resolveUrl } from \"@wix/sdk-runtime/rest-modules\";\nfunction resolveWixIamRecoveryV1RecoveryServiceUrl(opts) {\n  const domainToMappings = {\n    _: [\n      {\n        srcPath: \"/_iam/recovery\",\n        destPath: \"\"\n      },\n      {\n        srcPath: \"/_api/iam/recovery\",\n        destPath: \"\"\n      }\n    ],\n    \"www.wixapis.com\": [\n      {\n        srcPath: \"/_api/iam/recovery\",\n        destPath: \"\"\n      }\n    ],\n    \"*.dev.wix-code.com\": [\n      {\n        srcPath: \"/iam/recovery/v1/recover\",\n        destPath: \"/v1/recover\"\n      },\n      {\n        srcPath: \"/iam/recovery/v1/send-email\",\n        destPath: \"/v1/send-email\"\n      },\n      {\n        srcPath: \"/iam/recovery/v1/activation-email\",\n        destPath: \"/v1/activation-email\"\n      }\n    ]\n  };\n  return resolveUrl(Object.assign(opts, { domainToMappings }));\n}\nvar PACKAGE_NAME = \"@wix/auto_sdk_identity_recovery\";\nfunction sendRecoveryEmail(payload) {\n  function __sendRecoveryEmail({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.recovery.v1.recovery\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.recovery.v1.RecoveryService.SendRecoveryEmail\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamRecoveryV1RecoveryServiceUrl({\n        protoPath: \"/v1/send-email\",\n        data: payload,\n        host\n      }),\n      data: payload\n    };\n    return metadata;\n  }\n  return __sendRecoveryEmail;\n}\nfunction sendActivationEmail(payload) {\n  function __sendActivationEmail({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.recovery.v1.recovery\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.recovery.v1.RecoveryService.SendActivationEmail\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamRecoveryV1RecoveryServiceUrl({\n        protoPath: \"/v1/activation-email\",\n        data: payload,\n        host\n      }),\n      data: payload\n    };\n    return metadata;\n  }\n  return __sendActivationEmail;\n}\nfunction recover(payload) {\n  function __recover({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.recovery.v1.recovery\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.recovery.v1.RecoveryService.Recover\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamRecoveryV1RecoveryServiceUrl({\n        protoPath: \"/v1/recover\",\n        data: payload,\n        host\n      }),\n      data: payload,\n      transformResponse: (payload2) => transformPaths(payload2, [\n        {\n          transformFn: transformRESTTimestampToSDKTimestamp,\n          paths: [\n            { path: \"identity.createdDate\" },\n            { path: \"identity.updatedDate\" },\n            { path: \"identity.identityProfile.customFields.value.dateValue\" },\n            { path: \"additionalData.*.dateValue\" }\n          ]\n        },\n        {\n          transformFn: transformRESTFloatToSDKFloat,\n          paths: [\n            { path: \"identity.identityProfile.customFields.value.numValue\" },\n            { path: \"additionalData.*.numValue\" }\n          ]\n        }\n      ])\n    };\n    return metadata;\n  }\n  return __recover;\n}\n\n// src/iam-recovery-v1-recovery-recovery.universal.ts\nimport { transformRESTAddressToSDKAddress } from \"@wix/sdk-runtime/transformations/address\";\nimport { transformPaths as transformPaths2 } from \"@wix/sdk-runtime/transformations/transform-paths\";\nvar TenantType = /* @__PURE__ */ ((TenantType2) => {\n  TenantType2[\"UNKNOWN_TENANT_TYPE\"] = \"UNKNOWN_TENANT_TYPE\";\n  TenantType2[\"ACCOUNT\"] = \"ACCOUNT\";\n  TenantType2[\"SITE\"] = \"SITE\";\n  return TenantType2;\n})(TenantType || {});\nvar StateType = /* @__PURE__ */ ((StateType2) => {\n  StateType2[\"UNKNOWN_STATE\"] = \"UNKNOWN_STATE\";\n  StateType2[\"SUCCESS\"] = \"SUCCESS\";\n  StateType2[\"REQUIRE_OWNER_APPROVAL\"] = \"REQUIRE_OWNER_APPROVAL\";\n  StateType2[\"REQUIRE_EMAIL_VERIFICATION\"] = \"REQUIRE_EMAIL_VERIFICATION\";\n  StateType2[\"STATUS_CHECK\"] = \"STATUS_CHECK\";\n  return StateType2;\n})(StateType || {});\nvar PrivacyStatus = /* @__PURE__ */ ((PrivacyStatus2) => {\n  PrivacyStatus2[\"UNDEFINED\"] = \"UNDEFINED\";\n  PrivacyStatus2[\"PUBLIC\"] = \"PUBLIC\";\n  PrivacyStatus2[\"PRIVATE\"] = \"PRIVATE\";\n  return PrivacyStatus2;\n})(PrivacyStatus || {});\nvar EmailTag = /* @__PURE__ */ ((EmailTag2) => {\n  EmailTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  EmailTag2[\"MAIN\"] = \"MAIN\";\n  EmailTag2[\"HOME\"] = \"HOME\";\n  EmailTag2[\"WORK\"] = \"WORK\";\n  return EmailTag2;\n})(EmailTag || {});\nvar PhoneTag = /* @__PURE__ */ ((PhoneTag2) => {\n  PhoneTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  PhoneTag2[\"MAIN\"] = \"MAIN\";\n  PhoneTag2[\"HOME\"] = \"HOME\";\n  PhoneTag2[\"MOBILE\"] = \"MOBILE\";\n  PhoneTag2[\"WORK\"] = \"WORK\";\n  PhoneTag2[\"FAX\"] = \"FAX\";\n  return PhoneTag2;\n})(PhoneTag || {});\nvar AddressTag = /* @__PURE__ */ ((AddressTag2) => {\n  AddressTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  AddressTag2[\"HOME\"] = \"HOME\";\n  AddressTag2[\"WORK\"] = \"WORK\";\n  AddressTag2[\"BILLING\"] = \"BILLING\";\n  AddressTag2[\"SHIPPING\"] = \"SHIPPING\";\n  return AddressTag2;\n})(AddressTag || {});\nvar StatusName = /* @__PURE__ */ ((StatusName2) => {\n  StatusName2[\"UNKNOWN_STATUS\"] = \"UNKNOWN_STATUS\";\n  StatusName2[\"PENDING\"] = \"PENDING\";\n  StatusName2[\"ACTIVE\"] = \"ACTIVE\";\n  StatusName2[\"DELETED\"] = \"DELETED\";\n  StatusName2[\"BLOCKED\"] = \"BLOCKED\";\n  StatusName2[\"OFFLINE\"] = \"OFFLINE\";\n  return StatusName2;\n})(StatusName || {});\nvar Reason = /* @__PURE__ */ ((Reason2) => {\n  Reason2[\"UNKNOWN_REASON\"] = \"UNKNOWN_REASON\";\n  Reason2[\"PENDING_ADMIN_APPROVAL_REQUIRED\"] = \"PENDING_ADMIN_APPROVAL_REQUIRED\";\n  Reason2[\"PENDING_EMAIL_VERIFICATION_REQUIRED\"] = \"PENDING_EMAIL_VERIFICATION_REQUIRED\";\n  return Reason2;\n})(Reason || {});\nvar FactorType = /* @__PURE__ */ ((FactorType2) => {\n  FactorType2[\"UNKNOWN_FACTOR_TYPE\"] = \"UNKNOWN_FACTOR_TYPE\";\n  FactorType2[\"PASSWORD\"] = \"PASSWORD\";\n  FactorType2[\"SMS\"] = \"SMS\";\n  FactorType2[\"CALL\"] = \"CALL\";\n  FactorType2[\"EMAIL\"] = \"EMAIL\";\n  FactorType2[\"TOTP\"] = \"TOTP\";\n  FactorType2[\"PUSH\"] = \"PUSH\";\n  FactorType2[\"WEBAUTHN\"] = \"WEBAUTHN\";\n  FactorType2[\"RECOVERY_CODE\"] = \"RECOVERY_CODE\";\n  return FactorType2;\n})(FactorType || {});\nvar Status = /* @__PURE__ */ ((Status2) => {\n  Status2[\"INACTIVE\"] = \"INACTIVE\";\n  Status2[\"ACTIVE\"] = \"ACTIVE\";\n  Status2[\"REQUIRE_REENROLL\"] = \"REQUIRE_REENROLL\";\n  return Status2;\n})(Status || {});\nvar FactorStatus = /* @__PURE__ */ ((FactorStatus2) => {\n  FactorStatus2[\"UNKNOWN_FACTOR_STATUS\"] = \"UNKNOWN_FACTOR_STATUS\";\n  FactorStatus2[\"ENABLED\"] = \"ENABLED\";\n  FactorStatus2[\"REQUIRE_ACTIVATION\"] = \"REQUIRE_ACTIVATION\";\n  FactorStatus2[\"REQUIRE_REENROLL\"] = \"REQUIRE_REENROLL\";\n  FactorStatus2[\"ENABLED_BY_RULE\"] = \"ENABLED_BY_RULE\";\n  FactorStatus2[\"DISABLED_BY_RULE\"] = \"DISABLED_BY_RULE\";\n  return FactorStatus2;\n})(FactorStatus || {});\nvar MfaReason = /* @__PURE__ */ ((MfaReason2) => {\n  MfaReason2[\"UNKNOWN_MFA_REASON\"] = \"UNKNOWN_MFA_REASON\";\n  MfaReason2[\"USER_SETTINGS\"] = \"USER_SETTINGS\";\n  MfaReason2[\"HIGH_RISK_LOGIN\"] = \"HIGH_RISK_LOGIN\";\n  return MfaReason2;\n})(MfaReason || {});\nasync function sendRecoveryEmail2(email, options) {\n  const { httpClient, sideEffects } = arguments[2];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    email,\n    language: options?.language,\n    redirect: options?.redirect\n  });\n  const reqOpts = sendRecoveryEmail(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          email: \"$[0]\",\n          language: \"$[1].language\",\n          redirect: \"$[1].redirect\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"email\", \"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\nasync function sendActivationEmail2(identityId, options) {\n  const { httpClient, sideEffects } = arguments[2];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    identityId,\n    emailOptions: options?.emailOptions\n  });\n  const reqOpts = sendActivationEmail(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          identityId: \"$[0]\",\n          emailOptions: \"$[1].emailOptions\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"identityId\", \"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\nasync function recover2(recoveryToken, options) {\n  const { httpClient, sideEffects } = arguments[2];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    recoveryToken,\n    password: options?.password\n  });\n  const reqOpts = recover(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(\n      transformPaths2(result.data, [\n        {\n          transformFn: transformRESTAddressToSDKAddress,\n          paths: [{ path: \"identity.identityProfile.addresses.address\" }]\n        }\n      ])\n    );\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          recoveryToken: \"$[0]\",\n          password: \"$[1].password\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"recoveryToken\", \"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\n\n// src/iam-recovery-v1-recovery-recovery.public.ts\nfunction sendRecoveryEmail3(httpClient) {\n  return (email, options) => sendRecoveryEmail2(\n    email,\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nfunction sendActivationEmail3(httpClient) {\n  return (identityId, options) => sendActivationEmail2(\n    identityId,\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nfunction recover3(httpClient) {\n  return (recoveryToken, options) => recover2(\n    recoveryToken,\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\n\n// src/iam-recovery-v1-recovery-recovery.context.ts\nimport { createRESTModule } from \"@wix/sdk-runtime/rest-modules\";\nvar sendRecoveryEmail4 = /* @__PURE__ */ createRESTModule(sendRecoveryEmail3);\nvar sendActivationEmail4 = /* @__PURE__ */ createRESTModule(sendActivationEmail3);\nvar recover4 = /* @__PURE__ */ createRESTModule(recover3);\nexport {\n  AddressTag,\n  EmailTag,\n  FactorStatus,\n  FactorType,\n  MfaReason,\n  PhoneTag,\n  PrivacyStatus,\n  Reason,\n  StateType,\n  Status,\n  StatusName,\n  TenantType,\n  recover4 as recover,\n  sendActivationEmail4 as sendActivationEmail,\n  sendRecoveryEmail4 as sendRecoveryEmail\n};\n//# sourceMappingURL=index.mjs.map","// src/iam-verification-v1-start-response-verification.universal.ts\nimport { transformError as sdkTransformError } from \"@wix/sdk-runtime/transform-error\";\nimport {\n  renameKeysFromSDKRequestToRESTRequest,\n  renameKeysFromRESTResponseToSDKResponse\n} from \"@wix/sdk-runtime/rename-all-nested-keys\";\n\n// src/iam-verification-v1-start-response-verification.http.ts\nimport { transformRESTFloatToSDKFloat } from \"@wix/sdk-runtime/transformations/float\";\nimport { transformRESTTimestampToSDKTimestamp } from \"@wix/sdk-runtime/transformations/timestamp\";\nimport { transformPaths } from \"@wix/sdk-runtime/transformations/transform-paths\";\nimport { resolveUrl } from \"@wix/sdk-runtime/rest-modules\";\nfunction resolveWixIamVerificationV1VerificationServiceUrl(opts) {\n  const domainToMappings = {\n    \"www.wixapis.com\": [\n      {\n        srcPath: \"/_api/iam/verification\",\n        destPath: \"\"\n      }\n    ],\n    _: [\n      {\n        srcPath: \"/_api/iam/verification\",\n        destPath: \"\"\n      }\n    ],\n    \"www._base_domain_\": [\n      {\n        srcPath: \"/_api/iam/verification\",\n        destPath: \"\"\n      }\n    ],\n    \"*.dev.wix-code.com\": [\n      {\n        srcPath: \"/iam/verification/v1/auth/resend\",\n        destPath: \"/v1/auth/resend\"\n      },\n      {\n        srcPath: \"/iam/verification/v1/Start\",\n        destPath: \"/v1/Start\"\n      },\n      {\n        srcPath: \"/iam/verification/v1/auth/verify\",\n        destPath: \"/v1/auth/verify\"\n      }\n    ]\n  };\n  return resolveUrl(Object.assign(opts, { domainToMappings }));\n}\nvar PACKAGE_NAME = \"@wix/auto_sdk_identity_verification\";\nfunction start(payload) {\n  function __start({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.verification.v1.start_response\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.verification.v1.VerificationService.Start\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamVerificationV1VerificationServiceUrl({\n        protoPath: \"/v1/Start\",\n        data: payload,\n        host\n      }),\n      data: payload\n    };\n    return metadata;\n  }\n  return __start;\n}\nfunction verifyDuringAuthentication(payload) {\n  function __verifyDuringAuthentication({ host }) {\n    const metadata = {\n      entityFqdn: \"wix.iam.verification.v1.start_response\",\n      method: \"POST\",\n      methodFqn: \"wix.iam.verification.v1.VerificationService.VerifyDuringAuthentication\",\n      packageName: PACKAGE_NAME,\n      migrationOptions: {\n        optInTransformResponse: true\n      },\n      url: resolveWixIamVerificationV1VerificationServiceUrl({\n        protoPath: \"/v1/auth/verify\",\n        data: payload,\n        host\n      }),\n      data: payload,\n      transformResponse: (payload2) => transformPaths(payload2, [\n        {\n          transformFn: transformRESTTimestampToSDKTimestamp,\n          paths: [\n            { path: \"identity.createdDate\" },\n            { path: \"identity.updatedDate\" },\n            { path: \"identity.identityProfile.customFields.value.dateValue\" },\n            { path: \"additionalData.*.dateValue\" }\n          ]\n        },\n        {\n          transformFn: transformRESTFloatToSDKFloat,\n          paths: [\n            { path: \"identity.identityProfile.customFields.value.numValue\" },\n            { path: \"additionalData.*.numValue\" }\n          ]\n        }\n      ])\n    };\n    return metadata;\n  }\n  return __verifyDuringAuthentication;\n}\n\n// src/iam-verification-v1-start-response-verification.universal.ts\nimport { transformRESTAddressToSDKAddress } from \"@wix/sdk-runtime/transformations/address\";\nimport { transformPaths as transformPaths2 } from \"@wix/sdk-runtime/transformations/transform-paths\";\nvar Target = /* @__PURE__ */ ((Target2) => {\n  Target2[\"UNKNOWN_TARGET\"] = \"UNKNOWN_TARGET\";\n  Target2[\"EMAIL\"] = \"EMAIL\";\n  return Target2;\n})(Target || {});\nvar StateType = /* @__PURE__ */ ((StateType2) => {\n  StateType2[\"UNKNOWN_STATE\"] = \"UNKNOWN_STATE\";\n  StateType2[\"SUCCESS\"] = \"SUCCESS\";\n  StateType2[\"REQUIRE_OWNER_APPROVAL\"] = \"REQUIRE_OWNER_APPROVAL\";\n  StateType2[\"REQUIRE_EMAIL_VERIFICATION\"] = \"REQUIRE_EMAIL_VERIFICATION\";\n  StateType2[\"STATUS_CHECK\"] = \"STATUS_CHECK\";\n  return StateType2;\n})(StateType || {});\nvar PrivacyStatus = /* @__PURE__ */ ((PrivacyStatus2) => {\n  PrivacyStatus2[\"UNDEFINED\"] = \"UNDEFINED\";\n  PrivacyStatus2[\"PUBLIC\"] = \"PUBLIC\";\n  PrivacyStatus2[\"PRIVATE\"] = \"PRIVATE\";\n  return PrivacyStatus2;\n})(PrivacyStatus || {});\nvar EmailTag = /* @__PURE__ */ ((EmailTag2) => {\n  EmailTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  EmailTag2[\"MAIN\"] = \"MAIN\";\n  EmailTag2[\"HOME\"] = \"HOME\";\n  EmailTag2[\"WORK\"] = \"WORK\";\n  return EmailTag2;\n})(EmailTag || {});\nvar PhoneTag = /* @__PURE__ */ ((PhoneTag2) => {\n  PhoneTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  PhoneTag2[\"MAIN\"] = \"MAIN\";\n  PhoneTag2[\"HOME\"] = \"HOME\";\n  PhoneTag2[\"MOBILE\"] = \"MOBILE\";\n  PhoneTag2[\"WORK\"] = \"WORK\";\n  PhoneTag2[\"FAX\"] = \"FAX\";\n  return PhoneTag2;\n})(PhoneTag || {});\nvar AddressTag = /* @__PURE__ */ ((AddressTag2) => {\n  AddressTag2[\"UNTAGGED\"] = \"UNTAGGED\";\n  AddressTag2[\"HOME\"] = \"HOME\";\n  AddressTag2[\"WORK\"] = \"WORK\";\n  AddressTag2[\"BILLING\"] = \"BILLING\";\n  AddressTag2[\"SHIPPING\"] = \"SHIPPING\";\n  return AddressTag2;\n})(AddressTag || {});\nvar StatusName = /* @__PURE__ */ ((StatusName2) => {\n  StatusName2[\"UNKNOWN_STATUS\"] = \"UNKNOWN_STATUS\";\n  StatusName2[\"PENDING\"] = \"PENDING\";\n  StatusName2[\"ACTIVE\"] = \"ACTIVE\";\n  StatusName2[\"DELETED\"] = \"DELETED\";\n  StatusName2[\"BLOCKED\"] = \"BLOCKED\";\n  StatusName2[\"OFFLINE\"] = \"OFFLINE\";\n  return StatusName2;\n})(StatusName || {});\nvar Reason = /* @__PURE__ */ ((Reason2) => {\n  Reason2[\"UNKNOWN_REASON\"] = \"UNKNOWN_REASON\";\n  Reason2[\"PENDING_ADMIN_APPROVAL_REQUIRED\"] = \"PENDING_ADMIN_APPROVAL_REQUIRED\";\n  Reason2[\"PENDING_EMAIL_VERIFICATION_REQUIRED\"] = \"PENDING_EMAIL_VERIFICATION_REQUIRED\";\n  return Reason2;\n})(Reason || {});\nvar FactorType = /* @__PURE__ */ ((FactorType2) => {\n  FactorType2[\"UNKNOWN_FACTOR_TYPE\"] = \"UNKNOWN_FACTOR_TYPE\";\n  FactorType2[\"PASSWORD\"] = \"PASSWORD\";\n  FactorType2[\"SMS\"] = \"SMS\";\n  FactorType2[\"CALL\"] = \"CALL\";\n  FactorType2[\"EMAIL\"] = \"EMAIL\";\n  FactorType2[\"TOTP\"] = \"TOTP\";\n  FactorType2[\"PUSH\"] = \"PUSH\";\n  FactorType2[\"WEBAUTHN\"] = \"WEBAUTHN\";\n  FactorType2[\"RECOVERY_CODE\"] = \"RECOVERY_CODE\";\n  return FactorType2;\n})(FactorType || {});\nvar Status = /* @__PURE__ */ ((Status2) => {\n  Status2[\"INACTIVE\"] = \"INACTIVE\";\n  Status2[\"ACTIVE\"] = \"ACTIVE\";\n  Status2[\"REQUIRE_REENROLL\"] = \"REQUIRE_REENROLL\";\n  return Status2;\n})(Status || {});\nvar FactorStatus = /* @__PURE__ */ ((FactorStatus2) => {\n  FactorStatus2[\"UNKNOWN_FACTOR_STATUS\"] = \"UNKNOWN_FACTOR_STATUS\";\n  FactorStatus2[\"ENABLED\"] = \"ENABLED\";\n  FactorStatus2[\"REQUIRE_ACTIVATION\"] = \"REQUIRE_ACTIVATION\";\n  FactorStatus2[\"REQUIRE_REENROLL\"] = \"REQUIRE_REENROLL\";\n  FactorStatus2[\"ENABLED_BY_RULE\"] = \"ENABLED_BY_RULE\";\n  FactorStatus2[\"DISABLED_BY_RULE\"] = \"DISABLED_BY_RULE\";\n  return FactorStatus2;\n})(FactorStatus || {});\nvar MfaReason = /* @__PURE__ */ ((MfaReason2) => {\n  MfaReason2[\"UNKNOWN_MFA_REASON\"] = \"UNKNOWN_MFA_REASON\";\n  MfaReason2[\"USER_SETTINGS\"] = \"USER_SETTINGS\";\n  MfaReason2[\"HIGH_RISK_LOGIN\"] = \"HIGH_RISK_LOGIN\";\n  return MfaReason2;\n})(MfaReason || {});\nasync function start2(options) {\n  const { httpClient, sideEffects } = arguments[1];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    identityId: options?.identityId,\n    target: options?.target\n  });\n  const reqOpts = start(payload);\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(result.data);\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          identityId: \"$[0].identityId\",\n          target: \"$[0].target\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\nasync function verifyDuringAuthentication2(code, options) {\n  const { httpClient, sideEffects } = arguments[2];\n  const payload = renameKeysFromSDKRequestToRESTRequest({\n    code,\n    stateToken: options?.stateToken\n  });\n  const reqOpts = verifyDuringAuthentication(\n    payload\n  );\n  sideEffects?.onSiteCall?.();\n  try {\n    const result = await httpClient.request(reqOpts);\n    sideEffects?.onSuccess?.(result);\n    return renameKeysFromRESTResponseToSDKResponse(\n      transformPaths2(result.data, [\n        {\n          transformFn: transformRESTAddressToSDKAddress,\n          paths: [{ path: \"identity.identityProfile.addresses.address\" }]\n        }\n      ])\n    );\n  } catch (err) {\n    const transformedError = sdkTransformError(\n      err,\n      {\n        spreadPathsToArguments: {},\n        explicitPathsToArguments: {\n          code: \"$[0]\",\n          stateToken: \"$[1].stateToken\"\n        },\n        singleArgumentUnchanged: false\n      },\n      [\"code\", \"options\"]\n    );\n    sideEffects?.onError?.(err);\n    throw transformedError;\n  }\n}\n\n// src/iam-verification-v1-start-response-verification.public.ts\nfunction start3(httpClient) {\n  return (options) => start2(\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\nfunction verifyDuringAuthentication3(httpClient) {\n  return (code, options) => verifyDuringAuthentication2(\n    code,\n    options,\n    // @ts-ignore\n    { httpClient }\n  );\n}\n\n// src/iam-verification-v1-start-response-verification.context.ts\nimport { createRESTModule } from \"@wix/sdk-runtime/rest-modules\";\nvar start4 = /* @__PURE__ */ createRESTModule(start3);\nvar verifyDuringAuthentication4 = /* @__PURE__ */ createRESTModule(verifyDuringAuthentication3);\nexport {\n  AddressTag,\n  EmailTag,\n  FactorStatus,\n  FactorType,\n  MfaReason,\n  PhoneTag,\n  PrivacyStatus,\n  Reason,\n  StateType,\n  Status,\n  StatusName,\n  Target,\n  start4 as start,\n  verifyDuringAuthentication4 as verifyDuringAuthentication\n};\n//# sourceMappingURL=index.mjs.map","export var LoginState;\n(function (LoginState) {\n    LoginState[\"SUCCESS\"] = \"SUCCESS\";\n    LoginState[\"INITIAL\"] = \"INITIAL\";\n    LoginState[\"FAILURE\"] = \"FAILURE\";\n    LoginState[\"EMAIL_VERIFICATION_REQUIRED\"] = \"EMAIL_VERIFICATION_REQUIRED\";\n    LoginState[\"OWNER_APPROVAL_REQUIRED\"] = \"OWNER_APPROVAL_REQUIRED\";\n    LoginState[\"USER_CAPTCHA_REQUIRED\"] = \"USER_CAPTCHA_REQUIRED\";\n    LoginState[\"SILENT_CAPTCHA_REQUIRED\"] = \"SILENT_CAPTCHA_REQUIRED\";\n})(LoginState || (LoginState = {}));\nexport var TokenRole;\n(function (TokenRole) {\n    TokenRole[\"NONE\"] = \"none\";\n    TokenRole[\"VISITOR\"] = \"visitor\";\n    TokenRole[\"MEMBER\"] = \"member\";\n})(TokenRole || (TokenRole = {}));\n","export function addListener(eventTarget, name, fn) {\n    if (eventTarget.addEventListener) {\n        eventTarget.addEventListener(name, fn);\n    }\n    else {\n        eventTarget.attachEvent('on' + name, fn);\n    }\n}\nexport function removeListener(eventTarget, name, fn) {\n    if (eventTarget.removeEventListener) {\n        eventTarget.removeEventListener(name, fn);\n    }\n    else {\n        eventTarget.detachEvent('on' + name, fn);\n    }\n}\nexport function loadFrame(src) {\n    const iframe = document.createElement('iframe');\n    iframe.style.display = 'none';\n    iframe.src = src;\n    return document.body.appendChild(iframe);\n}\nexport function addPostMessageListener(state) {\n    let responseHandler;\n    let timeoutId;\n    const msgReceivedOrTimeout = new Promise((resolve, reject) => {\n        responseHandler = (e) => {\n            if (!e.data || e.data.state !== state) {\n                // A message not meant for us\n                return;\n            }\n            resolve(e.data);\n        };\n        addListener(window, 'message', responseHandler);\n        timeoutId = setTimeout(() => {\n            reject(new Error('OAuth flow timed out'));\n        }, 120000);\n    });\n    return msgReceivedOrTimeout.finally(() => {\n        clearTimeout(timeoutId);\n        removeListener(window, 'message', responseHandler);\n    });\n}\n","export const MISSING_CAPTCHA = '-19971';\nexport const INVALID_CAPTCHA = '-19970';\nexport const EMAIL_EXISTS = '-19995';\nexport const INVALID_PASSWORD = '-19976';\nexport const RESET_PASSWORD = '-19973';\n","/**\n * [js-sha256]{@link https://github.com/emn178/js-sha256}\n * @version 0.11.0\n * @author Chen, Yi-Cyuan [emn178@gmail.com]\n * @copyright Chen, Yi-Cyuan 2014-2024\n * @license MIT\n */\n// Inline here to avoid bringing in another library, cause:\n// 1. we have commited to a sync API (hopefully we'll change to async and\n// can start using the builtin crypto sha256), so we need a sync sha256,\n// but the existing sync sha256 libs are not ESM\n// 2. avoid bringing in a library for a single function\nconst SHIFT = [24, 16, 8, 0];\nconst EXTRA = [-2147483648, 8388608, 32768, 128];\nconst K = [\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1,\n    0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,\n    0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786,\n    0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147,\n    0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,\n    0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b,\n    0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a,\n    0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,\n    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,\n];\nclass SHA256 {\n    blocks;\n    h0;\n    h1;\n    h2;\n    h3;\n    h4;\n    h5;\n    h6;\n    h7;\n    block;\n    start;\n    bytes;\n    hBytes;\n    finalized;\n    hashed;\n    first;\n    lastByteIndex;\n    chromeBugWorkAround;\n    constructor() {\n        this.blocks = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        // 256\n        this.h0 = 0x6a09e667;\n        this.h1 = 0xbb67ae85;\n        this.h2 = 0x3c6ef372;\n        this.h3 = 0xa54ff53a;\n        this.h4 = 0x510e527f;\n        this.h5 = 0x9b05688c;\n        this.h6 = 0x1f83d9ab;\n        this.h7 = 0x5be0cd19;\n        this.block = this.start = this.bytes = this.hBytes = 0;\n        this.finalized = this.hashed = false;\n        this.first = true;\n    }\n    update(message) {\n        const blocks = this.blocks;\n        const length = message.length;\n        let code, index = 0, i;\n        while (index < length) {\n            if (this.hashed) {\n                this.hashed = false;\n                blocks[0] = this.block;\n                this.block =\n                    blocks[16] =\n                        blocks[1] =\n                            blocks[2] =\n                                blocks[3] =\n                                    blocks[4] =\n                                        blocks[5] =\n                                            blocks[6] =\n                                                blocks[7] =\n                                                    blocks[8] =\n                                                        blocks[9] =\n                                                            blocks[10] =\n                                                                blocks[11] =\n                                                                    blocks[12] =\n                                                                        blocks[13] =\n                                                                            blocks[14] =\n                                                                                blocks[15] =\n                                                                                    0;\n            }\n            for (i = this.start; index < length && i < 64; ++index) {\n                code = message.charCodeAt(index);\n                if (code < 0x80) {\n                    blocks[i >>> 2] |= code << SHIFT[i++ & 3];\n                }\n                else if (code < 0x800) {\n                    blocks[i >>> 2] |= (0xc0 | (code >>> 6)) << SHIFT[i++ & 3];\n                    blocks[i >>> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];\n                }\n                else if (code < 0xd800 || code >= 0xe000) {\n                    blocks[i >>> 2] |= (0xe0 | (code >>> 12)) << SHIFT[i++ & 3];\n                    blocks[i >>> 2] |= (0x80 | ((code >>> 6) & 0x3f)) << SHIFT[i++ & 3];\n                    blocks[i >>> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];\n                }\n                else {\n                    code =\n                        0x10000 +\n                            (((code & 0x3ff) << 10) | (message.charCodeAt(++index) & 0x3ff));\n                    blocks[i >>> 2] |= (0xf0 | (code >>> 18)) << SHIFT[i++ & 3];\n                    blocks[i >>> 2] |= (0x80 | ((code >>> 12) & 0x3f)) << SHIFT[i++ & 3];\n                    blocks[i >>> 2] |= (0x80 | ((code >>> 6) & 0x3f)) << SHIFT[i++ & 3];\n                    blocks[i >>> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];\n                }\n            }\n            this.lastByteIndex = i;\n            this.bytes += i - this.start;\n            if (i >= 64) {\n                this.block = blocks[16];\n                this.start = i - 64;\n                this.hash();\n                this.hashed = true;\n            }\n            else {\n                this.start = i;\n            }\n        }\n        if (this.bytes > 4294967295) {\n            this.hBytes += (this.bytes / 4294967296) << 0;\n            this.bytes = this.bytes % 4294967296;\n        }\n        return this;\n    }\n    hash() {\n        const blocks = this.blocks;\n        let a = this.h0, b = this.h1, c = this.h2, d = this.h3, e = this.h4, f = this.h5, g = this.h6, h = this.h7, j, s0, s1, maj, t1, t2, ch, ab, da, cd, bc;\n        for (j = 16; j < 64; ++j) {\n            // rightrotate\n            t1 = blocks[j - 15];\n            s0 = ((t1 >>> 7) | (t1 << 25)) ^ ((t1 >>> 18) | (t1 << 14)) ^ (t1 >>> 3);\n            t1 = blocks[j - 2];\n            s1 =\n                ((t1 >>> 17) | (t1 << 15)) ^ ((t1 >>> 19) | (t1 << 13)) ^ (t1 >>> 10);\n            blocks[j] = (blocks[j - 16] + s0 + blocks[j - 7] + s1) << 0;\n        }\n        bc = b & c;\n        for (j = 0; j < 64; j += 4) {\n            if (this.first) {\n                ab = 704751109;\n                t1 = blocks[0] - 210244248;\n                h = (t1 - 1521486534) << 0;\n                d = (t1 + 143694565) << 0;\n                this.first = false;\n            }\n            else {\n                s0 =\n                    ((a >>> 2) | (a << 30)) ^\n                        ((a >>> 13) | (a << 19)) ^\n                        ((a >>> 22) | (a << 10));\n                s1 =\n                    ((e >>> 6) | (e << 26)) ^\n                        ((e >>> 11) | (e << 21)) ^\n                        ((e >>> 25) | (e << 7));\n                ab = a & b;\n                maj = ab ^ (a & c) ^ bc;\n                ch = (e & f) ^ (~e & g);\n                t1 = h + s1 + ch + K[j] + blocks[j];\n                t2 = s0 + maj;\n                h = (d + t1) << 0;\n                d = (t1 + t2) << 0;\n            }\n            s0 =\n                ((d >>> 2) | (d << 30)) ^\n                    ((d >>> 13) | (d << 19)) ^\n                    ((d >>> 22) | (d << 10));\n            s1 =\n                ((h >>> 6) | (h << 26)) ^\n                    ((h >>> 11) | (h << 21)) ^\n                    ((h >>> 25) | (h << 7));\n            da = d & a;\n            maj = da ^ (d & b) ^ ab;\n            ch = (h & e) ^ (~h & f);\n            t1 = g + s1 + ch + K[j + 1] + blocks[j + 1];\n            t2 = s0 + maj;\n            g = (c + t1) << 0;\n            c = (t1 + t2) << 0;\n            s0 =\n                ((c >>> 2) | (c << 30)) ^\n                    ((c >>> 13) | (c << 19)) ^\n                    ((c >>> 22) | (c << 10));\n            s1 =\n                ((g >>> 6) | (g << 26)) ^\n                    ((g >>> 11) | (g << 21)) ^\n                    ((g >>> 25) | (g << 7));\n            cd = c & d;\n            maj = cd ^ (c & a) ^ da;\n            ch = (g & h) ^ (~g & e);\n            t1 = f + s1 + ch + K[j + 2] + blocks[j + 2];\n            t2 = s0 + maj;\n            f = (b + t1) << 0;\n            b = (t1 + t2) << 0;\n            s0 =\n                ((b >>> 2) | (b << 30)) ^\n                    ((b >>> 13) | (b << 19)) ^\n                    ((b >>> 22) | (b << 10));\n            s1 =\n                ((f >>> 6) | (f << 26)) ^\n                    ((f >>> 11) | (f << 21)) ^\n                    ((f >>> 25) | (f << 7));\n            bc = b & c;\n            maj = bc ^ (b & d) ^ cd;\n            ch = (f & g) ^ (~f & h);\n            t1 = e + s1 + ch + K[j + 3] + blocks[j + 3];\n            t2 = s0 + maj;\n            e = (a + t1) << 0;\n            a = (t1 + t2) << 0;\n            this.chromeBugWorkAround = true;\n        }\n        this.h0 = (this.h0 + a) << 0;\n        this.h1 = (this.h1 + b) << 0;\n        this.h2 = (this.h2 + c) << 0;\n        this.h3 = (this.h3 + d) << 0;\n        this.h4 = (this.h4 + e) << 0;\n        this.h5 = (this.h5 + f) << 0;\n        this.h6 = (this.h6 + g) << 0;\n        this.h7 = (this.h7 + h) << 0;\n    }\n    finalize() {\n        if (this.finalized) {\n            return;\n        }\n        this.finalized = true;\n        const blocks = this.blocks, i = this.lastByteIndex;\n        blocks[16] = this.block;\n        blocks[i >>> 2] |= EXTRA[i & 3];\n        this.block = blocks[16];\n        if (i >= 56) {\n            if (!this.hashed) {\n                this.hash();\n            }\n            blocks[0] = this.block;\n            blocks[16] =\n                blocks[1] =\n                    blocks[2] =\n                        blocks[3] =\n                            blocks[4] =\n                                blocks[5] =\n                                    blocks[6] =\n                                        blocks[7] =\n                                            blocks[8] =\n                                                blocks[9] =\n                                                    blocks[10] =\n                                                        blocks[11] =\n                                                            blocks[12] =\n                                                                blocks[13] =\n                                                                    blocks[14] =\n                                                                        blocks[15] =\n                                                                            0;\n        }\n        blocks[14] = (this.hBytes << 3) | (this.bytes >>> 29);\n        blocks[15] = this.bytes << 3;\n        this.hash();\n    }\n    arrayBuffer() {\n        this.finalize();\n        const buffer = new ArrayBuffer(32);\n        const dataView = new DataView(buffer);\n        dataView.setUint32(0, this.h0);\n        dataView.setUint32(4, this.h1);\n        dataView.setUint32(8, this.h2);\n        dataView.setUint32(12, this.h3);\n        dataView.setUint32(16, this.h4);\n        dataView.setUint32(20, this.h5);\n        dataView.setUint32(24, this.h6);\n        dataView.setUint32(28, this.h7);\n        return buffer;\n    }\n}\nexport function sha256(message) {\n    return new SHA256().update(message).arrayBuffer();\n}\n","import { sha256 } from './sha256.js';\nexport function pkceChallenge(length) {\n    if (!length) {\n        length = 43;\n    }\n    if (length < 43 || length > 128) {\n        throw new Error(`Expected a length between 43 and 128. Received ${length}.`);\n    }\n    const verifier = generateVerifier(length);\n    const challenge = generateChallenge(verifier);\n    return {\n        code_verifier: verifier,\n        code_challenge: challenge,\n    };\n}\nfunction generateVerifier(length) {\n    return random(length);\n}\nexport function generateChallenge(code_verifier) {\n    return base64urlencode(sha256(code_verifier));\n}\nfunction random(size) {\n    const mask = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~';\n    let result = '';\n    const randomUints = crypto.getRandomValues(new Uint8Array(size));\n    for (let i = 0; i < size; i++) {\n        // cap the value of the randomIndex to mask.length - 1\n        const randomIndex = randomUints[i] % mask.length;\n        result += mask[randomIndex];\n    }\n    return result;\n}\nfunction base64urlencode(str) {\n    const base64 = typeof Buffer === 'undefined'\n        ? btoa(ab2str(str))\n        : Buffer.from(str).toString('base64');\n    return base64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n}\nfunction ab2str(buf) {\n    return String.fromCharCode.apply(null, Array.from(new Uint8Array(buf)));\n}\n","import { redirects } from '@wix/redirects';\nexport const LOCALSTORAGE_PREWARM_REDIRECT_KEY = 'wixRedirectSessionLastPreWarm';\nexport function isVisitorCookieWarmedUp() {\n    // Check if we already pre-warmed recently\n    const lastPreWarmTimeString = localStorage.getItem(LOCALSTORAGE_PREWARM_REDIRECT_KEY);\n    const currentTime = Date.now();\n    // If we have a stored timestamp, check if it's been less than a week\n    if (lastPreWarmTimeString) {\n        const lastPreWarmTime = parseInt(lastPreWarmTimeString, 10);\n        const oneWeekMs = 7 * 24 * 60 * 60 * 1000; // 7 days in milliseconds\n        if (currentTime - lastPreWarmTime < oneWeekMs) {\n            return true; // Was pre-warmed within the last week\n        }\n    }\n    return false; // We need to pre-warm\n}\n// Function to check if we need to pre-warm\nexport async function preWarmVisitorCookie(opts = {}) {\n    // Check if we already pre-warmed recently\n    if (!opts.force && isVisitorCookieWarmedUp()) {\n        return;\n    }\n    // If we get here, we need to pre-warm\n    localStorage.removeItem(LOCALSTORAGE_PREWARM_REDIRECT_KEY);\n    try {\n        await preWarmRedirectSessionWithIframe();\n        // Store the current timestamp\n        localStorage.setItem(LOCALSTORAGE_PREWARM_REDIRECT_KEY, Date.now().toString());\n    }\n    catch (ex) {\n        console.error('Error during redirect session pre-warm:', ex);\n    }\n}\nasync function preWarmRedirectSessionWithIframe() {\n    const resultWithCreateCookie = await redirects.createRedirectSession({\n        login: {},\n    });\n    const urlToRedirect = resultWithCreateCookie.redirectSession?.fullUrl;\n    if (!urlToRedirect) {\n        throw new Error('No redirect URL found');\n    }\n    const iframe = document.createElement('iframe');\n    iframe.style.display = 'none';\n    iframe.src = urlToRedirect;\n    const promise = new Promise((resolve) => (iframe.onload = resolve));\n    document.body.appendChild(iframe);\n    return promise;\n}\n","import { createClient } from '../../wixClient.js';\nimport { redirects } from '@wix/redirects';\nimport { createAccessToken, isTokenExpired } from '../../tokenHelpers.js';\nimport { authentication, recovery, verification } from '@wix/identity';\nimport { DEFAULT_API_URL } from '../../common.js';\nimport { LoginState, TokenRole, } from './types.js';\nimport { addPostMessageListener, loadFrame } from '../../iframeUtils.js';\nimport { EMAIL_EXISTS, INVALID_CAPTCHA, INVALID_PASSWORD, MISSING_CAPTCHA, RESET_PASSWORD, } from './constants.js';\nimport { biHeaderGenerator } from '../../bi/biHeaderGenerator.js';\nimport { pkceChallenge } from './pkce-challenge.js';\nimport { isVisitorCookieWarmedUp, preWarmVisitorCookie, } from '../pre-warm-cookie.js';\nconst moduleWithTokens = { redirects, authentication, recovery, verification };\nexport function OAuthStrategy(config) {\n    const _tokens = config.tokens || {\n        accessToken: { value: '', expiresAt: 0 },\n        refreshToken: { value: '', role: TokenRole.NONE },\n    };\n    const setTokens = (tokens) => {\n        _tokens.accessToken = tokens.accessToken;\n        _tokens.refreshToken = tokens.refreshToken;\n    };\n    let _state = {\n        loginState: LoginState.INITIAL,\n    };\n    const getAuthHeaders = async () => {\n        if (!_tokens.accessToken?.value || isTokenExpired(_tokens.accessToken)) {\n            const tokens = await generateVisitorTokens({\n                refreshToken: _tokens.refreshToken,\n            });\n            setTokens(tokens);\n        }\n        return Promise.resolve({\n            headers: { Authorization: _tokens.accessToken.value },\n        });\n    };\n    const wixClientWithTokens = createClient({\n        modules: moduleWithTokens,\n        auth: { getAuthHeaders },\n    });\n    const generateVisitorTokens = async (tokens) => {\n        if (tokens?.accessToken?.value &&\n            tokens?.refreshToken?.value &&\n            !isTokenExpired(tokens.accessToken)) {\n            return tokens;\n        }\n        if (tokens?.refreshToken?.value) {\n            try {\n                const newTokens = await renewToken(tokens.refreshToken);\n                return newTokens;\n            }\n            catch (e) {\n                // just continue and create a visitor one\n            }\n        }\n        const tokensResponse = await fetchTokens({\n            clientId: config.clientId,\n            grantType: 'anonymous',\n        });\n        return {\n            accessToken: createAccessToken(tokensResponse.access_token, tokensResponse.expires_in),\n            refreshToken: {\n                value: tokensResponse.refresh_token,\n                role: TokenRole.VISITOR,\n            },\n        };\n    };\n    const renewToken = async (refreshToken) => {\n        const tokensResponse = await fetchTokens({\n            refreshToken: refreshToken.value,\n            grantType: 'refresh_token',\n        });\n        const accessToken = createAccessToken(tokensResponse.access_token, tokensResponse.expires_in);\n        return {\n            accessToken,\n            refreshToken,\n        };\n    };\n    const generatePKCE = () => {\n        const pkceState = pkceChallenge();\n        return {\n            codeChallenge: pkceState.code_challenge,\n            codeVerifier: pkceState.code_verifier,\n            state: pkceChallenge().code_challenge,\n        };\n    };\n    const generateOAuthData = (redirectUri, originalUri) => {\n        const state = { redirectUri };\n        const pkceState = generatePKCE();\n        return {\n            ...state,\n            originalUri: originalUri ?? '',\n            codeChallenge: pkceState.codeChallenge,\n            codeVerifier: pkceState.codeVerifier,\n            state: pkceChallenge().code_challenge,\n        };\n    };\n    const getAuthorizationUrlWithOptions = async (oauthData, responseMode, prompt, sessionToken) => {\n        const { redirectSession } = await wixClientWithTokens.redirects.createRedirectSession({\n            auth: {\n                authRequest: {\n                    redirectUri: oauthData.redirectUri,\n                    ...(oauthData.redirectUri && {\n                        redirectUri: oauthData.redirectUri,\n                    }),\n                    clientId: config.clientId,\n                    codeChallenge: oauthData.codeChallenge,\n                    codeChallengeMethod: 'S256',\n                    responseMode,\n                    responseType: 'code',\n                    scope: 'offline_access',\n                    state: oauthData.state,\n                    ...(sessionToken && { sessionToken }),\n                },\n                prompt: redirects.Prompt[prompt],\n            },\n        });\n        return {\n            authUrl: redirectSession.fullUrl,\n            authorizationEndpoint: redirectSession.urlDetails.endpoint,\n            sessionToken: redirectSession.sessionToken,\n        };\n    };\n    const getAuthUrl = async (oauthData = generateOAuthData('unused://'), opts = {\n        prompt: 'login',\n    }) => {\n        return getAuthorizationUrlWithOptions(oauthData, opts.responseMode ?? 'fragment', opts.prompt ?? 'login', opts.sessionToken);\n    };\n    const parseFromUrl = (url, responseMode = 'fragment') => {\n        const parsedUrl = new URL(url ?? window.location.href);\n        const params = responseMode === 'query'\n            ? parsedUrl.searchParams\n            : new URLSearchParams(parsedUrl.hash.substring(1));\n        const code = params.get('code');\n        const state = params.get('state');\n        const error = params.get('error');\n        const errorDescription = params.get('error_description');\n        return { code, state, ...(error && { error, errorDescription }) };\n    };\n    const getMemberTokens = async (code, state, oauthData) => {\n        if (!code || !state) {\n            throw new Error('Missing code or _state');\n        }\n        else if (state !== oauthData.state) {\n            throw new Error('Invalid _state');\n        }\n        const tokensResponse = await fetchTokens({\n            clientId: config.clientId,\n            grantType: 'authorization_code',\n            ...(oauthData.redirectUri && { redirectUri: oauthData.redirectUri }),\n            code,\n            codeVerifier: oauthData.codeVerifier,\n        });\n        return {\n            accessToken: createAccessToken(tokensResponse.access_token, tokensResponse.expires_in),\n            refreshToken: {\n                value: tokensResponse.refresh_token,\n                role: TokenRole.MEMBER,\n            },\n        };\n    };\n    const logout = async (originalUrl) => {\n        const { redirectSession } = await wixClientWithTokens.redirects.createRedirectSession({\n            logout: { clientId: config.clientId },\n            callbacks: {\n                postFlowUrl: originalUrl,\n            },\n        });\n        _tokens.accessToken = { value: '', expiresAt: 0 };\n        _tokens.refreshToken = { value: '', role: TokenRole.NONE };\n        return { logoutUrl: redirectSession.fullUrl };\n    };\n    const handleState = (response) => {\n        if (response.state === authentication.StateType.SUCCESS) {\n            return {\n                loginState: LoginState.SUCCESS,\n                data: { sessionToken: response.sessionToken },\n            };\n        }\n        else if (response.state === authentication.StateType.REQUIRE_OWNER_APPROVAL) {\n            return {\n                loginState: LoginState.OWNER_APPROVAL_REQUIRED,\n            };\n        }\n        else if (response.state === authentication.StateType.REQUIRE_EMAIL_VERIFICATION) {\n            _state = {\n                loginState: LoginState.EMAIL_VERIFICATION_REQUIRED,\n                data: { stateToken: response.stateToken },\n            };\n            return _state;\n        }\n        return {\n            loginState: LoginState.FAILURE,\n            error: 'Unknown _state',\n        };\n    };\n    const register = async (params) => {\n        try {\n            const res = await wixClientWithTokens.authentication.registerV2({\n                email: params.email,\n            }, {\n                password: params.password,\n                profile: params.profile,\n                ...(params.captchaTokens && {\n                    captchaTokens: [\n                        {\n                            Recaptcha: params.captchaTokens?.recaptchaToken,\n                            InvisibleRecaptcha: params.captchaTokens?.invisibleRecaptchaToken,\n                        },\n                    ],\n                }),\n            });\n            return handleState(res);\n        }\n        catch (e) {\n            const emailValidation = e.details.validationError?.fieldViolations?.find((v) => v.data.type === 'EMAIL');\n            if (emailValidation) {\n                return {\n                    loginState: LoginState.FAILURE,\n                    error: emailValidation.description,\n                    errorCode: 'invalidEmail',\n                };\n            }\n            if (e.details.applicationError?.code === MISSING_CAPTCHA) {\n                return {\n                    loginState: LoginState.FAILURE,\n                    error: e.message,\n                    errorCode: 'missingCaptchaToken',\n                };\n            }\n            if (e.details.applicationError?.code === EMAIL_EXISTS) {\n                return {\n                    loginState: LoginState.FAILURE,\n                    error: e.message,\n                    errorCode: 'emailAlreadyExists',\n                };\n            }\n            if (e.details.applicationError?.code === INVALID_CAPTCHA) {\n                return {\n                    loginState: LoginState.FAILURE,\n                    error: e.message,\n                    errorCode: 'invalidCaptchaToken',\n                };\n            }\n            return {\n                loginState: LoginState.FAILURE,\n                error: e.message,\n            };\n        }\n    };\n    const login = async (params) => {\n        try {\n            const res = await wixClientWithTokens.authentication.loginV2({\n                email: params.email,\n            }, {\n                password: params.password,\n                ...(params.captchaTokens && {\n                    captchaTokens: [\n                        {\n                            Recaptcha: params.captchaTokens?.recaptchaToken,\n                            InvisibleRecaptcha: params.captchaTokens?.invisibleRecaptchaToken,\n                        },\n                    ],\n                }),\n            });\n            return handleState(res);\n        }\n        catch (e) {\n            return {\n                loginState: LoginState.FAILURE,\n                error: e.message,\n                errorCode: e.details.applicationError?.code === MISSING_CAPTCHA\n                    ? 'missingCaptchaToken'\n                    : e.details.applicationError?.code === INVALID_CAPTCHA\n                        ? 'invalidCaptchaToken'\n                        : e.details.applicationError.code === INVALID_PASSWORD\n                            ? 'invalidPassword'\n                            : e.details.applicationError.code === RESET_PASSWORD\n                                ? 'resetPassword'\n                                : 'invalidEmail',\n            };\n        }\n    };\n    const processVerification = async (nextInputs, state) => {\n        const stateToUse = state ?? _state;\n        if (stateToUse.loginState === LoginState.EMAIL_VERIFICATION_REQUIRED) {\n            const code = nextInputs.verificationCode ?? nextInputs.code;\n            const res = await wixClientWithTokens.verification.verifyDuringAuthentication(code, { stateToken: stateToUse.data.stateToken });\n            return handleState(res);\n        }\n        return {\n            loginState: LoginState.FAILURE,\n            error: 'Unknown _state',\n        };\n    };\n    const getMemberTokensForDirectLogin = async (sessionToken) => {\n        const oauthPKCE = generatePKCE();\n        const { authUrl } = await getAuthorizationUrlWithOptions(oauthPKCE, 'web_message', 'none', sessionToken);\n        const iframePromise = addPostMessageListener(oauthPKCE.state);\n        const iframeEl = loadFrame(authUrl);\n        return iframePromise\n            .then((res) => {\n            return getMemberTokens(res.code, res.state, oauthPKCE);\n        })\n            .finally(() => {\n            if (document.body.contains(iframeEl)) {\n                iframeEl.parentElement?.removeChild(iframeEl);\n            }\n        });\n    };\n    const sendPasswordResetEmail = async (email, redirectUri) => {\n        await wixClientWithTokens.recovery.sendRecoveryEmail(email, {\n            redirect: { url: redirectUri, clientId: config.clientId },\n        });\n    };\n    const loggedIn = () => {\n        return _tokens.refreshToken.role === TokenRole.MEMBER;\n    };\n    const getMemberTokensForExternalLogin = async (memberId, apiKey) => {\n        const tokensResponse = await fetchTokens({\n            grant_type: 'authorized_client',\n            scope: 'offline_access',\n            member_id: memberId,\n        }, {\n            Authorization: _tokens.accessToken.value + ',' + apiKey,\n        });\n        return {\n            accessToken: createAccessToken(tokensResponse.access_token, tokensResponse.expires_in),\n            refreshToken: {\n                value: tokensResponse.refresh_token,\n                role: TokenRole.MEMBER,\n            },\n        };\n    };\n    return {\n        generateVisitorTokens,\n        renewToken,\n        parseFromUrl,\n        getAuthUrl,\n        getMemberTokens,\n        generateOAuthData,\n        getAuthHeaders,\n        setTokens,\n        getTokens: () => _tokens,\n        loggedIn,\n        logout,\n        register,\n        processVerification,\n        login,\n        getMemberTokensForDirectLogin,\n        getMemberTokensForExternalLogin,\n        sendPasswordResetEmail,\n        captchaInvisibleSiteKey: '6LdoPaUfAAAAAJphvHoUoOob7mx0KDlXyXlgrx5v',\n        captchaVisibleSiteKey: '6Ld0J8IcAAAAANyrnxzrRlX1xrrdXsOmsepUYosy',\n        sessions: {\n            isSessionSynced: isVisitorCookieWarmedUp,\n            syncToWixPages: preWarmVisitorCookie,\n        },\n        shouldUseCDN: true,\n    };\n}\nconst fetchTokens = async (payload, headers = {}) => {\n    const res = await fetch(`https://${DEFAULT_API_URL}/oauth2/token`, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: {\n            ...biHeaderGenerator({\n                entityFqdn: 'wix.identity.oauth.v1.refresh_token',\n                methodFqn: 'wix.identity.oauth2.v1.Oauth2Ng.Token',\n                packageName: '@wix/sdk',\n            }),\n            'Content-Type': 'application/json',\n            ...headers,\n        },\n    });\n    if (res.status !== 200) {\n        let responseJson;\n        try {\n            responseJson = await res.json();\n        }\n        catch { }\n        throw new Error(`Failed to fetch tokens from OAuth API: ${res.statusText}. request id: ${res.headers.get('x-request-id')}. ${responseJson ? `Response: ${JSON.stringify(responseJson)}` : ''}`);\n    }\n    const json = await res.json();\n    return json;\n};\n","export function ApiKeyStrategy({ siteId, accountId, apiKey, }) {\n    const headers = { Authorization: apiKey };\n    if (siteId) {\n        headers['wix-site-id'] = siteId;\n    }\n    if (accountId) {\n        headers['wix-account-id'] = accountId;\n    }\n    return {\n        setSiteId(_siteId) {\n            headers['wix-site-id'] = _siteId;\n        },\n        setAccountId(_accountId) {\n            headers['wix-account-id'] = _accountId;\n        },\n        async getAuthHeaders() {\n            return {\n                headers,\n            };\n        },\n    };\n}\n","export async function getTokenInfo(token) {\n    const tokenInfoRes = await fetch('https://www.wixapis.com/oauth2/token-info', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n            token,\n        }),\n    });\n    if (tokenInfoRes.status !== 200) {\n        throw new Error(`Failed to get token info. Unexpected status code from Wix OAuth API: ${tokenInfoRes.status}`);\n    }\n    return (await tokenInfoRes.json());\n}\n","import { parsePublicKeyIfEncoded } from '../helpers.js';\nimport { getTokenInfo } from '../get-token-info.js';\n/**\n * Creates an authentication strategy for Wix Apps OAuth installation process.\n * Use this authentication strategy when making requests to Wix APIs from your Wix App backend.\n * @param opts Options for initializing the authentication strategy\n * @param opts.appId The Wix App ID\n * @param opts.appSecret The Wix App Secret\n * @param opts.refreshToken An optional refresh token previously retrieved from Wix OAuth API\n * @param opts.instanceId An optional instance ID of the Wix App instance the client is making requests on behalf of\n * @param opts.accessToken An optional access token previously retrieved from a client Wix Extension\n * @param opts.publicKey An optional public key for validating webhook requests (supports both PEM and base64 encoded keys)\n * @returns An authentication strategy that can be used with WixClient\n * @example\n * ```ts\n * import { AppStrategy, createClient } from '@wix/sdk';\n * import { products } from '@wix/stores';\n *\n * const client = createClient({\n *  auth: AppStrategy({\n *   appId: 'appId',\n *   appSecret: 'appSecret',\n *  }),\n *  modules: { products },\n * });\n *\n * const installUrl = client.auth.getInstallUrl({ redirectUrl: 'https://example.com' });\n * // Redirect the user to the installUrl\n *\n * ...\n *\n * // in the callback handler of your http server\n * // req.url is the url of the callback request\n * const { instanceId, refreshToken } = await client.auth.handleOAuthCallback(req.url);\n *\n * // store the instanceId and refreshToken in your database\n * // use the authorized client\n * const products = await client.products.queryProducts().find();\n *\n * ```\n */\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport function AppStrategy(opts) {\n    let refreshToken = 'refreshToken' in opts ? opts.refreshToken : undefined;\n    let cachedToken;\n    return {\n        getInstallUrl({ redirectUrl, token, state }) {\n            const params = new URLSearchParams();\n            params.set('redirectUrl', redirectUrl);\n            params.set('appId', opts.appId);\n            if (state) {\n                params.set('state', state);\n            }\n            if (token) {\n                params.set('token', token);\n            }\n            return `https://www.wix.com/installer/install?${params.toString()}`;\n        },\n        async handleOAuthCallback(url, oauthOpts) {\n            if (!opts.appSecret) {\n                throw new Error('App secret is required for handling OAuth callback. Make sure to pass it to the AppStrategy');\n            }\n            const params = new URLSearchParams(new URL(url).search);\n            const state = params.get('state');\n            if (state && oauthOpts?.state && state !== oauthOpts.state) {\n                throw new Error(`Invalid OAuth callback URL. Expected state to be \"${oauthOpts.state}\" but got \"${state}\"`);\n            }\n            const code = params.get('code');\n            const instanceId = params.get('instanceId');\n            if (!code || !instanceId) {\n                throw new Error('Invalid OAuth callback URL. Make sure you pass the url including the code and instanceId query params.');\n            }\n            const tokensRes = await fetch('https://www.wixapis.com/oauth/access', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    code,\n                    client_id: opts.appId,\n                    client_secret: opts.appSecret,\n                    grant_type: 'authorization_code',\n                }),\n            });\n            if (tokensRes.status !== 200) {\n                throw new Error(`Failed to exchange authorization code for refresh token. Unexpected status code from Wix OAuth API: ${tokensRes.status}, request id: ${tokensRes.headers.get('x-wix-request-id')}`);\n            }\n            const tokens = await tokensRes.json();\n            refreshToken = tokens.refresh_token;\n            return {\n                instanceId,\n                accessToken: tokens.access_token,\n                refreshToken: tokens.refresh_token,\n            };\n        },\n        async getAuthHeaders() {\n            if (cachedToken && cachedToken.expiresAt > Date.now()) {\n                return {\n                    headers: {\n                        Authorization: cachedToken.token,\n                    },\n                };\n            }\n            if ('refreshToken' in opts || refreshToken) {\n                if (!opts.appSecret) {\n                    throw new Error('App secret is required for retrieving app-level access tokens. Make sure to pass it to the AppStrategy');\n                }\n                const tokensRes = await fetch('https://www.wixapis.com/oauth/access', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        refresh_token: refreshToken,\n                        client_id: opts.appId,\n                        client_secret: opts.appSecret,\n                        grant_type: 'refresh_token',\n                    }),\n                });\n                if (tokensRes.status !== 200) {\n                    throw new Error(`Failed to exchange refresh token for access token. Unexpected status code from Wix OAuth API: ${tokensRes.status}, request id: ${tokensRes.headers.get('x-wix-request-id')}`);\n                }\n                const tokens = (await tokensRes.json());\n                refreshToken = tokens.refresh_token;\n                return {\n                    headers: {\n                        Authorization: tokens.access_token,\n                    },\n                };\n            }\n            else if ('instanceId' in opts) {\n                if (!opts.appSecret) {\n                    throw new Error('App secret is required for retrieving app-level access tokens. Make sure to pass it to the AppStrategy');\n                }\n                const tokensRes = await fetch('https://www.wixapis.com/oauth2/token', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        instance_id: opts.instanceId,\n                        client_id: opts.appId,\n                        client_secret: opts.appSecret,\n                        grant_type: 'client_credentials',\n                    }),\n                });\n                if (tokensRes.status !== 200) {\n                    throw new Error(`Failed to exchange instance ID for access token. Unexpected status code from Wix OAuth API: ${tokensRes.status}, request id: ${tokensRes.headers.get('x-wix-request-id')}`);\n                }\n                const tokens = (await tokensRes.json());\n                cachedToken = {\n                    token: tokens.access_token,\n                    expiresAt: Date.now() + tokens.expires_in * 1000,\n                };\n                return {\n                    headers: {\n                        Authorization: tokens.access_token,\n                    },\n                };\n            }\n            else if ('accessToken' in opts && opts.accessToken) {\n                const tokenRes = await fetch('https://www.wixapis.com/oauth2/token', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        grant_type: 'strip_bound_session',\n                        client_secret: opts.appSecret,\n                        access_token: opts.accessToken,\n                    }),\n                });\n                if (tokenRes.status !== 200) {\n                    throw new Error(`Failed to get unbound token. Unexpected status code from Wix OAuth API: ${tokenRes.status}, request id: ${tokenRes.headers.get('x-wix-request-id')}`);\n                }\n                const { access_token, expires_in } = (await tokenRes.json());\n                cachedToken = {\n                    token: access_token,\n                    expiresAt: Date.now() + expires_in * 1000,\n                };\n                return {\n                    headers: {\n                        Authorization: access_token,\n                    },\n                };\n            }\n            else {\n                throw new Error('Missing refresh token or instance ID. Either one is needed to get app level access tokens. Make sure to pass one of them to the AppStrategy');\n            }\n        },\n        async elevated() {\n            if ('accessToken' in opts && opts.accessToken) {\n                const tokenInfo = await getTokenInfo(opts.accessToken);\n                if (tokenInfo.clientId !== opts.appId) {\n                    throw new Error(`Invalid access token. The token is not issued for the app with ID \"${opts.appId}\"`);\n                }\n                if (!tokenInfo.instanceId) {\n                    throw new Error('Unexpected token info. The token does not contain instance ID');\n                }\n                return AppStrategy({\n                    appId: opts.appId,\n                    appSecret: opts.appSecret,\n                    publicKey: opts.publicKey,\n                    instanceId: tokenInfo.instanceId,\n                });\n            }\n            else {\n                throw new Error('Providing an access token is required to perform elevation. Make sure to pass it to the AppStrategy');\n            }\n        },\n        async decodeJWT(token, verifyCallerClaims = false) {\n            if (!opts.publicKey) {\n                throw new Error('Missing public key. Make sure to pass it to the AppStrategy');\n            }\n            const { jwtVerify, importSPKI } = await import('jose');\n            const publicKey = await importSPKI(parsePublicKeyIfEncoded(opts.publicKey), 'RS256');\n            const decoded = await jwtVerify(token, publicKey, verifyCallerClaims\n                ? {\n                    issuer: 'wix.com',\n                    audience: opts.appId,\n                }\n                : undefined);\n            return {\n                decoded: {\n                    data: decoded.payload.data,\n                },\n                valid: true,\n            };\n        },\n        async getTokenInfo() {\n            const tokenToCheck = refreshToken ?? ('accessToken' in opts ? opts.accessToken : undefined);\n            if (!tokenToCheck) {\n                throw new Error('Missing token to get info for. Either pass the token as an argument or provide it when initializing the AppStrategy');\n            }\n            return getTokenInfo(tokenToCheck);\n        },\n        getActiveToken() {\n            return 'accessToken' in opts ? opts.accessToken : refreshToken;\n        },\n    };\n}\n"],"file":"assets/index-27425330.js"}